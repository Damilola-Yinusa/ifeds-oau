import{e as q,L as Ob}from"./livewire.esm-C819BCfU.js";import{f as Lb,m as kb}from"./fetch-Bv7pIKk9.js";import{c as Fb}from"./clipboard-CBCTDmBy.js";import{R as ch,f as $b}from"./lib.modern-DHFPEOLP.js";const Bb="modulepreload",Wb=function(r){return"/build/"+r},Bc={},Wc=function(e,n,o){let a=Promise.resolve();if(n&&n.length>0){let u=function(g){return Promise.all(g.map(v=>Promise.resolve(v).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),f=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));a=u(n.map(g=>{if(g=Wb(g),g in Bc)return;Bc[g]=!0;const v=g.endsWith(".css"),y=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${y}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":Bb,v||(S.as="script"),S.crossOrigin="",S.href=g,f&&S.setAttribute("nonce",f),document.head.appendChild(S),v)return new Promise((x,I)=>{S.addEventListener("load",x),S.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return a.then(u=>{for(const h of u||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})};typeof window.pusherConfig<"u"?Wc(async()=>{const{default:r}=await import("./echo-DL0QqwGZ.js");return{default:r}},[]).then(({default:r})=>{Wc(async()=>{const{default:e}=await import("./pusher-KiOVsSRT.js").then(n=>n.p);return{default:e}},[]).then(({default:e})=>{window.Pusher=e;let n=window.pusherConfig;window.Echo=new r({broadcaster:"pusher",key:n.key,cluster:n.cluster,wsHost:n.wsHost??`ws-${n.cluster}.pusher.com`,wsPort:n.port??80,wssPort:n.port??443,forceTLS:(n.scheme??"https")==="https",enabledTransports:["ws","wss"]})}).catch(e=>console.log("Failed to load Pusher:",e))}).catch(r=>console.log("Failed to load Echo:",r)):console.log("window.pusherConfig is not defined.");function zc(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,o)}return n}function ln(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?zc(Object(n),!0).forEach(function(o){zb(r,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):zc(Object(n)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(n,o))})}return r}function No(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?No=function(e){return typeof e}:No=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},No(r)}function zb(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function Sn(){return Sn=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},Sn.apply(this,arguments)}function Hb(r,e){if(r==null)return{};var n={},o=Object.keys(r),a,l;for(l=0;l<o.length;l++)a=o[l],!(e.indexOf(a)>=0)&&(n[a]=r[a]);return n}function qb(r,e){if(r==null)return{};var n=Hb(r,e),o,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(a=0;a<l.length;a++)o=l[a],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(r,o)&&(n[o]=r[o])}return n}var Ub="1.15.2";function wn(r){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(r)}var En=wn(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),xr=wn(/Edge/i),Hc=wn(/firefox/i),pr=wn(/safari/i)&&!wn(/chrome/i)&&!wn(/android/i),hh=wn(/iP(ad|od|hone)/i),fh=wn(/chrome/i)&&wn(/android/i),dh={capture:!1,passive:!1};function vt(r,e,n){r.addEventListener(e,n,!En&&dh)}function dt(r,e,n){r.removeEventListener(e,n,!En&&dh)}function qo(r,e){if(e){if(e[0]===">"&&(e=e.substring(1)),r)try{if(r.matches)return r.matches(e);if(r.msMatchesSelector)return r.msMatchesSelector(e);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(e)}catch{return!1}return!1}}function Gb(r){return r.host&&r!==document&&r.host.nodeType?r.host:r.parentNode}function tn(r,e,n,o){if(r){n=n||document;do{if(e!=null&&(e[0]===">"?r.parentNode===n&&qo(r,e):qo(r,e))||o&&r===n)return r;if(r===n)break}while(r=Gb(r))}return null}var qc=/\s+/g;function Me(r,e,n){if(r&&e)if(r.classList)r.classList[n?"add":"remove"](e);else{var o=(" "+r.className+" ").replace(qc," ").replace(" "+e+" "," ");r.className=(o+(n?" "+e:"")).replace(qc," ")}}function Y(r,e,n){var o=r&&r.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(r,""):r.currentStyle&&(n=r.currentStyle),e===void 0?n:n[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=n+(typeof n=="string"?"":"px")}}function Di(r,e){var n="";if(typeof r=="string")n=r;else do{var o=Y(r,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!e&&(r=r.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function gh(r,e,n){if(r){var o=r.getElementsByTagName(e),a=0,l=o.length;if(n)for(;a<l;a++)n(o[a],a);return o}return[]}function sn(){var r=document.scrollingElement;return r||document.documentElement}function Xt(r,e,n,o,a){if(!(!r.getBoundingClientRect&&r!==window)){var l,u,h,f,g,v,y;if(r!==window&&r.parentNode&&r!==sn()?(l=r.getBoundingClientRect(),u=l.top,h=l.left,f=l.bottom,g=l.right,v=l.height,y=l.width):(u=0,h=0,f=window.innerHeight,g=window.innerWidth,v=window.innerHeight,y=window.innerWidth),(e||n)&&r!==window&&(a=a||r.parentNode,!En))do if(a&&a.getBoundingClientRect&&(Y(a,"transform")!=="none"||n&&Y(a,"position")!=="static")){var S=a.getBoundingClientRect();u-=S.top+parseInt(Y(a,"border-top-width")),h-=S.left+parseInt(Y(a,"border-left-width")),f=u+l.height,g=h+l.width;break}while(a=a.parentNode);if(o&&r!==window){var x=Di(a||r),I=x&&x.a,R=x&&x.d;x&&(u/=R,h/=I,y/=I,v/=R,f=u+v,g=h+y)}return{top:u,left:h,bottom:f,right:g,width:y,height:v}}}function Uc(r,e,n){for(var o=$n(r,!0),a=Xt(r)[e];o;){var l=Xt(o)[n],u=void 0;if(u=a>=l,!u)return o;if(o===sn())break;o=$n(o,!1)}return!1}function Ri(r,e,n,o){for(var a=0,l=0,u=r.children;l<u.length;){if(u[l].style.display!=="none"&&u[l]!==K.ghost&&(o||u[l]!==K.dragged)&&tn(u[l],n.draggable,r,!1)){if(a===e)return u[l];a++}l++}return null}function tl(r,e){for(var n=r.lastElementChild;n&&(n===K.ghost||Y(n,"display")==="none"||e&&!qo(n,e));)n=n.previousElementSibling;return n||null}function Ue(r,e){var n=0;if(!r||!r.parentNode)return-1;for(;r=r.previousElementSibling;)r.nodeName.toUpperCase()!=="TEMPLATE"&&r!==K.clone&&(!e||qo(r,e))&&n++;return n}function Gc(r){var e=0,n=0,o=sn();if(r)do{var a=Di(r),l=a.a,u=a.d;e+=r.scrollLeft*l,n+=r.scrollTop*u}while(r!==o&&(r=r.parentNode));return[e,n]}function Vb(r,e){for(var n in r)if(r.hasOwnProperty(n)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===r[n][o])return Number(n)}return-1}function $n(r,e){if(!r||!r.getBoundingClientRect)return sn();var n=r,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=Y(n);if(n.clientWidth<n.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return sn();if(o||e)return n;o=!0}}while(n=n.parentNode);return sn()}function Xb(r,e){if(r&&e)for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}function Sa(r,e){return Math.round(r.top)===Math.round(e.top)&&Math.round(r.left)===Math.round(e.left)&&Math.round(r.height)===Math.round(e.height)&&Math.round(r.width)===Math.round(e.width)}var mr;function ph(r,e){return function(){if(!mr){var n=arguments,o=this;n.length===1?r.call(o,n[0]):r.apply(o,n),mr=setTimeout(function(){mr=void 0},e)}}}function Yb(){clearTimeout(mr),mr=void 0}function mh(r,e,n){r.scrollLeft+=e,r.scrollTop+=n}function vh(r){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(r).cloneNode(!0):n?n(r).clone(!0)[0]:r.cloneNode(!0)}function yh(r,e,n){var o={};return Array.from(r.children).forEach(function(a){var l,u,h,f;if(!(!tn(a,e.draggable,r,!1)||a.animated||a===n)){var g=Xt(a);o.left=Math.min((l=o.left)!==null&&l!==void 0?l:1/0,g.left),o.top=Math.min((u=o.top)!==null&&u!==void 0?u:1/0,g.top),o.right=Math.max((h=o.right)!==null&&h!==void 0?h:-1/0,g.right),o.bottom=Math.max((f=o.bottom)!==null&&f!==void 0?f:-1/0,g.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var Le="Sortable"+new Date().getTime();function Kb(){var r=[],e;return{captureAnimationState:function(){if(r=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(a){if(!(Y(a,"display")==="none"||a===K.ghost)){r.push({target:a,rect:Xt(a)});var l=ln({},r[r.length-1].rect);if(a.thisAnimationDuration){var u=Di(a,!0);u&&(l.top-=u.f,l.left-=u.e)}a.fromRect=l}})}},addAnimationState:function(o){r.push(o)},removeAnimationState:function(o){r.splice(Vb(r,{target:o}),1)},animateAll:function(o){var a=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var l=!1,u=0;r.forEach(function(h){var f=0,g=h.target,v=g.fromRect,y=Xt(g),S=g.prevFromRect,x=g.prevToRect,I=h.rect,R=Di(g,!0);R&&(y.top-=R.f,y.left-=R.e),g.toRect=y,g.thisAnimationDuration&&Sa(S,y)&&!Sa(v,y)&&(I.top-y.top)/(I.left-y.left)===(v.top-y.top)/(v.left-y.left)&&(f=Qb(I,S,x,a.options)),Sa(y,v)||(g.prevFromRect=v,g.prevToRect=y,f||(f=a.options.animation),a.animate(g,I,y,f)),f&&(l=!0,u=Math.max(u,f),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},f),g.thisAnimationDuration=f)}),clearTimeout(e),l?e=setTimeout(function(){typeof o=="function"&&o()},u):typeof o=="function"&&o(),r=[]},animate:function(o,a,l,u){if(u){Y(o,"transition",""),Y(o,"transform","");var h=Di(this.el),f=h&&h.a,g=h&&h.d,v=(a.left-l.left)/(f||1),y=(a.top-l.top)/(g||1);o.animatingX=!!v,o.animatingY=!!y,Y(o,"transform","translate3d("+v+"px,"+y+"px,0)"),this.forRepaintDummy=Zb(o),Y(o,"transition","transform "+u+"ms"+(this.options.easing?" "+this.options.easing:"")),Y(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){Y(o,"transition",""),Y(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},u)}}}}function Zb(r){return r.offsetWidth}function Qb(r,e,n,o){return Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*o.animation}var wi=[],Ea={initializeByDefault:!0},Ar={mount:function(e){for(var n in Ea)Ea.hasOwnProperty(n)&&!(n in e)&&(e[n]=Ea[n]);wi.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),wi.push(e)},pluginEvent:function(e,n,o){var a=this;this.eventCanceled=!1,o.cancel=function(){a.eventCanceled=!0};var l=e+"Global";wi.forEach(function(u){n[u.pluginName]&&(n[u.pluginName][l]&&n[u.pluginName][l](ln({sortable:n},o)),n.options[u.pluginName]&&n[u.pluginName][e]&&n[u.pluginName][e](ln({sortable:n},o)))})},initializePlugins:function(e,n,o,a){wi.forEach(function(h){var f=h.pluginName;if(!(!e.options[f]&&!h.initializeByDefault)){var g=new h(e,n,e.options);g.sortable=e,g.options=e.options,e[f]=g,Sn(o,g.defaults)}});for(var l in e.options)if(e.options.hasOwnProperty(l)){var u=this.modifyOption(e,l,e.options[l]);typeof u<"u"&&(e.options[l]=u)}},getEventProperties:function(e,n){var o={};return wi.forEach(function(a){typeof a.eventProperties=="function"&&Sn(o,a.eventProperties.call(n[a.pluginName],e))}),o},modifyOption:function(e,n,o){var a;return wi.forEach(function(l){e[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[n]=="function"&&(a=l.optionListeners[n].call(e[l.pluginName],o))}),a}};function Jb(r){var e=r.sortable,n=r.rootEl,o=r.name,a=r.targetEl,l=r.cloneEl,u=r.toEl,h=r.fromEl,f=r.oldIndex,g=r.newIndex,v=r.oldDraggableIndex,y=r.newDraggableIndex,S=r.originalEvent,x=r.putSortable,I=r.extraEventProperties;if(e=e||n&&n[Le],!!e){var R,k=e.options,Z="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!En&&!xr?R=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(R=document.createEvent("Event"),R.initEvent(o,!0,!0)),R.to=u||n,R.from=h||n,R.item=a||n,R.clone=l,R.oldIndex=f,R.newIndex=g,R.oldDraggableIndex=v,R.newDraggableIndex=y,R.originalEvent=S,R.pullMode=x?x.lastPutMode:void 0;var F=ln(ln({},I),Ar.getEventProperties(o,e));for(var H in F)R[H]=F[H];n&&n.dispatchEvent(R),k[Z]&&k[Z].call(e,R)}}var jb=["evt"],we=function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.evt,l=qb(o,jb);Ar.pluginEvent.bind(K)(e,n,ln({dragEl:N,parentEl:kt,ghostEl:tt,rootEl:It,nextEl:jn,lastDownEl:Oo,cloneEl:Nt,cloneHidden:kn,dragStarted:ar,putSortable:te,activeSortable:K.active,originalEvent:a,oldIndex:Ti,oldDraggableIndex:vr,newIndex:Ne,newDraggableIndex:On,hideGhostForTarget:Sh,unhideGhostForTarget:Eh,cloneNowHidden:function(){kn=!0},cloneNowShown:function(){kn=!1},dispatchSortableEvent:function(h){ge({sortable:n,name:h,originalEvent:a})}},l))};function ge(r){Jb(ln({putSortable:te,cloneEl:Nt,targetEl:N,rootEl:It,oldIndex:Ti,oldDraggableIndex:vr,newIndex:Ne,newDraggableIndex:On},r))}var N,kt,tt,It,jn,Oo,Nt,kn,Ti,Ne,vr,On,So,te,xi=!1,Uo=!1,Go=[],Kn,Qe,Ca,xa,Vc,Xc,ar,_i,yr,br=!1,Eo=!1,Lo,se,Aa=[],Ha=!1,Vo=[],jo=typeof document<"u",Co=hh,Yc=xr||En?"cssFloat":"float",t0=jo&&!fh&&!hh&&"draggable"in document.createElement("div"),bh=function(){if(jo){if(En)return!1;var r=document.createElement("x");return r.style.cssText="pointer-events:auto",r.style.pointerEvents==="auto"}}(),wh=function(e,n){var o=Y(e),a=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),l=Ri(e,0,n),u=Ri(e,1,n),h=l&&Y(l),f=u&&Y(u),g=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+Xt(l).width,v=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+Xt(u).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&h.float&&h.float!=="none"){var y=h.float==="left"?"left":"right";return u&&(f.clear==="both"||f.clear===y)?"vertical":"horizontal"}return l&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||g>=a&&o[Yc]==="none"||u&&o[Yc]==="none"&&g+v>a)?"vertical":"horizontal"},e0=function(e,n,o){var a=o?e.left:e.top,l=o?e.right:e.bottom,u=o?e.width:e.height,h=o?n.left:n.top,f=o?n.right:n.bottom,g=o?n.width:n.height;return a===h||l===f||a+u/2===h+g/2},n0=function(e,n){var o;return Go.some(function(a){var l=a[Le].options.emptyInsertThreshold;if(!(!l||tl(a))){var u=Xt(a),h=e>=u.left-l&&e<=u.right+l,f=n>=u.top-l&&n<=u.bottom+l;if(h&&f)return o=a}}),o},_h=function(e){function n(l,u){return function(h,f,g,v){var y=h.options.group.name&&f.options.group.name&&h.options.group.name===f.options.group.name;if(l==null&&(u||y))return!0;if(l==null||l===!1)return!1;if(u&&l==="clone")return l;if(typeof l=="function")return n(l(h,f,g,v),u)(h,f,g,v);var S=(u?h:f).options.group.name;return l===!0||typeof l=="string"&&l===S||l.join&&l.indexOf(S)>-1}}var o={},a=e.group;(!a||No(a)!="object")&&(a={name:a}),o.name=a.name,o.checkPull=n(a.pull,!0),o.checkPut=n(a.put),o.revertClone=a.revertClone,e.group=o},Sh=function(){!bh&&tt&&Y(tt,"display","none")},Eh=function(){!bh&&tt&&Y(tt,"display","")};jo&&!fh&&document.addEventListener("click",function(r){if(Uo)return r.preventDefault(),r.stopPropagation&&r.stopPropagation(),r.stopImmediatePropagation&&r.stopImmediatePropagation(),Uo=!1,!1},!0);var Zn=function(e){if(N){e=e.touches?e.touches[0]:e;var n=n0(e.clientX,e.clientY);if(n){var o={};for(var a in e)e.hasOwnProperty(a)&&(o[a]=e[a]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[Le]._onDragOver(o)}}},i0=function(e){N&&N.parentNode[Le]._isOutsideThisEl(e.target)};function K(r,e){if(!(r&&r.nodeType&&r.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(r));this.el=r,this.options=e=Sn({},e),r[Le]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(r.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return wh(r,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(u,h){u.setData("Text",h.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:K.supportPointer!==!1&&"PointerEvent"in window&&!pr,emptyInsertThreshold:5};Ar.initializePlugins(this,r,n);for(var o in n)!(o in e)&&(e[o]=n[o]);_h(e);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:t0,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?vt(r,"pointerdown",this._onTapStart):(vt(r,"mousedown",this._onTapStart),vt(r,"touchstart",this._onTapStart)),this.nativeDraggable&&(vt(r,"dragover",this),vt(r,"dragenter",this)),Go.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Sn(this,Kb())}K.prototype={constructor:K,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(_i=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,N):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,a=this.options,l=a.preventOnFilter,u=e.type,h=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,f=(h||e).target,g=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||f,v=a.filter;if(h0(o),!N&&!(/mousedown|pointerdown/.test(u)&&e.button!==0||a.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&pr&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=tn(f,a.draggable,o,!1),!(f&&f.animated)&&Oo!==f)){if(Ti=Ue(f),vr=Ue(f,a.draggable),typeof v=="function"){if(v.call(this,e,f,this)){ge({sortable:n,rootEl:g,name:"filter",targetEl:f,toEl:o,fromEl:o}),we("filter",n,{evt:e}),l&&e.cancelable&&e.preventDefault();return}}else if(v&&(v=v.split(",").some(function(y){if(y=tn(g,y.trim(),o,!1),y)return ge({sortable:n,rootEl:y,name:"filter",targetEl:f,fromEl:o,toEl:o}),we("filter",n,{evt:e}),!0}),v)){l&&e.cancelable&&e.preventDefault();return}a.handle&&!tn(g,a.handle,o,!1)||this._prepareDragStart(e,h,f)}}},_prepareDragStart:function(e,n,o){var a=this,l=a.el,u=a.options,h=l.ownerDocument,f;if(o&&!N&&o.parentNode===l){var g=Xt(o);if(It=l,N=o,kt=N.parentNode,jn=N.nextSibling,Oo=o,So=u.group,K.dragged=N,Kn={target:N,clientX:(n||e).clientX,clientY:(n||e).clientY},Vc=Kn.clientX-g.left,Xc=Kn.clientY-g.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,N.style["will-change"]="all",f=function(){if(we("delayEnded",a,{evt:e}),K.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Hc&&a.nativeDraggable&&(N.draggable=!0),a._triggerDragStart(e,n),ge({sortable:a,name:"choose",originalEvent:e}),Me(N,u.chosenClass,!0)},u.ignore.split(",").forEach(function(v){gh(N,v.trim(),Ta)}),vt(h,"dragover",Zn),vt(h,"mousemove",Zn),vt(h,"touchmove",Zn),vt(h,"mouseup",a._onDrop),vt(h,"touchend",a._onDrop),vt(h,"touchcancel",a._onDrop),Hc&&this.nativeDraggable&&(this.options.touchStartThreshold=4,N.draggable=!0),we("delayStart",this,{evt:e}),u.delay&&(!u.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(xr||En))){if(K.eventCanceled){this._onDrop();return}vt(h,"mouseup",a._disableDelayedDrag),vt(h,"touchend",a._disableDelayedDrag),vt(h,"touchcancel",a._disableDelayedDrag),vt(h,"mousemove",a._delayedDragTouchMoveHandler),vt(h,"touchmove",a._delayedDragTouchMoveHandler),u.supportPointer&&vt(h,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(f,u.delay)}else f()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){N&&Ta(N),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;dt(e,"mouseup",this._disableDelayedDrag),dt(e,"touchend",this._disableDelayedDrag),dt(e,"touchcancel",this._disableDelayedDrag),dt(e,"mousemove",this._delayedDragTouchMoveHandler),dt(e,"touchmove",this._delayedDragTouchMoveHandler),dt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?vt(document,"pointermove",this._onTouchMove):n?vt(document,"touchmove",this._onTouchMove):vt(document,"mousemove",this._onTouchMove):(vt(N,"dragend",this),vt(It,"dragstart",this._onDragStart));try{document.selection?ko(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(xi=!1,It&&N){we("dragStarted",this,{evt:n}),this.nativeDraggable&&vt(document,"dragover",i0);var o=this.options;!e&&Me(N,o.dragClass,!1),Me(N,o.ghostClass,!0),K.active=this,e&&this._appendGhost(),ge({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Qe){this._lastX=Qe.clientX,this._lastY=Qe.clientY,Sh();for(var e=document.elementFromPoint(Qe.clientX,Qe.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Qe.clientX,Qe.clientY),e!==n);)n=e;if(N.parentNode[Le]._isOutsideThisEl(e),n)do{if(n[Le]){var o=void 0;if(o=n[Le]._onDragOver({clientX:Qe.clientX,clientY:Qe.clientY,target:e,rootEl:n}),o&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);Eh()}},_onTouchMove:function(e){if(Kn){var n=this.options,o=n.fallbackTolerance,a=n.fallbackOffset,l=e.touches?e.touches[0]:e,u=tt&&Di(tt,!0),h=tt&&u&&u.a,f=tt&&u&&u.d,g=Co&&se&&Gc(se),v=(l.clientX-Kn.clientX+a.x)/(h||1)+(g?g[0]-Aa[0]:0)/(h||1),y=(l.clientY-Kn.clientY+a.y)/(f||1)+(g?g[1]-Aa[1]:0)/(f||1);if(!K.active&&!xi){if(o&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(tt){u?(u.e+=v-(Ca||0),u.f+=y-(xa||0)):u={a:1,b:0,c:0,d:1,e:v,f:y};var S="matrix(".concat(u.a,",").concat(u.b,",").concat(u.c,",").concat(u.d,",").concat(u.e,",").concat(u.f,")");Y(tt,"webkitTransform",S),Y(tt,"mozTransform",S),Y(tt,"msTransform",S),Y(tt,"transform",S),Ca=v,xa=y,Qe=l}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!tt){var e=this.options.fallbackOnBody?document.body:It,n=Xt(N,!0,Co,!0,e),o=this.options;if(Co){for(se=e;Y(se,"position")==="static"&&Y(se,"transform")==="none"&&se!==document;)se=se.parentNode;se!==document.body&&se!==document.documentElement?(se===document&&(se=sn()),n.top+=se.scrollTop,n.left+=se.scrollLeft):se=sn(),Aa=Gc(se)}tt=N.cloneNode(!0),Me(tt,o.ghostClass,!1),Me(tt,o.fallbackClass,!0),Me(tt,o.dragClass,!0),Y(tt,"transition",""),Y(tt,"transform",""),Y(tt,"box-sizing","border-box"),Y(tt,"margin",0),Y(tt,"top",n.top),Y(tt,"left",n.left),Y(tt,"width",n.width),Y(tt,"height",n.height),Y(tt,"opacity","0.8"),Y(tt,"position",Co?"absolute":"fixed"),Y(tt,"zIndex","100000"),Y(tt,"pointerEvents","none"),K.ghost=tt,e.appendChild(tt),Y(tt,"transform-origin",Vc/parseInt(tt.style.width)*100+"% "+Xc/parseInt(tt.style.height)*100+"%")}},_onDragStart:function(e,n){var o=this,a=e.dataTransfer,l=o.options;if(we("dragStart",this,{evt:e}),K.eventCanceled){this._onDrop();return}we("setupClone",this),K.eventCanceled||(Nt=vh(N),Nt.removeAttribute("id"),Nt.draggable=!1,Nt.style["will-change"]="",this._hideClone(),Me(Nt,this.options.chosenClass,!1),K.clone=Nt),o.cloneId=ko(function(){we("clone",o),!K.eventCanceled&&(o.options.removeCloneOnHide||It.insertBefore(Nt,N),o._hideClone(),ge({sortable:o,name:"clone"}))}),!n&&Me(N,l.dragClass,!0),n?(Uo=!0,o._loopId=setInterval(o._emulateDragOver,50)):(dt(document,"mouseup",o._onDrop),dt(document,"touchend",o._onDrop),dt(document,"touchcancel",o._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(o,a,N)),vt(document,"drop",o),Y(N,"transform","translateZ(0)")),xi=!0,o._dragStartId=ko(o._dragStarted.bind(o,n,e)),vt(document,"selectstart",o),ar=!0,pr&&Y(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,o=e.target,a,l,u,h=this.options,f=h.group,g=K.active,v=So===f,y=h.sort,S=te||g,x,I=this,R=!1;if(Ha)return;function k(Zt,Oi){we(Zt,I,ln({evt:e,isOwner:v,axis:x?"vertical":"horizontal",revert:u,dragRect:a,targetRect:l,canSort:y,fromSortable:S,target:o,completed:F,onMove:function(ie,Li){return xo(It,n,N,a,ie,Xt(ie),e,Li)},changed:H},Oi))}function Z(){k("dragOverAnimationCapture"),I.captureAnimationState(),I!==S&&S.captureAnimationState()}function F(Zt){return k("dragOverCompleted",{insertion:Zt}),Zt&&(v?g._hideClone():g._showClone(I),I!==S&&(Me(N,te?te.options.ghostClass:g.options.ghostClass,!1),Me(N,h.ghostClass,!0)),te!==I&&I!==K.active?te=I:I===K.active&&te&&(te=null),S===I&&(I._ignoreWhileAnimating=o),I.animateAll(function(){k("dragOverAnimationComplete"),I._ignoreWhileAnimating=null}),I!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(o===N&&!N.animated||o===n&&!o.animated)&&(_i=null),!h.dragoverBubble&&!e.rootEl&&o!==document&&(N.parentNode[Le]._isOutsideThisEl(e.target),!Zt&&Zn(e)),!h.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),R=!0}function H(){Ne=Ue(N),On=Ue(N,h.draggable),ge({sortable:I,name:"change",toEl:n,newIndex:Ne,newDraggableIndex:On,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=tn(o,h.draggable,n,!0),k("dragOver"),K.eventCanceled)return R;if(N.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||I._ignoreWhileAnimating===o)return F(!1);if(Uo=!1,g&&!h.disabled&&(v?y||(u=kt!==It):te===this||(this.lastPutMode=So.checkPull(this,g,N,e))&&f.checkPut(this,g,N,e))){if(x=this._getDirection(e,o)==="vertical",a=Xt(N),k("dragOverValid"),K.eventCanceled)return R;if(u)return kt=It,Z(),this._hideClone(),k("revert"),K.eventCanceled||(jn?It.insertBefore(N,jn):It.appendChild(N)),F(!0);var Q=tl(n,h.draggable);if(!Q||a0(e,x,this)&&!Q.animated){if(Q===N)return F(!1);if(Q&&n===e.target&&(o=Q),o&&(l=Xt(o)),xo(It,n,N,a,o,l,e,!!o)!==!1)return Z(),Q&&Q.nextSibling?n.insertBefore(N,Q.nextSibling):n.appendChild(N),kt=n,H(),F(!0)}else if(Q&&s0(e,x,this)){var gt=Ri(n,0,h,!0);if(gt===N)return F(!1);if(o=gt,l=Xt(o),xo(It,n,N,a,o,l,e,!1)!==!1)return Z(),n.insertBefore(N,gt),kt=n,H(),F(!0)}else if(o.parentNode===n){l=Xt(o);var ht=0,bt,$t=N.parentNode!==n,ft=!e0(N.animated&&N.toRect||a,o.animated&&o.toRect||l,x),le=x?"top":"left",Bt=Uc(o,"top","top")||Uc(N,"top","top"),ue=Bt?Bt.scrollTop:void 0;_i!==o&&(bt=l[le],br=!1,Eo=!ft&&h.invertSwap||$t),ht=l0(e,o,l,x,ft?1:h.swapThreshold,h.invertedSwapThreshold==null?h.swapThreshold:h.invertedSwapThreshold,Eo,_i===o);var Pt;if(ht!==0){var Ht=Ue(N);do Ht-=ht,Pt=kt.children[Ht];while(Pt&&(Y(Pt,"display")==="none"||Pt===tt))}if(ht===0||Pt===o)return F(!1);_i=o,yr=ht;var ce=o.nextElementSibling,Ct=!1;Ct=ht===1;var Mt=xo(It,n,N,a,o,l,e,Ct);if(Mt!==!1)return(Mt===1||Mt===-1)&&(Ct=Mt===1),Ha=!0,setTimeout(o0,30),Z(),Ct&&!ce?n.appendChild(N):o.parentNode.insertBefore(N,Ct?ce:o),Bt&&mh(Bt,0,ue-Bt.scrollTop),kt=N.parentNode,bt!==void 0&&!Eo&&(Lo=Math.abs(bt-Xt(o)[le])),H(),F(!0)}if(n.contains(N))return F(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){dt(document,"mousemove",this._onTouchMove),dt(document,"touchmove",this._onTouchMove),dt(document,"pointermove",this._onTouchMove),dt(document,"dragover",Zn),dt(document,"mousemove",Zn),dt(document,"touchmove",Zn)},_offUpEvents:function(){var e=this.el.ownerDocument;dt(e,"mouseup",this._onDrop),dt(e,"touchend",this._onDrop),dt(e,"pointerup",this._onDrop),dt(e,"touchcancel",this._onDrop),dt(document,"selectstart",this)},_onDrop:function(e){var n=this.el,o=this.options;if(Ne=Ue(N),On=Ue(N,o.draggable),we("drop",this,{evt:e}),kt=N&&N.parentNode,Ne=Ue(N),On=Ue(N,o.draggable),K.eventCanceled){this._nulling();return}xi=!1,Eo=!1,br=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),qa(this.cloneId),qa(this._dragStartId),this.nativeDraggable&&(dt(document,"drop",this),dt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),pr&&Y(document.body,"user-select",""),Y(N,"transform",""),e&&(ar&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),tt&&tt.parentNode&&tt.parentNode.removeChild(tt),(It===kt||te&&te.lastPutMode!=="clone")&&Nt&&Nt.parentNode&&Nt.parentNode.removeChild(Nt),N&&(this.nativeDraggable&&dt(N,"dragend",this),Ta(N),N.style["will-change"]="",ar&&!xi&&Me(N,te?te.options.ghostClass:this.options.ghostClass,!1),Me(N,this.options.chosenClass,!1),ge({sortable:this,name:"unchoose",toEl:kt,newIndex:null,newDraggableIndex:null,originalEvent:e}),It!==kt?(Ne>=0&&(ge({rootEl:kt,name:"add",toEl:kt,fromEl:It,originalEvent:e}),ge({sortable:this,name:"remove",toEl:kt,originalEvent:e}),ge({rootEl:kt,name:"sort",toEl:kt,fromEl:It,originalEvent:e}),ge({sortable:this,name:"sort",toEl:kt,originalEvent:e})),te&&te.save()):Ne!==Ti&&Ne>=0&&(ge({sortable:this,name:"update",toEl:kt,originalEvent:e}),ge({sortable:this,name:"sort",toEl:kt,originalEvent:e})),K.active&&((Ne==null||Ne===-1)&&(Ne=Ti,On=vr),ge({sortable:this,name:"end",toEl:kt,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){we("nulling",this),It=N=kt=tt=jn=Nt=Oo=kn=Kn=Qe=ar=Ne=On=Ti=vr=_i=yr=te=So=K.dragged=K.ghost=K.clone=K.active=null,Vo.forEach(function(e){e.checked=!0}),Vo.length=Ca=xa=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":N&&(this._onDragOver(e),r0(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,o=this.el.children,a=0,l=o.length,u=this.options;a<l;a++)n=o[a],tn(n,u.draggable,this.el,!1)&&e.push(n.getAttribute(u.dataIdAttr)||c0(n));return e},sort:function(e,n){var o={},a=this.el;this.toArray().forEach(function(l,u){var h=a.children[u];tn(h,this.options.draggable,a,!1)&&(o[l]=h)},this),n&&this.captureAnimationState(),e.forEach(function(l){o[l]&&(a.removeChild(o[l]),a.appendChild(o[l]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return tn(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var o=this.options;if(n===void 0)return o[e];var a=Ar.modifyOption(this,e,n);typeof a<"u"?o[e]=a:o[e]=n,e==="group"&&_h(o)},destroy:function(){we("destroy",this);var e=this.el;e[Le]=null,dt(e,"mousedown",this._onTapStart),dt(e,"touchstart",this._onTapStart),dt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(dt(e,"dragover",this),dt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Go.splice(Go.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!kn){if(we("hideClone",this),K.eventCanceled)return;Y(Nt,"display","none"),this.options.removeCloneOnHide&&Nt.parentNode&&Nt.parentNode.removeChild(Nt),kn=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(kn){if(we("showClone",this),K.eventCanceled)return;N.parentNode==It&&!this.options.group.revertClone?It.insertBefore(Nt,N):jn?It.insertBefore(Nt,jn):It.appendChild(Nt),this.options.group.revertClone&&this.animate(N,Nt),Y(Nt,"display",""),kn=!1}}};function r0(r){r.dataTransfer&&(r.dataTransfer.dropEffect="move"),r.cancelable&&r.preventDefault()}function xo(r,e,n,o,a,l,u,h){var f,g=r[Le],v=g.options.onMove,y;return window.CustomEvent&&!En&&!xr?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=e,f.from=r,f.dragged=n,f.draggedRect=o,f.related=a||e,f.relatedRect=l||Xt(e),f.willInsertAfter=h,f.originalEvent=u,r.dispatchEvent(f),v&&(y=v.call(g,f,u)),y}function Ta(r){r.draggable=!1}function o0(){Ha=!1}function s0(r,e,n){var o=Xt(Ri(n.el,0,n.options,!0)),a=yh(n.el,n.options,tt),l=10;return e?r.clientX<a.left-l||r.clientY<o.top&&r.clientX<o.right:r.clientY<a.top-l||r.clientY<o.bottom&&r.clientX<o.left}function a0(r,e,n){var o=Xt(tl(n.el,n.options.draggable)),a=yh(n.el,n.options,tt),l=10;return e?r.clientX>a.right+l||r.clientY>o.bottom&&r.clientX>o.left:r.clientY>a.bottom+l||r.clientX>o.right&&r.clientY>o.top}function l0(r,e,n,o,a,l,u,h){var f=o?r.clientY:r.clientX,g=o?n.height:n.width,v=o?n.top:n.left,y=o?n.bottom:n.right,S=!1;if(!u){if(h&&Lo<g*a){if(!br&&(yr===1?f>v+g*l/2:f<y-g*l/2)&&(br=!0),br)S=!0;else if(yr===1?f<v+Lo:f>y-Lo)return-yr}else if(f>v+g*(1-a)/2&&f<y-g*(1-a)/2)return u0(e)}return S=S||u,S&&(f<v+g*l/2||f>y-g*l/2)?f>v+g/2?1:-1:0}function u0(r){return Ue(N)<Ue(r)?1:-1}function c0(r){for(var e=r.tagName+r.className+r.src+r.href+r.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function h0(r){Vo.length=0;for(var e=r.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&Vo.push(o)}}function ko(r){return setTimeout(r,0)}function qa(r){return clearTimeout(r)}jo&&vt(document,"touchmove",function(r){(K.active||xi)&&r.cancelable&&r.preventDefault()});K.utils={on:vt,off:dt,css:Y,find:gh,is:function(e,n){return!!tn(e,n,e,!1)},extend:Xb,throttle:ph,closest:tn,toggleClass:Me,clone:vh,index:Ue,nextTick:ko,cancelNextTick:qa,detectDirection:wh,getChild:Ri};K.get=function(r){return r[Le]};K.mount=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(K.utils=ln(ln({},K.utils),o.utils)),Ar.mount(o)})};K.create=function(r,e){return new K(r,e)};K.version=Ub;var qt=[],lr,Ua,Ga=!1,Ia,Da,Xo,ur;function f0(){function r(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return r.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?vt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?vt(document,"pointermove",this._handleFallbackAutoScroll):o.touches?vt(document,"touchmove",this._handleFallbackAutoScroll):vt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?dt(document,"dragover",this._handleAutoScroll):(dt(document,"pointermove",this._handleFallbackAutoScroll),dt(document,"touchmove",this._handleFallbackAutoScroll),dt(document,"mousemove",this._handleFallbackAutoScroll)),Kc(),Fo(),Yb()},nulling:function(){Xo=Ua=lr=Ga=ur=Ia=Da=null,qt.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var a=this,l=(n.touches?n.touches[0]:n).clientX,u=(n.touches?n.touches[0]:n).clientY,h=document.elementFromPoint(l,u);if(Xo=n,o||this.options.forceAutoScrollFallback||xr||En||pr){Pa(n,this.options,h,o);var f=$n(h,!0);Ga&&(!ur||l!==Ia||u!==Da)&&(ur&&Kc(),ur=setInterval(function(){var g=$n(document.elementFromPoint(l,u),!0);g!==f&&(f=g,Fo()),Pa(n,a.options,g,o)},10),Ia=l,Da=u)}else{if(!this.options.bubbleScroll||$n(h,!0)===sn()){Fo();return}Pa(n,this.options,$n(h,!1),!1)}}},Sn(r,{pluginName:"scroll",initializeByDefault:!0})}function Fo(){qt.forEach(function(r){clearInterval(r.pid)}),qt=[]}function Kc(){clearInterval(ur)}var Pa=ph(function(r,e,n,o){if(e.scroll){var a=(r.touches?r.touches[0]:r).clientX,l=(r.touches?r.touches[0]:r).clientY,u=e.scrollSensitivity,h=e.scrollSpeed,f=sn(),g=!1,v;Ua!==n&&(Ua=n,Fo(),lr=e.scroll,v=e.scrollFn,lr===!0&&(lr=$n(n,!0)));var y=0,S=lr;do{var x=S,I=Xt(x),R=I.top,k=I.bottom,Z=I.left,F=I.right,H=I.width,Q=I.height,gt=void 0,ht=void 0,bt=x.scrollWidth,$t=x.scrollHeight,ft=Y(x),le=x.scrollLeft,Bt=x.scrollTop;x===f?(gt=H<bt&&(ft.overflowX==="auto"||ft.overflowX==="scroll"||ft.overflowX==="visible"),ht=Q<$t&&(ft.overflowY==="auto"||ft.overflowY==="scroll"||ft.overflowY==="visible")):(gt=H<bt&&(ft.overflowX==="auto"||ft.overflowX==="scroll"),ht=Q<$t&&(ft.overflowY==="auto"||ft.overflowY==="scroll"));var ue=gt&&(Math.abs(F-a)<=u&&le+H<bt)-(Math.abs(Z-a)<=u&&!!le),Pt=ht&&(Math.abs(k-l)<=u&&Bt+Q<$t)-(Math.abs(R-l)<=u&&!!Bt);if(!qt[y])for(var Ht=0;Ht<=y;Ht++)qt[Ht]||(qt[Ht]={});(qt[y].vx!=ue||qt[y].vy!=Pt||qt[y].el!==x)&&(qt[y].el=x,qt[y].vx=ue,qt[y].vy=Pt,clearInterval(qt[y].pid),(ue!=0||Pt!=0)&&(g=!0,qt[y].pid=setInterval((function(){o&&this.layer===0&&K.active._onTouchMove(Xo);var ce=qt[this.layer].vy?qt[this.layer].vy*h:0,Ct=qt[this.layer].vx?qt[this.layer].vx*h:0;typeof v=="function"&&v.call(K.dragged.parentNode[Le],Ct,ce,r,Xo,qt[this.layer].el)!=="continue"||mh(qt[this.layer].el,Ct,ce)}).bind({layer:y}),24))),y++}while(e.bubbleScroll&&S!==f&&(S=$n(S,!1)));Ga=g}},30),Ch=function(e){var n=e.originalEvent,o=e.putSortable,a=e.dragEl,l=e.activeSortable,u=e.dispatchSortableEvent,h=e.hideGhostForTarget,f=e.unhideGhostForTarget;if(n){var g=o||l;h();var v=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,y=document.elementFromPoint(v.clientX,v.clientY);f(),g&&!g.el.contains(y)&&(u("spill"),this.onSpill({dragEl:a,putSortable:o}))}};function el(){}el.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var a=Ri(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(n,a):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:Ch};Sn(el,{pluginName:"revertOnSpill"});function nl(){}nl.prototype={onSpill:function(e){var n=e.dragEl,o=e.putSortable,a=o||this.sortable;a.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),a.animateAll()},drop:Ch};Sn(nl,{pluginName:"removeOnSpill"});K.mount(new f0);K.mount(nl,el);var d0=K;function g0(r){r.directive("sort",(e,{value:n,modifiers:o,expression:a},{effect:l,evaluate:u,evaluateLater:h,cleanup:f})=>{if(n==="config"||n==="handle"||n==="group")return;if(n==="key"||n==="item"){if([void 0,null,""].includes(a))return;e._x_sort_key=u(a);return}let g={hideGhost:!o.includes("ghost"),useHandles:!!e.querySelector("[x-sort\\:handle]"),group:b0(e,o)},v=p0(a,h),y=m0(e,o,u),S=v0(e,y,g,(x,I)=>{v(x,I)});f(()=>S.destroy())})}function p0(r,e){if([void 0,null,""].includes(r))return()=>{};let n=e(r);return(o,a)=>{Alpine.dontAutoEvaluateFunctions(()=>{n(l=>{typeof l=="function"&&l(o,a)},{scope:{$key:o,$item:o,$position:a}})})}}function m0(r,e,n){return r.hasAttribute("x-sort:config")?n(r.getAttribute("x-sort:config")):{}}function v0(r,e,n,o){let a,l={animation:150,handle:n.useHandles?"[x-sort\\:handle]":null,group:n.group,filter(u){return r.querySelector("[x-sort\\:item]")?!u.target.closest("[x-sort\\:item]"):!1},onSort(u){if(u.from!==u.to&&u.to!==u.target)return;let h=u.item._x_sort_key,f=u.newIndex;(h!==void 0||h!==null)&&o(h,f)},onStart(){document.body.classList.add("sorting"),a=document.querySelector(".sortable-ghost"),n.hideGhost&&a&&(a.style.opacity="0")},onEnd(){document.body.classList.remove("sorting"),n.hideGhost&&a&&(a.style.opacity="1"),a=void 0,y0(r)}};return new d0(r,{...l,...e})}function y0(r){let e=r.firstChild;for(;e.nextSibling;){if(e.textContent.trim()==="[if ENDBLOCK]><![endif]"){r.append(e);break}e=e.nextSibling}}function b0(r,e){return r.hasAttribute("x-sort:group")?r.getAttribute("x-sort:group"):e.indexOf("group")!==-1?e[e.indexOf("group")+1]:null}var w0=g0;/*! Bundled license information:

sortablejs/modular/sortable.esm.js:
  (**!
   * Sortable 1.15.2
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/function _0(r){r.directive("intersect",r.skipDuringClone((e,{value:n,expression:o,modifiers:a},{evaluateLater:l,cleanup:u})=>{let h=l(o),f={rootMargin:C0(a),threshold:S0(a)},g=new IntersectionObserver(v=>{v.forEach(y=>{y.isIntersecting!==(n==="leave")&&(h(),a.includes("once")&&g.disconnect())})},f);g.observe(e),u(()=>{g.disconnect()})}))}function S0(r){if(r.includes("full"))return .99;if(r.includes("half"))return .5;if(!r.includes("threshold"))return 0;let e=r[r.indexOf("threshold")+1];return e==="100"?1:e==="0"?0:+`.${e}`}function E0(r){let e=r.match(/^(-?[0-9]+)(px|%)?$/);return e?e[1]+(e[2]||"px"):void 0}function C0(r){const e="margin",n="0px 0px 0px 0px",o=r.indexOf(e);if(o===-1)return n;let a=[];for(let l=1;l<5;l++)a.push(E0(r[o+l]||""));return a=a.filter(l=>l!==void 0),a.length?a.join(" ").trim():n}var x0=_0;/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Zc(r,e){var n=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);e&&(o=o.filter(function(a){return Object.getOwnPropertyDescriptor(r,a).enumerable})),n.push.apply(n,o)}return n}function un(r){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Zc(Object(n),!0).forEach(function(o){A0(r,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):Zc(Object(n)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(n,o))})}return r}function $o(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$o=function(e){return typeof e}:$o=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$o(r)}function A0(r,e,n){return e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function en(){return en=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},en.apply(this,arguments)}function T0(r,e){if(r==null)return{};var n={},o=Object.keys(r),a,l;for(l=0;l<o.length;l++)a=o[l],!(e.indexOf(a)>=0)&&(n[a]=r[a]);return n}function I0(r,e){if(r==null)return{};var n=T0(r,e),o,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);for(a=0;a<l.length;a++)o=l[a],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(r,o)&&(n[o]=r[o])}return n}function D0(r){return P0(r)||M0(r)||R0(r)||N0()}function P0(r){if(Array.isArray(r))return Va(r)}function M0(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function R0(r,e){if(r){if(typeof r=="string")return Va(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);if(n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set")return Array.from(r);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Va(r,e)}}function Va(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=r[n];return o}function N0(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O0="1.15.6";function _n(r){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(r)}var Cn=_n(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Tr=_n(/Edge/i),Qc=_n(/firefox/i),wr=_n(/safari/i)&&!_n(/chrome/i)&&!_n(/android/i),il=_n(/iP(ad|od|hone)/i),xh=_n(/chrome/i)&&_n(/android/i),Ah={capture:!1,passive:!1};function st(r,e,n){r.addEventListener(e,n,!Cn&&Ah)}function rt(r,e,n){r.removeEventListener(e,n,!Cn&&Ah)}function Yo(r,e){if(e){if(e[0]===">"&&(e=e.substring(1)),r)try{if(r.matches)return r.matches(e);if(r.msMatchesSelector)return r.msMatchesSelector(e);if(r.webkitMatchesSelector)return r.webkitMatchesSelector(e)}catch{return!1}return!1}}function Th(r){return r.host&&r!==document&&r.host.nodeType?r.host:r.parentNode}function Ce(r,e,n,o){if(r){n=n||document;do{if(e!=null&&(e[0]===">"?r.parentNode===n&&Yo(r,e):Yo(r,e))||o&&r===n)return r;if(r===n)break}while(r=Th(r))}return null}var Jc=/\s+/g;function Gt(r,e,n){if(r&&e)if(r.classList)r.classList[n?"add":"remove"](e);else{var o=(" "+r.className+" ").replace(Jc," ").replace(" "+e+" "," ");r.className=(o+(n?" "+e:"")).replace(Jc," ")}}function W(r,e,n){var o=r&&r.style;if(o){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(r,""):r.currentStyle&&(n=r.currentStyle),e===void 0?n:n[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=n+(typeof n=="string"?"":"px")}}function ni(r,e){var n="";if(typeof r=="string")n=r;else do{var o=W(r,"transform");o&&o!=="none"&&(n=o+" "+n)}while(!e&&(r=r.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function Ih(r,e,n){if(r){var o=r.getElementsByTagName(e),a=0,l=o.length;if(n)for(;a<l;a++)n(o[a],a);return o}return[]}function an(){var r=document.scrollingElement;return r||document.documentElement}function At(r,e,n,o,a){if(!(!r.getBoundingClientRect&&r!==window)){var l,u,h,f,g,v,y;if(r!==window&&r.parentNode&&r!==an()?(l=r.getBoundingClientRect(),u=l.top,h=l.left,f=l.bottom,g=l.right,v=l.height,y=l.width):(u=0,h=0,f=window.innerHeight,g=window.innerWidth,v=window.innerHeight,y=window.innerWidth),(e||n)&&r!==window&&(a=a||r.parentNode,!Cn))do if(a&&a.getBoundingClientRect&&(W(a,"transform")!=="none"||n&&W(a,"position")!=="static")){var S=a.getBoundingClientRect();u-=S.top+parseInt(W(a,"border-top-width")),h-=S.left+parseInt(W(a,"border-left-width")),f=u+l.height,g=h+l.width;break}while(a=a.parentNode);if(o&&r!==window){var x=ni(a||r),I=x&&x.a,R=x&&x.d;x&&(u/=R,h/=I,y/=I,v/=R,f=u+v,g=h+y)}return{top:u,left:h,bottom:f,right:g,width:y,height:v}}}function jc(r,e,n){for(var o=Bn(r,!0),a=At(r)[e];o;){var l=At(o)[n],u=void 0;if(u=a>=l,!u)return o;if(o===an())break;o=Bn(o,!1)}return!1}function Ni(r,e,n,o){for(var a=0,l=0,u=r.children;l<u.length;){if(u[l].style.display!=="none"&&u[l]!==X.ghost&&(o||u[l]!==X.dragged)&&Ce(u[l],n.draggable,r,!1)){if(a===e)return u[l];a++}l++}return null}function rl(r,e){for(var n=r.lastElementChild;n&&(n===X.ghost||W(n,"display")==="none"||e&&!Yo(n,e));)n=n.previousElementSibling;return n||null}function Vt(r,e){var n=0;if(!r||!r.parentNode)return-1;for(;r=r.previousElementSibling;)r.nodeName.toUpperCase()!=="TEMPLATE"&&r!==X.clone&&(!e||Yo(r,e))&&n++;return n}function th(r){var e=0,n=0,o=an();if(r)do{var a=ni(r),l=a.a,u=a.d;e+=r.scrollLeft*l,n+=r.scrollTop*u}while(r!==o&&(r=r.parentNode));return[e,n]}function L0(r,e){for(var n in r)if(r.hasOwnProperty(n)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===r[n][o])return Number(n)}return-1}function Bn(r,e){if(!r||!r.getBoundingClientRect)return an();var n=r,o=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=W(n);if(n.clientWidth<n.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return an();if(o||e)return n;o=!0}}while(n=n.parentNode);return an()}function k0(r,e){if(r&&e)for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}function Ma(r,e){return Math.round(r.top)===Math.round(e.top)&&Math.round(r.left)===Math.round(e.left)&&Math.round(r.height)===Math.round(e.height)&&Math.round(r.width)===Math.round(e.width)}var _r;function Dh(r,e){return function(){if(!_r){var n=arguments,o=this;n.length===1?r.call(o,n[0]):r.apply(o,n),_r=setTimeout(function(){_r=void 0},e)}}}function F0(){clearTimeout(_r),_r=void 0}function Ph(r,e,n){r.scrollLeft+=e,r.scrollTop+=n}function ol(r){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(r).cloneNode(!0):n?n(r).clone(!0)[0]:r.cloneNode(!0)}function eh(r,e){W(r,"position","absolute"),W(r,"top",e.top),W(r,"left",e.left),W(r,"width",e.width),W(r,"height",e.height)}function Ra(r){W(r,"position",""),W(r,"top",""),W(r,"left",""),W(r,"width",""),W(r,"height","")}function Mh(r,e,n){var o={};return Array.from(r.children).forEach(function(a){var l,u,h,f;if(!(!Ce(a,e.draggable,r,!1)||a.animated||a===n)){var g=At(a);o.left=Math.min((l=o.left)!==null&&l!==void 0?l:1/0,g.left),o.top=Math.min((u=o.top)!==null&&u!==void 0?u:1/0,g.top),o.right=Math.max((h=o.right)!==null&&h!==void 0?h:-1/0,g.right),o.bottom=Math.max((f=o.bottom)!==null&&f!==void 0?f:-1/0,g.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var ne="Sortable"+new Date().getTime();function $0(){var r=[],e;return{captureAnimationState:function(){if(r=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(a){if(!(W(a,"display")==="none"||a===X.ghost)){r.push({target:a,rect:At(a)});var l=un({},r[r.length-1].rect);if(a.thisAnimationDuration){var u=ni(a,!0);u&&(l.top-=u.f,l.left-=u.e)}a.fromRect=l}})}},addAnimationState:function(o){r.push(o)},removeAnimationState:function(o){r.splice(L0(r,{target:o}),1)},animateAll:function(o){var a=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var l=!1,u=0;r.forEach(function(h){var f=0,g=h.target,v=g.fromRect,y=At(g),S=g.prevFromRect,x=g.prevToRect,I=h.rect,R=ni(g,!0);R&&(y.top-=R.f,y.left-=R.e),g.toRect=y,g.thisAnimationDuration&&Ma(S,y)&&!Ma(v,y)&&(I.top-y.top)/(I.left-y.left)===(v.top-y.top)/(v.left-y.left)&&(f=W0(I,S,x,a.options)),Ma(y,v)||(g.prevFromRect=v,g.prevToRect=y,f||(f=a.options.animation),a.animate(g,I,y,f)),f&&(l=!0,u=Math.max(u,f),clearTimeout(g.animationResetTimer),g.animationResetTimer=setTimeout(function(){g.animationTime=0,g.prevFromRect=null,g.fromRect=null,g.prevToRect=null,g.thisAnimationDuration=null},f),g.thisAnimationDuration=f)}),clearTimeout(e),l?e=setTimeout(function(){typeof o=="function"&&o()},u):typeof o=="function"&&o(),r=[]},animate:function(o,a,l,u){if(u){W(o,"transition",""),W(o,"transform","");var h=ni(this.el),f=h&&h.a,g=h&&h.d,v=(a.left-l.left)/(f||1),y=(a.top-l.top)/(g||1);o.animatingX=!!v,o.animatingY=!!y,W(o,"transform","translate3d("+v+"px,"+y+"px,0)"),this.forRepaintDummy=B0(o),W(o,"transition","transform "+u+"ms"+(this.options.easing?" "+this.options.easing:"")),W(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){W(o,"transition",""),W(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},u)}}}}function B0(r){return r.offsetWidth}function W0(r,e,n,o){return Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*o.animation}var Si=[],Na={initializeByDefault:!0},Ir={mount:function(e){for(var n in Na)Na.hasOwnProperty(n)&&!(n in e)&&(e[n]=Na[n]);Si.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Si.push(e)},pluginEvent:function(e,n,o){var a=this;this.eventCanceled=!1,o.cancel=function(){a.eventCanceled=!0};var l=e+"Global";Si.forEach(function(u){n[u.pluginName]&&(n[u.pluginName][l]&&n[u.pluginName][l](un({sortable:n},o)),n.options[u.pluginName]&&n[u.pluginName][e]&&n[u.pluginName][e](un({sortable:n},o)))})},initializePlugins:function(e,n,o,a){Si.forEach(function(h){var f=h.pluginName;if(!(!e.options[f]&&!h.initializeByDefault)){var g=new h(e,n,e.options);g.sortable=e,g.options=e.options,e[f]=g,en(o,g.defaults)}});for(var l in e.options)if(e.options.hasOwnProperty(l)){var u=this.modifyOption(e,l,e.options[l]);typeof u<"u"&&(e.options[l]=u)}},getEventProperties:function(e,n){var o={};return Si.forEach(function(a){typeof a.eventProperties=="function"&&en(o,a.eventProperties.call(n[a.pluginName],e))}),o},modifyOption:function(e,n,o){var a;return Si.forEach(function(l){e[l.pluginName]&&l.optionListeners&&typeof l.optionListeners[n]=="function"&&(a=l.optionListeners[n].call(e[l.pluginName],o))}),a}};function cr(r){var e=r.sortable,n=r.rootEl,o=r.name,a=r.targetEl,l=r.cloneEl,u=r.toEl,h=r.fromEl,f=r.oldIndex,g=r.newIndex,v=r.oldDraggableIndex,y=r.newDraggableIndex,S=r.originalEvent,x=r.putSortable,I=r.extraEventProperties;if(e=e||n&&n[ne],!!e){var R,k=e.options,Z="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!Cn&&!Tr?R=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(R=document.createEvent("Event"),R.initEvent(o,!0,!0)),R.to=u||n,R.from=h||n,R.item=a||n,R.clone=l,R.oldIndex=f,R.newIndex=g,R.oldDraggableIndex=v,R.newDraggableIndex=y,R.originalEvent=S,R.pullMode=x?x.lastPutMode:void 0;var F=un(un({},I),Ir.getEventProperties(o,e));for(var H in F)R[H]=F[H];n&&n.dispatchEvent(R),k[Z]&&k[Z].call(e,R)}}var z0=["evt"],_e=function(e,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.evt,l=I0(o,z0);Ir.pluginEvent.bind(X)(e,n,un({dragEl:O,parentEl:Ft,ghostEl:et,rootEl:Dt,nextEl:ti,lastDownEl:Bo,cloneEl:Ot,cloneHidden:Fn,dragStarted:hr,putSortable:ee,activeSortable:X.active,originalEvent:a,oldIndex:Ii,oldDraggableIndex:Sr,newIndex:Oe,newDraggableIndex:Ln,hideGhostForTarget:Lh,unhideGhostForTarget:kh,cloneNowHidden:function(){Fn=!0},cloneNowShown:function(){Fn=!1},dispatchSortableEvent:function(h){pe({sortable:n,name:h,originalEvent:a})}},l))};function pe(r){cr(un({putSortable:ee,cloneEl:Ot,targetEl:O,rootEl:Dt,oldIndex:Ii,oldDraggableIndex:Sr,newIndex:Oe,newDraggableIndex:Ln},r))}var O,Ft,et,Dt,ti,Bo,Ot,Fn,Ii,Oe,Sr,Ln,Ao,ee,Ai=!1,Ko=!1,Zo=[],Qn,Je,Oa,La,nh,ih,hr,Ei,Er,Cr=!1,To=!1,Wo,ae,ka=[],Xa=!1,Qo=[],ts=typeof document<"u",Io=il,rh=Tr||Cn?"cssFloat":"float",H0=ts&&!xh&&!il&&"draggable"in document.createElement("div"),Rh=function(){if(ts){if(Cn)return!1;var r=document.createElement("x");return r.style.cssText="pointer-events:auto",r.style.pointerEvents==="auto"}}(),Nh=function(e,n){var o=W(e),a=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),l=Ni(e,0,n),u=Ni(e,1,n),h=l&&W(l),f=u&&W(u),g=h&&parseInt(h.marginLeft)+parseInt(h.marginRight)+At(l).width,v=f&&parseInt(f.marginLeft)+parseInt(f.marginRight)+At(u).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(l&&h.float&&h.float!=="none"){var y=h.float==="left"?"left":"right";return u&&(f.clear==="both"||f.clear===y)?"vertical":"horizontal"}return l&&(h.display==="block"||h.display==="flex"||h.display==="table"||h.display==="grid"||g>=a&&o[rh]==="none"||u&&o[rh]==="none"&&g+v>a)?"vertical":"horizontal"},q0=function(e,n,o){var a=o?e.left:e.top,l=o?e.right:e.bottom,u=o?e.width:e.height,h=o?n.left:n.top,f=o?n.right:n.bottom,g=o?n.width:n.height;return a===h||l===f||a+u/2===h+g/2},U0=function(e,n){var o;return Zo.some(function(a){var l=a[ne].options.emptyInsertThreshold;if(!(!l||rl(a))){var u=At(a),h=e>=u.left-l&&e<=u.right+l,f=n>=u.top-l&&n<=u.bottom+l;if(h&&f)return o=a}}),o},Oh=function(e){function n(l,u){return function(h,f,g,v){var y=h.options.group.name&&f.options.group.name&&h.options.group.name===f.options.group.name;if(l==null&&(u||y))return!0;if(l==null||l===!1)return!1;if(u&&l==="clone")return l;if(typeof l=="function")return n(l(h,f,g,v),u)(h,f,g,v);var S=(u?h:f).options.group.name;return l===!0||typeof l=="string"&&l===S||l.join&&l.indexOf(S)>-1}}var o={},a=e.group;(!a||$o(a)!="object")&&(a={name:a}),o.name=a.name,o.checkPull=n(a.pull,!0),o.checkPut=n(a.put),o.revertClone=a.revertClone,e.group=o},Lh=function(){!Rh&&et&&W(et,"display","none")},kh=function(){!Rh&&et&&W(et,"display","")};ts&&!xh&&document.addEventListener("click",function(r){if(Ko)return r.preventDefault(),r.stopPropagation&&r.stopPropagation(),r.stopImmediatePropagation&&r.stopImmediatePropagation(),Ko=!1,!1},!0);var Jn=function(e){if(O){e=e.touches?e.touches[0]:e;var n=U0(e.clientX,e.clientY);if(n){var o={};for(var a in e)e.hasOwnProperty(a)&&(o[a]=e[a]);o.target=o.rootEl=n,o.preventDefault=void 0,o.stopPropagation=void 0,n[ne]._onDragOver(o)}}},G0=function(e){O&&O.parentNode[ne]._isOutsideThisEl(e.target)};function X(r,e){if(!(r&&r.nodeType&&r.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(r));this.el=r,this.options=e=en({},e),r[ne]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(r.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Nh(r,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(u,h){u.setData("Text",h.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:X.supportPointer!==!1&&"PointerEvent"in window&&(!wr||il),emptyInsertThreshold:5};Ir.initializePlugins(this,r,n);for(var o in n)!(o in e)&&(e[o]=n[o]);Oh(e);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=e.forceFallback?!1:H0,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?st(r,"pointerdown",this._onTapStart):(st(r,"mousedown",this._onTapStart),st(r,"touchstart",this._onTapStart)),this.nativeDraggable&&(st(r,"dragover",this),st(r,"dragenter",this)),Zo.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),en(this,$0())}X.prototype={constructor:X,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ei=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,O):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,o=this.el,a=this.options,l=a.preventOnFilter,u=e.type,h=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,f=(h||e).target,g=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||f,v=a.filter;if(j0(o),!O&&!(/mousedown|pointerdown/.test(u)&&e.button!==0||a.disabled)&&!g.isContentEditable&&!(!this.nativeDraggable&&wr&&f&&f.tagName.toUpperCase()==="SELECT")&&(f=Ce(f,a.draggable,o,!1),!(f&&f.animated)&&Bo!==f)){if(Ii=Vt(f),Sr=Vt(f,a.draggable),typeof v=="function"){if(v.call(this,e,f,this)){pe({sortable:n,rootEl:g,name:"filter",targetEl:f,toEl:o,fromEl:o}),_e("filter",n,{evt:e}),l&&e.preventDefault();return}}else if(v&&(v=v.split(",").some(function(y){if(y=Ce(g,y.trim(),o,!1),y)return pe({sortable:n,rootEl:y,name:"filter",targetEl:f,fromEl:o,toEl:o}),_e("filter",n,{evt:e}),!0}),v)){l&&e.preventDefault();return}a.handle&&!Ce(g,a.handle,o,!1)||this._prepareDragStart(e,h,f)}}},_prepareDragStart:function(e,n,o){var a=this,l=a.el,u=a.options,h=l.ownerDocument,f;if(o&&!O&&o.parentNode===l){var g=At(o);if(Dt=l,O=o,Ft=O.parentNode,ti=O.nextSibling,Bo=o,Ao=u.group,X.dragged=O,Qn={target:O,clientX:(n||e).clientX,clientY:(n||e).clientY},nh=Qn.clientX-g.left,ih=Qn.clientY-g.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,O.style["will-change"]="all",f=function(){if(_e("delayEnded",a,{evt:e}),X.eventCanceled){a._onDrop();return}a._disableDelayedDragEvents(),!Qc&&a.nativeDraggable&&(O.draggable=!0),a._triggerDragStart(e,n),pe({sortable:a,name:"choose",originalEvent:e}),Gt(O,u.chosenClass,!0)},u.ignore.split(",").forEach(function(v){Ih(O,v.trim(),Fa)}),st(h,"dragover",Jn),st(h,"mousemove",Jn),st(h,"touchmove",Jn),u.supportPointer?(st(h,"pointerup",a._onDrop),!this.nativeDraggable&&st(h,"pointercancel",a._onDrop)):(st(h,"mouseup",a._onDrop),st(h,"touchend",a._onDrop),st(h,"touchcancel",a._onDrop)),Qc&&this.nativeDraggable&&(this.options.touchStartThreshold=4,O.draggable=!0),_e("delayStart",this,{evt:e}),u.delay&&(!u.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Tr||Cn))){if(X.eventCanceled){this._onDrop();return}u.supportPointer?(st(h,"pointerup",a._disableDelayedDrag),st(h,"pointercancel",a._disableDelayedDrag)):(st(h,"mouseup",a._disableDelayedDrag),st(h,"touchend",a._disableDelayedDrag),st(h,"touchcancel",a._disableDelayedDrag)),st(h,"mousemove",a._delayedDragTouchMoveHandler),st(h,"touchmove",a._delayedDragTouchMoveHandler),u.supportPointer&&st(h,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(f,u.delay)}else f()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){O&&Fa(O),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;rt(e,"mouseup",this._disableDelayedDrag),rt(e,"touchend",this._disableDelayedDrag),rt(e,"touchcancel",this._disableDelayedDrag),rt(e,"pointerup",this._disableDelayedDrag),rt(e,"pointercancel",this._disableDelayedDrag),rt(e,"mousemove",this._delayedDragTouchMoveHandler),rt(e,"touchmove",this._delayedDragTouchMoveHandler),rt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?st(document,"pointermove",this._onTouchMove):n?st(document,"touchmove",this._onTouchMove):st(document,"mousemove",this._onTouchMove):(st(O,"dragend",this),st(Dt,"dragstart",this._onDragStart));try{document.selection?zo(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Ai=!1,Dt&&O){_e("dragStarted",this,{evt:n}),this.nativeDraggable&&st(document,"dragover",G0);var o=this.options;!e&&Gt(O,o.dragClass,!1),Gt(O,o.ghostClass,!0),X.active=this,e&&this._appendGhost(),pe({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Je){this._lastX=Je.clientX,this._lastY=Je.clientY,Lh();for(var e=document.elementFromPoint(Je.clientX,Je.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Je.clientX,Je.clientY),e!==n);)n=e;if(O.parentNode[ne]._isOutsideThisEl(e),n)do{if(n[ne]){var o=void 0;if(o=n[ne]._onDragOver({clientX:Je.clientX,clientY:Je.clientY,target:e,rootEl:n}),o&&!this.options.dragoverBubble)break}e=n}while(n=Th(n));kh()}},_onTouchMove:function(e){if(Qn){var n=this.options,o=n.fallbackTolerance,a=n.fallbackOffset,l=e.touches?e.touches[0]:e,u=et&&ni(et,!0),h=et&&u&&u.a,f=et&&u&&u.d,g=Io&&ae&&th(ae),v=(l.clientX-Qn.clientX+a.x)/(h||1)+(g?g[0]-ka[0]:0)/(h||1),y=(l.clientY-Qn.clientY+a.y)/(f||1)+(g?g[1]-ka[1]:0)/(f||1);if(!X.active&&!Ai){if(o&&Math.max(Math.abs(l.clientX-this._lastX),Math.abs(l.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(et){u?(u.e+=v-(Oa||0),u.f+=y-(La||0)):u={a:1,b:0,c:0,d:1,e:v,f:y};var S="matrix(".concat(u.a,",").concat(u.b,",").concat(u.c,",").concat(u.d,",").concat(u.e,",").concat(u.f,")");W(et,"webkitTransform",S),W(et,"mozTransform",S),W(et,"msTransform",S),W(et,"transform",S),Oa=v,La=y,Je=l}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!et){var e=this.options.fallbackOnBody?document.body:Dt,n=At(O,!0,Io,!0,e),o=this.options;if(Io){for(ae=e;W(ae,"position")==="static"&&W(ae,"transform")==="none"&&ae!==document;)ae=ae.parentNode;ae!==document.body&&ae!==document.documentElement?(ae===document&&(ae=an()),n.top+=ae.scrollTop,n.left+=ae.scrollLeft):ae=an(),ka=th(ae)}et=O.cloneNode(!0),Gt(et,o.ghostClass,!1),Gt(et,o.fallbackClass,!0),Gt(et,o.dragClass,!0),W(et,"transition",""),W(et,"transform",""),W(et,"box-sizing","border-box"),W(et,"margin",0),W(et,"top",n.top),W(et,"left",n.left),W(et,"width",n.width),W(et,"height",n.height),W(et,"opacity","0.8"),W(et,"position",Io?"absolute":"fixed"),W(et,"zIndex","100000"),W(et,"pointerEvents","none"),X.ghost=et,e.appendChild(et),W(et,"transform-origin",nh/parseInt(et.style.width)*100+"% "+ih/parseInt(et.style.height)*100+"%")}},_onDragStart:function(e,n){var o=this,a=e.dataTransfer,l=o.options;if(_e("dragStart",this,{evt:e}),X.eventCanceled){this._onDrop();return}_e("setupClone",this),X.eventCanceled||(Ot=ol(O),Ot.removeAttribute("id"),Ot.draggable=!1,Ot.style["will-change"]="",this._hideClone(),Gt(Ot,this.options.chosenClass,!1),X.clone=Ot),o.cloneId=zo(function(){_e("clone",o),!X.eventCanceled&&(o.options.removeCloneOnHide||Dt.insertBefore(Ot,O),o._hideClone(),pe({sortable:o,name:"clone"}))}),!n&&Gt(O,l.dragClass,!0),n?(Ko=!0,o._loopId=setInterval(o._emulateDragOver,50)):(rt(document,"mouseup",o._onDrop),rt(document,"touchend",o._onDrop),rt(document,"touchcancel",o._onDrop),a&&(a.effectAllowed="move",l.setData&&l.setData.call(o,a,O)),st(document,"drop",o),W(O,"transform","translateZ(0)")),Ai=!0,o._dragStartId=zo(o._dragStarted.bind(o,n,e)),st(document,"selectstart",o),hr=!0,window.getSelection().removeAllRanges(),wr&&W(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,o=e.target,a,l,u,h=this.options,f=h.group,g=X.active,v=Ao===f,y=h.sort,S=ee||g,x,I=this,R=!1;if(Xa)return;function k(Zt,Oi){_e(Zt,I,un({evt:e,isOwner:v,axis:x?"vertical":"horizontal",revert:u,dragRect:a,targetRect:l,canSort:y,fromSortable:S,target:o,completed:F,onMove:function(ie,Li){return Do(Dt,n,O,a,ie,At(ie),e,Li)},changed:H},Oi))}function Z(){k("dragOverAnimationCapture"),I.captureAnimationState(),I!==S&&S.captureAnimationState()}function F(Zt){return k("dragOverCompleted",{insertion:Zt}),Zt&&(v?g._hideClone():g._showClone(I),I!==S&&(Gt(O,ee?ee.options.ghostClass:g.options.ghostClass,!1),Gt(O,h.ghostClass,!0)),ee!==I&&I!==X.active?ee=I:I===X.active&&ee&&(ee=null),S===I&&(I._ignoreWhileAnimating=o),I.animateAll(function(){k("dragOverAnimationComplete"),I._ignoreWhileAnimating=null}),I!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(o===O&&!O.animated||o===n&&!o.animated)&&(Ei=null),!h.dragoverBubble&&!e.rootEl&&o!==document&&(O.parentNode[ne]._isOutsideThisEl(e.target),!Zt&&Jn(e)),!h.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),R=!0}function H(){Oe=Vt(O),Ln=Vt(O,h.draggable),pe({sortable:I,name:"change",toEl:n,newIndex:Oe,newDraggableIndex:Ln,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=Ce(o,h.draggable,n,!0),k("dragOver"),X.eventCanceled)return R;if(O.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||I._ignoreWhileAnimating===o)return F(!1);if(Ko=!1,g&&!h.disabled&&(v?y||(u=Ft!==Dt):ee===this||(this.lastPutMode=Ao.checkPull(this,g,O,e))&&f.checkPut(this,g,O,e))){if(x=this._getDirection(e,o)==="vertical",a=At(O),k("dragOverValid"),X.eventCanceled)return R;if(u)return Ft=Dt,Z(),this._hideClone(),k("revert"),X.eventCanceled||(ti?Dt.insertBefore(O,ti):Dt.appendChild(O)),F(!0);var Q=rl(n,h.draggable);if(!Q||K0(e,x,this)&&!Q.animated){if(Q===O)return F(!1);if(Q&&n===e.target&&(o=Q),o&&(l=At(o)),Do(Dt,n,O,a,o,l,e,!!o)!==!1)return Z(),Q&&Q.nextSibling?n.insertBefore(O,Q.nextSibling):n.appendChild(O),Ft=n,H(),F(!0)}else if(Q&&Y0(e,x,this)){var gt=Ni(n,0,h,!0);if(gt===O)return F(!1);if(o=gt,l=At(o),Do(Dt,n,O,a,o,l,e,!1)!==!1)return Z(),n.insertBefore(O,gt),Ft=n,H(),F(!0)}else if(o.parentNode===n){l=At(o);var ht=0,bt,$t=O.parentNode!==n,ft=!q0(O.animated&&O.toRect||a,o.animated&&o.toRect||l,x),le=x?"top":"left",Bt=jc(o,"top","top")||jc(O,"top","top"),ue=Bt?Bt.scrollTop:void 0;Ei!==o&&(bt=l[le],Cr=!1,To=!ft&&h.invertSwap||$t),ht=Z0(e,o,l,x,ft?1:h.swapThreshold,h.invertedSwapThreshold==null?h.swapThreshold:h.invertedSwapThreshold,To,Ei===o);var Pt;if(ht!==0){var Ht=Vt(O);do Ht-=ht,Pt=Ft.children[Ht];while(Pt&&(W(Pt,"display")==="none"||Pt===et))}if(ht===0||Pt===o)return F(!1);Ei=o,Er=ht;var ce=o.nextElementSibling,Ct=!1;Ct=ht===1;var Mt=Do(Dt,n,O,a,o,l,e,Ct);if(Mt!==!1)return(Mt===1||Mt===-1)&&(Ct=Mt===1),Xa=!0,setTimeout(X0,30),Z(),Ct&&!ce?n.appendChild(O):o.parentNode.insertBefore(O,Ct?ce:o),Bt&&Ph(Bt,0,ue-Bt.scrollTop),Ft=O.parentNode,bt!==void 0&&!To&&(Wo=Math.abs(bt-At(o)[le])),H(),F(!0)}if(n.contains(O))return F(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){rt(document,"mousemove",this._onTouchMove),rt(document,"touchmove",this._onTouchMove),rt(document,"pointermove",this._onTouchMove),rt(document,"dragover",Jn),rt(document,"mousemove",Jn),rt(document,"touchmove",Jn)},_offUpEvents:function(){var e=this.el.ownerDocument;rt(e,"mouseup",this._onDrop),rt(e,"touchend",this._onDrop),rt(e,"pointerup",this._onDrop),rt(e,"pointercancel",this._onDrop),rt(e,"touchcancel",this._onDrop),rt(document,"selectstart",this)},_onDrop:function(e){var n=this.el,o=this.options;if(Oe=Vt(O),Ln=Vt(O,o.draggable),_e("drop",this,{evt:e}),Ft=O&&O.parentNode,Oe=Vt(O),Ln=Vt(O,o.draggable),X.eventCanceled){this._nulling();return}Ai=!1,To=!1,Cr=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Ya(this.cloneId),Ya(this._dragStartId),this.nativeDraggable&&(rt(document,"drop",this),rt(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),wr&&W(document.body,"user-select",""),W(O,"transform",""),e&&(hr&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),et&&et.parentNode&&et.parentNode.removeChild(et),(Dt===Ft||ee&&ee.lastPutMode!=="clone")&&Ot&&Ot.parentNode&&Ot.parentNode.removeChild(Ot),O&&(this.nativeDraggable&&rt(O,"dragend",this),Fa(O),O.style["will-change"]="",hr&&!Ai&&Gt(O,ee?ee.options.ghostClass:this.options.ghostClass,!1),Gt(O,this.options.chosenClass,!1),pe({sortable:this,name:"unchoose",toEl:Ft,newIndex:null,newDraggableIndex:null,originalEvent:e}),Dt!==Ft?(Oe>=0&&(pe({rootEl:Ft,name:"add",toEl:Ft,fromEl:Dt,originalEvent:e}),pe({sortable:this,name:"remove",toEl:Ft,originalEvent:e}),pe({rootEl:Ft,name:"sort",toEl:Ft,fromEl:Dt,originalEvent:e}),pe({sortable:this,name:"sort",toEl:Ft,originalEvent:e})),ee&&ee.save()):Oe!==Ii&&Oe>=0&&(pe({sortable:this,name:"update",toEl:Ft,originalEvent:e}),pe({sortable:this,name:"sort",toEl:Ft,originalEvent:e})),X.active&&((Oe==null||Oe===-1)&&(Oe=Ii,Ln=Sr),pe({sortable:this,name:"end",toEl:Ft,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){_e("nulling",this),Dt=O=Ft=et=ti=Ot=Bo=Fn=Qn=Je=hr=Oe=Ln=Ii=Sr=Ei=Er=ee=Ao=X.dragged=X.ghost=X.clone=X.active=null,Qo.forEach(function(e){e.checked=!0}),Qo.length=Oa=La=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":O&&(this._onDragOver(e),V0(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,o=this.el.children,a=0,l=o.length,u=this.options;a<l;a++)n=o[a],Ce(n,u.draggable,this.el,!1)&&e.push(n.getAttribute(u.dataIdAttr)||J0(n));return e},sort:function(e,n){var o={},a=this.el;this.toArray().forEach(function(l,u){var h=a.children[u];Ce(h,this.options.draggable,a,!1)&&(o[l]=h)},this),n&&this.captureAnimationState(),e.forEach(function(l){o[l]&&(a.removeChild(o[l]),a.appendChild(o[l]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return Ce(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var o=this.options;if(n===void 0)return o[e];var a=Ir.modifyOption(this,e,n);typeof a<"u"?o[e]=a:o[e]=n,e==="group"&&Oh(o)},destroy:function(){_e("destroy",this);var e=this.el;e[ne]=null,rt(e,"mousedown",this._onTapStart),rt(e,"touchstart",this._onTapStart),rt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(rt(e,"dragover",this),rt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Zo.splice(Zo.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Fn){if(_e("hideClone",this),X.eventCanceled)return;W(Ot,"display","none"),this.options.removeCloneOnHide&&Ot.parentNode&&Ot.parentNode.removeChild(Ot),Fn=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Fn){if(_e("showClone",this),X.eventCanceled)return;O.parentNode==Dt&&!this.options.group.revertClone?Dt.insertBefore(Ot,O):ti?Dt.insertBefore(Ot,ti):Dt.appendChild(Ot),this.options.group.revertClone&&this.animate(O,Ot),W(Ot,"display",""),Fn=!1}}};function V0(r){r.dataTransfer&&(r.dataTransfer.dropEffect="move"),r.cancelable&&r.preventDefault()}function Do(r,e,n,o,a,l,u,h){var f,g=r[ne],v=g.options.onMove,y;return window.CustomEvent&&!Cn&&!Tr?f=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent("move",!0,!0)),f.to=e,f.from=r,f.dragged=n,f.draggedRect=o,f.related=a||e,f.relatedRect=l||At(e),f.willInsertAfter=h,f.originalEvent=u,r.dispatchEvent(f),v&&(y=v.call(g,f,u)),y}function Fa(r){r.draggable=!1}function X0(){Xa=!1}function Y0(r,e,n){var o=At(Ni(n.el,0,n.options,!0)),a=Mh(n.el,n.options,et),l=10;return e?r.clientX<a.left-l||r.clientY<o.top&&r.clientX<o.right:r.clientY<a.top-l||r.clientY<o.bottom&&r.clientX<o.left}function K0(r,e,n){var o=At(rl(n.el,n.options.draggable)),a=Mh(n.el,n.options,et),l=10;return e?r.clientX>a.right+l||r.clientY>o.bottom&&r.clientX>o.left:r.clientY>a.bottom+l||r.clientX>o.right&&r.clientY>o.top}function Z0(r,e,n,o,a,l,u,h){var f=o?r.clientY:r.clientX,g=o?n.height:n.width,v=o?n.top:n.left,y=o?n.bottom:n.right,S=!1;if(!u){if(h&&Wo<g*a){if(!Cr&&(Er===1?f>v+g*l/2:f<y-g*l/2)&&(Cr=!0),Cr)S=!0;else if(Er===1?f<v+Wo:f>y-Wo)return-Er}else if(f>v+g*(1-a)/2&&f<y-g*(1-a)/2)return Q0(e)}return S=S||u,S&&(f<v+g*l/2||f>y-g*l/2)?f>v+g/2?1:-1:0}function Q0(r){return Vt(O)<Vt(r)?1:-1}function J0(r){for(var e=r.tagName+r.className+r.src+r.href+r.textContent,n=e.length,o=0;n--;)o+=e.charCodeAt(n);return o.toString(36)}function j0(r){Qo.length=0;for(var e=r.getElementsByTagName("input"),n=e.length;n--;){var o=e[n];o.checked&&Qo.push(o)}}function zo(r){return setTimeout(r,0)}function Ya(r){return clearTimeout(r)}ts&&st(document,"touchmove",function(r){(X.active||Ai)&&r.cancelable&&r.preventDefault()});X.utils={on:st,off:rt,css:W,find:Ih,is:function(e,n){return!!Ce(e,n,e,!1)},extend:k0,throttle:Dh,closest:Ce,toggleClass:Gt,clone:ol,index:Vt,nextTick:zo,cancelNextTick:Ya,detectDirection:Nh,getChild:Ni,expando:ne};X.get=function(r){return r[ne]};X.mount=function(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(X.utils=un(un({},X.utils),o.utils)),Ir.mount(o)})};X.create=function(r,e){return new X(r,e)};X.version=O0;var Ut=[],fr,Ka,Za=!1,$a,Ba,Jo,dr;function tw(){function r(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return r.prototype={dragStarted:function(n){var o=n.originalEvent;this.sortable.nativeDraggable?st(document,"dragover",this._handleAutoScroll):this.options.supportPointer?st(document,"pointermove",this._handleFallbackAutoScroll):o.touches?st(document,"touchmove",this._handleFallbackAutoScroll):st(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var o=n.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?rt(document,"dragover",this._handleAutoScroll):(rt(document,"pointermove",this._handleFallbackAutoScroll),rt(document,"touchmove",this._handleFallbackAutoScroll),rt(document,"mousemove",this._handleFallbackAutoScroll)),oh(),Ho(),F0()},nulling:function(){Jo=Ka=fr=Za=dr=$a=Ba=null,Ut.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,o){var a=this,l=(n.touches?n.touches[0]:n).clientX,u=(n.touches?n.touches[0]:n).clientY,h=document.elementFromPoint(l,u);if(Jo=n,o||this.options.forceAutoScrollFallback||Tr||Cn||wr){Wa(n,this.options,h,o);var f=Bn(h,!0);Za&&(!dr||l!==$a||u!==Ba)&&(dr&&oh(),dr=setInterval(function(){var g=Bn(document.elementFromPoint(l,u),!0);g!==f&&(f=g,Ho()),Wa(n,a.options,g,o)},10),$a=l,Ba=u)}else{if(!this.options.bubbleScroll||Bn(h,!0)===an()){Ho();return}Wa(n,this.options,Bn(h,!1),!1)}}},en(r,{pluginName:"scroll",initializeByDefault:!0})}function Ho(){Ut.forEach(function(r){clearInterval(r.pid)}),Ut=[]}function oh(){clearInterval(dr)}var Wa=Dh(function(r,e,n,o){if(e.scroll){var a=(r.touches?r.touches[0]:r).clientX,l=(r.touches?r.touches[0]:r).clientY,u=e.scrollSensitivity,h=e.scrollSpeed,f=an(),g=!1,v;Ka!==n&&(Ka=n,Ho(),fr=e.scroll,v=e.scrollFn,fr===!0&&(fr=Bn(n,!0)));var y=0,S=fr;do{var x=S,I=At(x),R=I.top,k=I.bottom,Z=I.left,F=I.right,H=I.width,Q=I.height,gt=void 0,ht=void 0,bt=x.scrollWidth,$t=x.scrollHeight,ft=W(x),le=x.scrollLeft,Bt=x.scrollTop;x===f?(gt=H<bt&&(ft.overflowX==="auto"||ft.overflowX==="scroll"||ft.overflowX==="visible"),ht=Q<$t&&(ft.overflowY==="auto"||ft.overflowY==="scroll"||ft.overflowY==="visible")):(gt=H<bt&&(ft.overflowX==="auto"||ft.overflowX==="scroll"),ht=Q<$t&&(ft.overflowY==="auto"||ft.overflowY==="scroll"));var ue=gt&&(Math.abs(F-a)<=u&&le+H<bt)-(Math.abs(Z-a)<=u&&!!le),Pt=ht&&(Math.abs(k-l)<=u&&Bt+Q<$t)-(Math.abs(R-l)<=u&&!!Bt);if(!Ut[y])for(var Ht=0;Ht<=y;Ht++)Ut[Ht]||(Ut[Ht]={});(Ut[y].vx!=ue||Ut[y].vy!=Pt||Ut[y].el!==x)&&(Ut[y].el=x,Ut[y].vx=ue,Ut[y].vy=Pt,clearInterval(Ut[y].pid),(ue!=0||Pt!=0)&&(g=!0,Ut[y].pid=setInterval((function(){o&&this.layer===0&&X.active._onTouchMove(Jo);var ce=Ut[this.layer].vy?Ut[this.layer].vy*h:0,Ct=Ut[this.layer].vx?Ut[this.layer].vx*h:0;typeof v=="function"&&v.call(X.dragged.parentNode[ne],Ct,ce,r,Jo,Ut[this.layer].el)!=="continue"||Ph(Ut[this.layer].el,Ct,ce)}).bind({layer:y}),24))),y++}while(e.bubbleScroll&&S!==f&&(S=Bn(S,!1)));Za=g}},30),Fh=function(e){var n=e.originalEvent,o=e.putSortable,a=e.dragEl,l=e.activeSortable,u=e.dispatchSortableEvent,h=e.hideGhostForTarget,f=e.unhideGhostForTarget;if(n){var g=o||l;h();var v=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,y=document.elementFromPoint(v.clientX,v.clientY);f(),g&&!g.el.contains(y)&&(u("spill"),this.onSpill({dragEl:a,putSortable:o}))}};function sl(){}sl.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var a=Ni(this.sortable.el,this.startIndex,this.options);a?this.sortable.el.insertBefore(n,a):this.sortable.el.appendChild(n),this.sortable.animateAll(),o&&o.animateAll()},drop:Fh};en(sl,{pluginName:"revertOnSpill"});function al(){}al.prototype={onSpill:function(e){var n=e.dragEl,o=e.putSortable,a=o||this.sortable;a.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),a.animateAll()},drop:Fh};en(al,{pluginName:"removeOnSpill"});var j=[],Re=[],rr,je,or=!1,Se=!1,Ci=!1,Et,sr,Po;function ew(){function r(e){for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this));e.options.avoidImplicitDeselect||(e.options.supportPointer?st(document,"pointerup",this._deselectMultiDrag):(st(document,"mouseup",this._deselectMultiDrag),st(document,"touchend",this._deselectMultiDrag))),st(document,"keydown",this._checkKeyDown),st(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(a,l){var u="";j.length&&je===e?j.forEach(function(h,f){u+=(f?", ":"")+h.textContent}):u=l.textContent,a.setData("Text",u)}}}return r.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(n){var o=n.dragEl;Et=o},delayEnded:function(){this.isMultiDrag=~j.indexOf(Et)},setupClone:function(n){var o=n.sortable,a=n.cancel;if(this.isMultiDrag){for(var l=0;l<j.length;l++)Re.push(ol(j[l])),Re[l].sortableIndex=j[l].sortableIndex,Re[l].draggable=!1,Re[l].style["will-change"]="",Gt(Re[l],this.options.selectedClass,!1),j[l]===Et&&Gt(Re[l],this.options.chosenClass,!1);o._hideClone(),a()}},clone:function(n){var o=n.sortable,a=n.rootEl,l=n.dispatchSortableEvent,u=n.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||j.length&&je===o&&(sh(!0,a),l("clone"),u()))},showClone:function(n){var o=n.cloneNowShown,a=n.rootEl,l=n.cancel;this.isMultiDrag&&(sh(!1,a),Re.forEach(function(u){W(u,"display","")}),o(),Po=!1,l())},hideClone:function(n){var o=this;n.sortable;var a=n.cloneNowHidden,l=n.cancel;this.isMultiDrag&&(Re.forEach(function(u){W(u,"display","none"),o.options.removeCloneOnHide&&u.parentNode&&u.parentNode.removeChild(u)}),a(),Po=!0,l())},dragStartGlobal:function(n){n.sortable,!this.isMultiDrag&&je&&je.multiDrag._deselectMultiDrag(),j.forEach(function(o){o.sortableIndex=Vt(o)}),j=j.sort(function(o,a){return o.sortableIndex-a.sortableIndex}),Ci=!0},dragStarted:function(n){var o=this,a=n.sortable;if(this.isMultiDrag){if(this.options.sort&&(a.captureAnimationState(),this.options.animation)){j.forEach(function(u){u!==Et&&W(u,"position","absolute")});var l=At(Et,!1,!0,!0);j.forEach(function(u){u!==Et&&eh(u,l)}),Se=!0,or=!0}a.animateAll(function(){Se=!1,or=!1,o.options.animation&&j.forEach(function(u){Ra(u)}),o.options.sort&&Mo()})}},dragOver:function(n){var o=n.target,a=n.completed,l=n.cancel;Se&&~j.indexOf(o)&&(a(!1),l())},revert:function(n){var o=n.fromSortable,a=n.rootEl,l=n.sortable,u=n.dragRect;j.length>1&&(j.forEach(function(h){l.addAnimationState({target:h,rect:Se?At(h):u}),Ra(h),h.fromRect=u,o.removeAnimationState(h)}),Se=!1,nw(!this.options.removeCloneOnHide,a))},dragOverCompleted:function(n){var o=n.sortable,a=n.isOwner,l=n.insertion,u=n.activeSortable,h=n.parentEl,f=n.putSortable,g=this.options;if(l){if(a&&u._hideClone(),or=!1,g.animation&&j.length>1&&(Se||!a&&!u.options.sort&&!f)){var v=At(Et,!1,!0,!0);j.forEach(function(S){S!==Et&&(eh(S,v),h.appendChild(S))}),Se=!0}if(!a)if(Se||Mo(),j.length>1){var y=Po;u._showClone(o),u.options.animation&&!Po&&y&&Re.forEach(function(S){u.addAnimationState({target:S,rect:sr}),S.fromRect=sr,S.thisAnimationDuration=null})}else u._showClone(o)}},dragOverAnimationCapture:function(n){var o=n.dragRect,a=n.isOwner,l=n.activeSortable;if(j.forEach(function(h){h.thisAnimationDuration=null}),l.options.animation&&!a&&l.multiDrag.isMultiDrag){sr=en({},o);var u=ni(Et,!0);sr.top-=u.f,sr.left-=u.e}},dragOverAnimationComplete:function(){Se&&(Se=!1,Mo())},drop:function(n){var o=n.originalEvent,a=n.rootEl,l=n.parentEl,u=n.sortable,h=n.dispatchSortableEvent,f=n.oldIndex,g=n.putSortable,v=g||this.sortable;if(o){var y=this.options,S=l.children;if(!Ci)if(y.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Gt(Et,y.selectedClass,!~j.indexOf(Et)),~j.indexOf(Et))j.splice(j.indexOf(Et),1),rr=null,cr({sortable:u,rootEl:a,name:"deselect",targetEl:Et,originalEvent:o});else{if(j.push(Et),cr({sortable:u,rootEl:a,name:"select",targetEl:Et,originalEvent:o}),o.shiftKey&&rr&&u.el.contains(rr)){var x=Vt(rr),I=Vt(Et);~x&&~I&&x!==I&&function(){var F,H;I>x?(H=x,F=I):(H=I,F=x+1);for(var Q=y.filter;H<F;H++)if(!~j.indexOf(S[H])&&Ce(S[H],y.draggable,l,!1)){var gt=Q&&(typeof Q=="function"?Q.call(u,o,S[H],u):Q.split(",").some(function(ht){return Ce(S[H],ht.trim(),l,!1)}));gt||(Gt(S[H],y.selectedClass,!0),j.push(S[H]),cr({sortable:u,rootEl:a,name:"select",targetEl:S[H],originalEvent:o}))}}()}else rr=Et;je=v}if(Ci&&this.isMultiDrag){if(Se=!1,(l[ne].options.sort||l!==a)&&j.length>1){var R=At(Et),k=Vt(Et,":not(."+this.options.selectedClass+")");if(!or&&y.animation&&(Et.thisAnimationDuration=null),v.captureAnimationState(),!or&&(y.animation&&(Et.fromRect=R,j.forEach(function(F){if(F.thisAnimationDuration=null,F!==Et){var H=Se?At(F):R;F.fromRect=H,v.addAnimationState({target:F,rect:H})}})),Mo(),j.forEach(function(F){S[k]?l.insertBefore(F,S[k]):l.appendChild(F),k++}),f===Vt(Et))){var Z=!1;j.forEach(function(F){if(F.sortableIndex!==Vt(F)){Z=!0;return}}),Z&&(h("update"),h("sort"))}j.forEach(function(F){Ra(F)}),v.animateAll()}je=v}(a===l||g&&g.lastPutMode!=="clone")&&Re.forEach(function(F){F.parentNode&&F.parentNode.removeChild(F)})}},nullingGlobal:function(){this.isMultiDrag=Ci=!1,Re.length=0},destroyGlobal:function(){this._deselectMultiDrag(),rt(document,"pointerup",this._deselectMultiDrag),rt(document,"mouseup",this._deselectMultiDrag),rt(document,"touchend",this._deselectMultiDrag),rt(document,"keydown",this._checkKeyDown),rt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(n){if(!(typeof Ci<"u"&&Ci)&&je===this.sortable&&!(n&&Ce(n.target,this.options.draggable,this.sortable.el,!1))&&!(n&&n.button!==0))for(;j.length;){var o=j[0];Gt(o,this.options.selectedClass,!1),j.shift(),cr({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:o,originalEvent:n})}},_checkKeyDown:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(n){n.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},en(r,{pluginName:"multiDrag",utils:{select:function(n){var o=n.parentNode[ne];!o||!o.options.multiDrag||~j.indexOf(n)||(je&&je!==o&&(je.multiDrag._deselectMultiDrag(),je=o),Gt(n,o.options.selectedClass,!0),j.push(n))},deselect:function(n){var o=n.parentNode[ne],a=j.indexOf(n);!o||!o.options.multiDrag||!~a||(Gt(n,o.options.selectedClass,!1),j.splice(a,1))}},eventProperties:function(){var n=this,o=[],a=[];return j.forEach(function(l){o.push({multiDragElement:l,index:l.sortableIndex});var u;Se&&l!==Et?u=-1:Se?u=Vt(l,":not(."+n.options.selectedClass+")"):u=Vt(l),a.push({multiDragElement:l,index:u})}),{items:D0(j),clones:[].concat(Re),oldIndicies:o,newIndicies:a}},optionListeners:{multiDragKey:function(n){return n=n.toLowerCase(),n==="ctrl"?n="Control":n.length>1&&(n=n.charAt(0).toUpperCase()+n.substr(1)),n}}})}function nw(r,e){j.forEach(function(n,o){var a=e.children[n.sortableIndex+(r?Number(o):0)];a?e.insertBefore(n,a):e.appendChild(n)})}function sh(r,e){Re.forEach(function(n,o){var a=e.children[n.sortableIndex+(r?Number(o):0)];a?e.insertBefore(n,a):e.appendChild(n)})}function Mo(){j.forEach(function(r){r!==Et&&r.parentNode&&r.parentNode.removeChild(r)})}X.mount(new tw);X.mount(al,sl);function iw(r={show:!1,focusable:!1}){return{show:r.show,focusable:r.focusable,closeModal(){this.show=!1},openModal(){this.show=!0},focusables(){return[...this.$el.querySelectorAll("a, button, input:not([type='hidden']), textarea, select, details, [tabindex]:not([tabindex='-1'])")].filter(n=>!n.hasAttribute("disabled"))},firstFocusable(){return this.focusables()[0]},lastFocusable(){return this.focusables().slice(-1)[0]},nextFocusable(){return this.focusables()[this.nextFocusableIndex()]||this.firstFocusable()},prevFocusable(){return this.focusables()[this.prevFocusableIndex()]||this.lastFocusable()},nextFocusableIndex(){return(this.focusables().indexOf(document.activeElement)+1)%(this.focusables().length+1)},prevFocusableIndex(){return Math.max(0,this.focusables().indexOf(document.activeElement))-1},init(){this.$watch("show",e=>{e?(document.body.classList.add("overflow-y-hidden"),this.focusable!==!1&&setTimeout(()=>this.firstFocusable().focus(),100)):document.body.classList.remove("overflow-y-hidden")})}}}function rw(r={}){return{isShared:r.isShared??!1,limits:r.limits??{},init(){},pushToAiEngines(e){this.aiEngines.push(e)}}}class $h{constructor(){this.playbackNode=null}async init(e){this.audioContext=new AudioContext({sampleRate:e}),await this.audioContext.audioWorklet.addModule("/themes/default/assets/js/audio/playback-worklet.js"),this.playbackNode=new AudioWorkletNode(this.audioContext,"playback-worklet"),this.playbackNode.connect(this.audioContext.destination)}play(e){this.playbackNode&&this.playbackNode.port.postMessage(e)}clear(){this.playbackNode&&this.playbackNode.port.postMessage(null)}}function Pi(r,e,n,o){function a(l){return l instanceof n?l:new n(function(u){u(l)})}return new(n||(n=Promise))(function(l,u){function h(v){try{g(o.next(v))}catch(y){u(y)}}function f(v){try{g(o.throw(v))}catch(y){u(y)}}function g(v){v.done?l(v.value):a(v.value).then(h,f)}g((o=o.apply(r,[])).next())})}function ei(r,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},o,a,l,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=h(0),u.throw=h(1),u.return=h(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function h(g){return function(v){return f([g,v])}}function f(g){if(o)throw new TypeError("Generator is already executing.");for(;u&&(u=0,g[0]&&(n=0)),n;)try{if(o=1,a&&(l=g[0]&2?a.return:g[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,g[1])).done)return l;switch(a=0,l&&(g=[g[0]&2,l.value]),g[0]){case 0:case 1:l=g;break;case 4:return n.label++,{value:g[1],done:!1};case 5:n.label++,a=g[1],g=[0];continue;case 7:g=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(g[0]===6||g[0]===2)){n=0;continue}if(g[0]===3&&(!l||g[1]>l[0]&&g[1]<l[3])){n.label=g[1];break}if(g[0]===6&&n.label<l[1]){n.label=l[1],l=g;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(g);break}l[2]&&n.ops.pop(),n.trys.pop();continue}g=e.call(r,n)}catch(v){g=[6,v],a=0}finally{o=l=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function ah(r){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&r[e],o=0;if(n)return n.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&o>=r.length&&(r=void 0),{value:r&&r[o++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function za(r,e){var n=typeof Symbol=="function"&&r[Symbol.iterator];if(!n)return r;var o=n.call(r),a,l=[],u;try{for(;(e===void 0||e-- >0)&&!(a=o.next()).done;)l.push(a.value)}catch(h){u={error:h}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(u)throw u.error}}return l}function Mi(r){return this instanceof Mi?(this.v=r,this):new Mi(r)}function ow(r,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(r,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),h("next"),h("throw"),h("return",u),a[Symbol.asyncIterator]=function(){return this},a;function u(x){return function(I){return Promise.resolve(I).then(x,y)}}function h(x,I){o[x]&&(a[x]=function(R){return new Promise(function(k,Z){l.push([x,R,k,Z])>1||f(x,R)})},I&&(a[x]=I(a[x])))}function f(x,I){try{g(o[x](I))}catch(R){S(l[0][3],R)}}function g(x){x.value instanceof Mi?Promise.resolve(x.value.v).then(v,y):S(l[0][2],x)}function v(x){f("next",x)}function y(x){f("throw",x)}function S(x,I){x(I),l.shift(),l.length&&f(l[0][0],l[0][1])}}function sw(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],n;return e?e.call(r):(r=typeof ah=="function"?ah(r):r[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(l){n[l]=r[l]&&function(u){return new Promise(function(h,f){u=r[l](u),a(h,f,u.done,u.value)})}}function a(l,u,h,f){Promise.resolve(f).then(function(g){l({value:g,done:h})},u)}}var aw=function(r){return typeof r=="object"&&r!==null&&"type"in r},lw=function(r){return aw(r)&&["error","message","conversation.item.input_audio_transcription.delta","session.created","session.updated","input_audio_buffer.committed","input_audio_buffer.cleared","input_audio_buffer.speech_started","input_audio_buffer.speech_stopped","conversation.item.created","conversation.item.truncated","conversation.item.deleted","conversation.item.input_audio_transcription.completed","conversation.item.input_audio_transcription.failed","response.created","response.done","response.output_item.added","response.output_item.done","response.content_part.added","response.content_part.done","response.text.delta","response.text.done","response.audio_transcript.delta","response.audio_transcript.done","response.audio.delta","response.audio.done","response.function_call_arguments.delta","response.function_call_arguments.done","rate_limits.updated"].includes(r.type)},uw=WebSocket,cw=function(r,e){return r.readyState!==WebSocket.OPEN?Promise.reject(new Error("Socket is not open")):(r.send(e),Promise.resolve())},hw=function(r){return{success:!0,message:r}},fw=function(r){return{success:!1,error:r}},dw=function(r){return r.success},gw=function(){function r(e,n){var o=this;this.closedPromise=void 0,this.messageQueue=[],this.receiverQueue=[],this.done=!1,this.validate=n.validate,this.serialize=n.serialize,this.connectedPromise=new Promise(function(a,l){return Pi(o,void 0,void 0,function(){var u,h,f,g,v=this;return ei(this,function(y){switch(y.label){case 0:return e.policy!==void 0?[3,1]:(g=e,[3,3]);case 1:return[4,e.policy(e)];case 2:g=y.sent(),y.label=3;case 3:return u=g,h=u.uri,f=u.protocols,this.socket=new uw(h.toString(),f),this.socket.onopen=function(){v.socket.onmessage=v.getMessageHandler(),v.closedPromise=new Promise(function(S){v.socket.onclose=v.getClosedHandler(S)}),v.socket.onerror=v.handleError,a()},this.socket.onerror=function(S){v.error=S.error,l(S)},[2]}})})})}return r.prototype.handleError=function(e){for(this.error=e.error;this.receiverQueue.length>0;){var n=za(this.receiverQueue.shift(),2);n[0];var o=n[1];o(e.error)}},r.prototype.getClosedHandler=function(e){var n=this;return function(o){for(n.done=!0;n.receiverQueue.length>0;){var a=za(n.receiverQueue.shift(),2),l=a[0],u=a[1];n.error?u(n.error):l({value:void 0,done:!0})}e()}},r.prototype.getMessageHandler=function(){var e=this;return function(n){var o=e.validate(n);if(dw(o)){var a=o.message;if(e.receiverQueue.length>0){var l=za(e.receiverQueue.shift(),2),u=l[0];l[1],u({value:a,done:!1})}else e.messageQueue.push(a)}else e.error=o.error,e.socket.close(1e3,"Unexpected message received")}},r.prototype[Symbol.asyncIterator]=function(){var e=this;return{next:function(){if(e.error)return Promise.reject(e.error);if(e.done)return Promise.resolve({value:void 0,done:!0});if(e.messageQueue.length>0){var n=e.messageQueue.shift();return Promise.resolve({value:n,done:!1})}else return new Promise(function(o,a){e.receiverQueue.push([o,a])})}}},r.prototype.send=function(e){return Pi(this,void 0,void 0,function(){var n;return ei(this,function(o){switch(o.label){case 0:return[4,this.connectedPromise];case 1:if(o.sent(),this.error)throw this.error;return n=this.serialize(e),[2,cw(this.socket,n)]}})})},r.prototype.close=function(){return Pi(this,void 0,void 0,function(){return ei(this,function(e){switch(e.label){case 0:return[4,this.connectedPromise];case 1:return e.sent(),this.done?[2]:(this.socket.close(),[4,this.closedPromise]);case 2:return e.sent(),[2]}})})},r}();function Qa(r){return typeof r=="object"&&r!==null&&"key"in r&&typeof r.key=="string"}function pw(r){return typeof r=="object"&&r!==null&&"getToken"in r&&typeof r.getToken=="function"}var mw=function(r){return Qa(r)||pw(r)},vw=function(r){return typeof r=="object"&&r!==null&&"model"in r&&typeof r.model=="string"},yw=function(r){return typeof r=="object"&&r!==null&&"deployment"in r&&typeof r.deployment=="string"},bw=function(){function r(e,n,o){var a=this,l=function(){if(Qa(e)&&vw(n))return a.openAISettings(e,n);if(mw(n)&&yw(o))return a.azureOpenAISettings(e,n,o);throw new Error("Invalid combination of arguments to initialize the Realtime client")}();this.client=this.getWebsocket(l)}return r.prototype.azureOpenAISettings=function(e,n,o){var a=this,l=["https://cognitiveservices.azure.com/.default"];return this.requestId=crypto.randomUUID(),e.searchParams.set("api-version","2024-10-01-preview"),e.searchParams.set("x-ms-client-request-id",this.requestId),e.searchParams.set("deployment",o.deployment),e.pathname="openai/realtime",{uri:e,policy:function(u){return Pi(a,void 0,void 0,function(){var h;return ei(this,function(f){switch(f.label){case 0:return Qa(n)?(u.uri.searchParams.set("api-key",n.key),[3,3]):[3,1];case 1:return[4,n.getToken(l)];case 2:h=f.sent(),u.uri.searchParams.set("Authorization","Bearer ".concat(h.token)),f.label=3;case 3:return[2,u]}})})}}},r.prototype.openAISettings=function(e,n){var o=new URL("wss://api.openai.com/v1/realtime");return o.searchParams.set("model",n.model),{uri:o,protocols:["realtime","openai-insecure-api-key.".concat(e.key),"openai-beta.realtime-v1"]}},r.prototype.getWebsocket=function(e){var n={validate:function(o){o.data;try{var a=JSON.parse(o.data);if(lw(a))return hw(a)}catch{return fw(new Error("Invalid JSON message"))}},serialize:function(o){return JSON.stringify(o)}};return new gw(e,n)},r.prototype.messages=function(){return ow(this,arguments,function(){var n,o,a,l,u,h,f,g,v;return ei(this,function(y){switch(y.label){case 0:y.trys.push([0,7,8,13]),n=!0,o=sw(this.client),y.label=1;case 1:return[4,Mi(o.next())];case 2:return a=y.sent(),h=a.done,!h?(v=a.value,n=!1,l=v,[4,Mi(l)]):[3,6];case 3:return[4,y.sent()];case 4:y.sent(),y.label=5;case 5:return n=!0,[3,1];case 6:return[3,13];case 7:return u=y.sent(),f={error:u},[3,13];case 8:return y.trys.push([8,,11,12]),!n&&!h&&(g=o.return)?[4,Mi(g.call(o))]:[3,10];case 9:y.sent(),y.label=10;case 10:return[3,12];case 11:if(f)throw f.error;return[7];case 12:return[7];case 13:return[2]}})})},r.prototype.send=function(e){return Pi(this,void 0,void 0,function(){return ei(this,function(n){switch(n.label){case 0:return[4,this.client.send(e)];case 1:return n.sent(),[2]}})})},r.prototype.close=function(){return Pi(this,void 0,void 0,function(){return ei(this,function(e){switch(e.label){case 0:return[4,this.client.close()];case 1:return e.sent(),[2]}})})},r}();q.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(r){this.active=r,this.onActiveChange()},setConversationStarted(r){this.conversationStarted=r,this.onConversationStartedChange()},onActiveChange(){var r,e;document.querySelectorAll(".lqd-realtime-chat-button").forEach(n=>n.classList.toggle("active",this.active)),(e=(r=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:r.classList)==null||e.toggle("active",this.active)},onConversationStartedChange(){const r=document.querySelector(".chats-wrap");r.classList.toggle("conversation-started",this.conversationStarted),r.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>{e.classList.toggle("conversation-started",this.conversationStarted),e.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const ww=(r,e,n)=>({apiKey:"",recordingActive:!1,buffer:new Uint8Array,wsConnection:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var o,a,l;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(o=this.audioVisWrap)==null?void 0:o.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(a=this.audioVisWrap)==null?void 0:a.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(l=this.audioVisWrap)==null?void 0:l.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(this.checkBalanceRealtime(!0).then(o=>{o.shouldStop&&(toastr.error(o.errorMsg),this.stop())}),!q.store("realtimeChatStatus").isActive){q.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting"),this.wsConnection=new bw({key:atob(r)+atob(e)+atob(n)},{model:"gpt-4o-realtime-preview-2024-12-17"});try{await this.wsConnection.send(this.createConfigMessage())}catch(o){this.stop(),console.error("Error sending initial config message:",o),this.appendToChatBubble("ai","[Connection error]: Unable to send initial config message. Please check your endpoint and authentication details.");return}await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.handleRealtimeMessages(),this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle")}).catch(o=>{this.stop(),console.error("Error starting recorder and player:",o),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})}},stop(){!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""&&saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17"),this.resetPlayers(),this.wsConnection&&this.wsConnection.close(),this.switchVisualizers(""),q.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new $h,await this.audioPlayer.init(24e3)}catch(o){console.error("Error starting audio player:",o)}},async startRecorder(){try{this.audioRecorder=new ch(this.processAudioRecordingBuffer);const o=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(o),this.recordingActive=!0}catch(o){console.error("Error starting audio recorder:",o)}},createConfigMessage(){let o={type:"session.update",session:{turn_detection:{type:"server_vad",silence_duration_ms:500},input_audio_transcription:{model:"whisper-1"}}};const a=this.getSystemMessage(),l=this.getTemperature(),u=this.getVoice();return a&&(o.session.instructions=a),isNaN(l)||(o.session.temperature=l),u&&(o.session.voice=u),o},async handleRealtimeMessages(){for await(const o of this.wsConnection.messages())switch(""+o.type,o.type){case"session.created":this.switchVisualizers("idle");break;case"response.content_part.added":this.checkBalanceRealtime(!0).then(a=>{a.shouldStop&&(toastr.error(a.errorMsg),this.stop())}),this.lastAiResponse="",q.store("realtimeChatStatus").setConversationStarted(!0),this.createChatBubble("ai");break;case"response.audio_transcript.delta":this.lastAiResponse+=o.delta,this.appendToChatBubble("ai",o.delta);break;case"response.audio.delta":{this.switchVisualizers("playing");const a=atob(o.delta),l=Uint8Array.from(a,h=>h.charCodeAt(0)),u=new Int16Array(l.buffer);this.audioPlayer.play(u);break}case"input_audio_buffer.speech_started":{this.createChatBubble("user"),this.switchVisualizers("recording"),this.audioPlayer.clear(),this.lastResponseSaved=!1,setTimeout(()=>{this.lastUserQuestion=""},0);break}case"conversation.item.input_audio_transcription.completed":this.lastUserQuestion+=o.transcript,this.appendToChatBubble("user",o.transcript);break;case"response.output_item.done":break;case"conversation.item.truncated":this.appendToChatBubble("ai","...");break;case"conversation.item.deleted":break;case"response.done":"saveResponseAsync"in window&&(saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","gpt-4o-realtime-preview-2024-12-17"),this.lastResponseSaved=!0),"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse));break;default:JSON.stringify(o,null,2);break}this.resetPlayers()},combineArray(o){const a=new Uint8Array(this.buffer.length+o.length);a.set(this.buffer),a.set(o,this.buffer.length),this.buffer=a},processAudioRecordingBuffer(o){const a=new Uint8Array(o);if(this.combineArray(a),this.buffer.length>=4800){const l=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const u=String.fromCharCode(...l),h=btoa(u);this.recordingActive&&this.wsConnection.send({type:"input_audio_buffer.append",audio:h})}},async resetPlayers(){var o,a;this.recordingActive=!1,(o=this.audioRecorder)==null||o.stop(),(a=this.audioPlayer)==null||a.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(o){var a;this.activeVisulaizer=o,(a=this.audioVisWrap)==null||a.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(o){const l=(o==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),u=l.querySelector(".chat-content");this.chatsContainer.appendChild(l),o==="user"?this.lastUserBubble=u:this.lastAiBubble=u,this.scrollConversationAreaToBottom()},appendToChatBubble(o,a){const l=o==="user"?this.lastUserBubble:this.lastAiBubble;l?(l.textContent+=a,this.scrollConversationAreaToBottom()):(this.createChatBubble(o),this.appendToChatBubble(o,a))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var g;if(!((g=this.audioVisBars)!=null&&g.length))return;const o=this.audioPlayer.audioContext.createAnalyser();o.fftSize=4096;const a=o.frequencyBinCount,l=new Uint8Array(a),u=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(o);const h=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(u).fill(0);const f=()=>{o.getByteFrequencyData(l),this.audioVisBars.forEach((v,y)=>{const[S,x]=h[y],I=Math.floor(S/(this.audioPlayer.audioContext.sampleRate/o.fftSize)),R=Math.ceil(x/(this.audioPlayer.audioContext.sampleRate/o.fftSize));let k=0;for(let F=I;F<=R&&F<l.length;F++)l[F]>k&&(k=l[F]);let Z=k/255*80;this.barHeights[y]+=(Z-this.barHeights[y])*.4,this.barHeights[y]+=(Math.random()-.5)*2,this.barHeights[y]=Math.max(5,Math.min(100,this.barHeights[y])),v.animate([{height:v.style.height},{height:`${this.barHeights[y]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(f)};f()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const o=this.audioRecorder.audioContext.createAnalyser();o.fftSize=256;const a=o.frequencyBinCount,l=new Uint8Array(a);this.audioRecorder.getMediaStreamSource().connect(o);const u=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!u)return;const h=()=>{o.getByteFrequencyData(l);let f=0;for(let S=0;S<a;S++)f+=l[S];const v=1+f/a/256*1.5,y=Math.max(.2,1-(v-1)/1.5);u.style.transform=`scale(${v})`,u.style.opacity=y.toFixed(2),requestAnimationFrame(h)};h()},checkBalanceRealtime(o=!1){return new Promise(a=>{$.ajax({url:"/dashboard/user/realtime/chat/checkBalance",type:"POST",data:{onStart:o},dataType:"json",success:l=>{const u=l.status!=="success",h=l.message||"";a({shouldStop:u,errorMsg:h})},error:()=>{a({shouldStop:!0,errorMsg:"An error occurred."})}})})}}),lh=(r={})=>({prevViews:[],task:!1,currentView:"home",sidebarCollapsed:!1,toolbarCollapsed:!1,modalShow:!1,activeModal:null,activeModalId:null,activeModalIdPrefix:null,currentToolsCat:"primary",tools:r.tools||[],primaryToolKeys:r.primaryToolKeys||[],showImageDetails:!1,zoomLevel:1,reachedMinZoom:!1,reachedMaxZoom:!1,newItems:[],showNotif:!1,editingImageDimensions:{width:0,height:0},painting:!1,brushSize:40,canvasCtx:null,lastUploadingImages:[],uploadingImages:[],promptLibraryShow:!1,promptFilter:"all",searchPromptStr:"",supportMultipleImageTools:["reimagine"],_busy:!1,_template:"",_prompt:"",_selectedTemplateDescription:"",_selectedPromptDescription:"",_selectedTool:"",aiModel:"",_prevEditingImage:{},_editingImage:{},get busy(){return this._busy},set busy(e){this._busy=e},get selectedTemplate(){return this._template.trim()},set selectedTemplate(e){var n;this._template=e,(n=this.$refs.promptInput)==null||n.focus()},get prompt(){return this._prompt},set prompt(e){var n;this._prompt=e.trim(),(n=this.$refs.promptInput)==null||n.focus()},get selectedTemplateDescription(){return this._selectedTemplateDescription},set selectedTemplateDescription(e){this._selectedTemplateDescription!==e&&(this._selectedTemplateDescription=e)},get selectedPromptDescription(){return this._selectedPromptDescription},set selectedPromptDescription(e){this._selectedPromptDescription!==e&&(this._selectedPromptDescription=e)},get selectedTool(){return this._selectedTool},set selectedTool(e){this.aiModel=AIModelsforTool[e],this._selectedTool!==e&&(this._selectedTool=e,this.makeCanvasEditable(this._selectedTool==="sketch_to_image"?{width:1024,height:1024}:{}),!this.selectedToolSupportMultiImagesUpload()&&this.$refs.editorFileInput.files.length&&this.clearImageInputs())},get prevEditingImage(){return this._prevEditingImage},get editingImage(){return this._editingImage},set editingImage(e){this._prevEditingImage=this._editingImage,this._editingImage=e,this.showImageDetails=!1,this.zoomLevel=1,e!=null&&e.output&&fetch(e.output).then(n=>n.blob()).then(n=>{var l,u;const o=new File([n],((u=(l=e.title)==null?void 0:l.split("."))==null?void 0:u.at(0))||"image",{type:n.type}),a=new DataTransfer;a.items.add(o),this.$refs.uploadedImageInput.files=a.files}).catch(n=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",n)})},init(){this.onViewChange=this.onViewChange.bind(this),this.onZoomLevelChange=this.onZoomLevelChange.bind(this),this.onCreativeSuiteStageInitiated=this.onCreativeSuiteStageInitiated.bind(this),this.makeCanvasEditable=this.makeCanvasEditable.bind(this),this.startPainting=this.startPainting.bind(this),this.stopPainting=this.stopPainting.bind(this),this.paint=this.paint.bind(this),document.documentElement.style.scrollbarGutter="stable",this.$watch("currentView",this.onViewChange),this.$watch("zoomLevel",this.onZoomLevelChange),this.creativeSuite&&this.$watch("creativeSuite.stageInitiated",this.onCreativeSuiteStageInitiated);const e=new URLSearchParams(window.location.search);if(e.has("action")){const n=e.get("action");["merge_face","uncrop","reimagine","remove_background","cleanup","upscale","replace_background","sketch_to_image","remove_text","inpainting","style_transfer","image_relight"].includes(n)&&(this.currentView="editor",this.switchToolsCat({toolKey:n}),this.selectedTool=n)}},switchView(e){var n;if(!((n=this.creativeSuite)!=null&&n.editingTextNode)){if(e==="<"){this.currentView=this.prevViews.pop()||"home";return}this.prevViews.push(this.currentView),this.currentView=e||"home"}},switchSidebarCollapsed(e){if(e!=null){this.sidebarCollapsed=e;return}this.sidebarCollapsed=!this.sidebarCollapsed,this.$nextTick(()=>{this.zoomLevel>1&&this.fitToScreen()}),this.$refs.imageEditorSidebar.addEventListener("transitionend",n=>{n.target!==this.$refs.imageEditorSidebar&&n.propertyName!=="transform"||this.reachedMaxZoom&&this.fitToScreen()})},onViewChange(e){const n=e==="editor";document.documentElement.style.overflow=n?"hidden":""},setActiveModal(e,n="modal"){this.activeModal=e,this.activeModalId=e.id,this.activeModalIdPrefix=n},prevImageModal(){const e=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),n=e==null?void 0:e.previousElementSibling;if(!n)return;const o=JSON.parse(n.getAttribute("data-payload")||{});this.setActiveModal(o,e.getAttribute("data-id-prefix"))},nextImageModal(){const e=document.querySelector(`.image-result[data-id='${this.activeModalId}'][data-id-prefix=${this.activeModalIdPrefix}]`),n=e==null?void 0:e.nextElementSibling;if(!n)return;const o=JSON.parse(n.getAttribute("data-payload")||{});this.setActiveModal(o,e.getAttribute("data-id-prefix"))},getSelectedToolCat(){return this.getToolCat(this.selectedTool)},switchToolsCat(e={}){if(e.cat)return this.currentToolsCat=e.cat;if(e.toolKey)return this.currentToolsCat=this.getToolCat(e.toolKey);if(!e.cat&&!e.toolKey)return this.currentToolsCat=this.currentToolsCat==="primary"?"secondary":"primary"},getToolCat(e){return this.primaryToolKeys.findIndex(n=>n===e)>=0?"primary":"secondary"},selectedToolSupportMultiImagesUpload(){return this.supportMultipleImageTools.includes(this.selectedTool)&&this.aiModel==="openai"},handleDragOver(){this.$refs.dropArea.classList.add("drag-over")},handleDragLeave(){this.$refs.dropArea.classList.remove("drag-over")},handleUploadingMultiImages(e){if(!this.selectedToolSupportMultiImagesUpload())return;const n=Array.from(e),o=Array.from(this.lastUploadingImages),a=new DataTransfer;return o.forEach(l=>{a.items.add(l)}),n.forEach(l=>{if(!l.type.startsWith("image/")){toastr.error("Please upload a valid image file."),this.clearImageInputs();return}o.findIndex(u=>u.name===l.name&&u.size===l.size)===-1&&a.items.add(l)}),this.$refs.editorFileInput.files=a.files,this.$refs.uploadedImageInput.files=a.files,this.lastUploadingImages=a.files,this.uploadingImages=Array.from(a.files).map(l=>({src:URL.createObjectURL(l),name:l.name})),a.files},handleFileChange(e){var o;let n=e.dataTransfer?e.dataTransfer.files:(o=e.target)==null?void 0:o.files;if(this.$refs.dropArea.classList.remove("drag-over"),!!n){if(e.dataTransfer&&(this.$refs.editorFileInput.files=n),n&&!n.length){this.handleUploadingMultiImages(this.lastUploadingImages);return}this.selectedToolSupportMultiImagesUpload()&&(n=this.handleUploadingMultiImages(n)),this.handleFiles(n)}},handleFiles(e){if(!e[0])return;this.selectedToolSupportMultiImagesUpload()||(this.editingImage={output:URL.createObjectURL(e[0]),name:e[0].name});const n=new FormData;n.append("image",e[0]),n.append("reimagine",e[0]),["reimagine"].includes(this.selectedTool)&&(this.$refs.promptInput&&(this.$refs.promptInput.disabled=!0,this.$refs.promptInput.placeholder="Analyzing image... Please wait..."),fetch("/dashboard/user/image-to-prompt",{method:"POST",headers:{"X-CSRF-TOKEN":"{{ csrf_token() }}"},body:n}).then(o=>o.json()).then(o=>{o.status==="success"?this.prompt=o.prompt:toastr.error(o.prompt)}).catch(o=>{console.log("Error:",o)}).finally(()=>{this.$refs.promptInput&&(this.$refs.promptInput.disabled=!1,this.$refs.promptInput.placeholder="Describe your idea or select a pre-defined prompt")}))},resetUploadedImageInput(){this.zoomLevel=1,this.clearImageInputs(),this.selectedTool==="sketch_to_image"&&this.makeCanvasEditable({width:1024,height:1024})},clearImageInputs(){this.lastUploadingImages=[],this.uploadingImages=[],this.editingImage={},this.$refs.editorFileInput.value="",this.$refs.uploadedImageInput.value=""},downloadImage(e,n){const o=document.createElement("a");o.href=e,o.download=n?n.replaceAll(" ","-"):"image",o.click(),o.remove()},getMaxZoom(){const e=this.$refs.editorCanvas,n=e.offsetWidth,o=window.getComputedStyle(e);return 1+(parseFloat(o.marginLeft)+parseFloat(o.marginRight)-20)/n},setZoomLevel(e){const n=this.getMaxZoom();this.zoomLevel=Math.max(.1,Math.min(n,e)),this.reachedMinZoom=this.zoomLevel===.1,this.reachedMaxZoom=this.zoomLevel>=n},zoomIn(){this.setZoomLevel(this.zoomLevel+.1)},zoomOut(){this.setZoomLevel(this.zoomLevel-.1)},fitToScreen(){const e=this.getMaxZoom();this.setZoomLevel(e)},onZoomLevelChange(){const e=this.$refs.editorCanvas;e.style.setProperty("--zoom-level",this.zoomLevel.toFixed(3)),e.style.setProperty("--zoom-offset","0px");const n=window.getComputedStyle(e),o=parseFloat(n.getPropertyValue("--header-h")),l=e.getBoundingClientRect().top+this.$refs.editorCanvasWrap.scrollTop;l<o&&e.style.setProperty("--zoom-offset",`${(l>=0?o-l:o+Math.abs(l)).toFixed(0)}px`)},submitEditorForm(e){this.busy=!0;const n=new FormData(e.target);fetch(e.target.action,{method:"POST",body:n,headers:{Accept:"application/json"}}).then(o=>o.ok?o.json():o.json().then(a=>{throw new Error(a.message||"An unknown error occurred")})).then(o=>{var a,l;if(o.type==="error"){toastr.error(o.message);return}if(((a=o==null?void 0:o.data)==null?void 0:a.status)==="CREATED"||((l=o==null?void 0:o.data)==null?void 0:l.status)==="IN_PROGRESS")this.task=!0,this.getStatus(o.data);else{this.editingImage=o.data,this.newItems.push(o.data),this.showNotif=!0,this.uploadingImages=[],this.selectedTool==="sketch_to_image"&&(this.switchToolsCat({toolKey:this.primaryToolKeys[0]}),this.selectedTool=this.primaryToolKeys[0]);const u=setTimeout(()=>{this.showNotif=!1,clearTimeout(u)},3e3)}}).catch(o=>{console.log(o),toastr.error(o)}).finally(()=>{this.task||(this.busy=!1)})},async getStatus(e={}){this.busy=!0,fetch("/dashboard/user/advanced-image/editor/"+e.id+"/status",{method:"GET",headers:{Accept:"application/json"}}).then(n=>n.ok?n.json():n.json().then(o=>{throw new Error(o.message||"An unknown error occurred")})).then(n=>{if(n.status==="error")throw new Error(n.message);if(n.data.status==="COMPLETED"){this.task=!1,this.editingImage=n.data,this.newItems.push(n.data),this.showNotif=!0;const o=setTimeout(()=>{this.showNotif=!1,clearTimeout(o)},3e3);this.busy=!1}else setTimeout(()=>{this.getStatus(n.data)},1e3)}).catch(n=>{toastr.error(n)})},async makeCanvasEditable(e={}){var o;this.editingImageDimensions={width:e.width||this.$refs.editorImagePreview.naturalWidth,height:e.height||this.$refs.editorImagePreview.naturalHeight},await this.$nextTick();const n=this.$refs.editorMaskCanvas;(o=this.canvasCtx)==null||o.reset(),this.canvasCtx=n.getContext("2d"),this.canvasCtx.fillStyle="black",this.canvasCtx.fillRect(0,0,n.width,n.height)},startPainting(e){this.painting=!0,this.painted=!1,this.paint(e)},stopPainting(){if(!this.painted)return;this.painting=!1,this.canvasCtx.beginPath();const e=this.$refs.editorMaskCanvas,n=document.createElement("canvas");n.width=this.editingImageDimensions.width,n.height=this.editingImageDimensions.height,n.getContext("2d").drawImage(e,0,0,n.width,n.height),n.toBlob(a=>{const l=new File([a],"mask.png",{type:"image/png"}),u=new DataTransfer;u.items.add(l),this.$refs[this.selectedTool==="sketch_to_image"?"sketchFileInput":"maskFileInput"].files=u.files,n.remove()},"image/png"),this.painted=!1},paint(e){if(!this.painting)return;const n=this.$refs.editorMaskCanvas,o=n.getBoundingClientRect(),a=(e.clientX-o.left)*(n.width/o.width),l=(e.clientY-o.top)*(n.height/o.height);this.canvasCtx.lineWidth=this.brushSize,this.canvasCtx.opacityTo=7,this.canvasCtx.lineCap="round",this.canvasCtx.strokeStyle="yellow",this.canvasCtx.lineTo(a,l),this.canvasCtx.stroke(),this.canvasCtx.beginPath(),this.canvasCtx.moveTo(a,l),this.painted=!0},setBrushSize(e){e==="-"?e=Math.max(this.brushSize-10,10):e==="+"&&(e=Math.min(this.brushSize+10,100)),this.brushSize=parseInt(e,10)},togglePromptLibraryShow(){this.promptLibraryShow=!this.promptLibraryShow},changePromptFilter(e){e!==this.promptFilter&&(this.promptFilter=e)},setSearchPromptStr(e){this.searchPromptStr=e.trim().toLowerCase()},setPrompt(e){this.prompt=e},focusOnPrompt(){this.$nextTick(()=>this.$refs.promptInput.focus())},onCreativeSuiteStageInitiated(e){e&&_.defer(()=>{this.toolbarCollapsed=!0})}});var Ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gw(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var gr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var _w=gr.exports,uh;function Sw(){return uh||(uh=1,function(r,e){(function(){var n,o="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",h="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",g=500,v="__lodash_placeholder__",y=1,S=2,x=4,I=1,R=2,k=1,Z=2,F=4,H=8,Q=16,gt=32,ht=64,bt=128,$t=256,ft=512,le=30,Bt="...",ue=800,Pt=16,Ht=1,ce=2,Ct=3,Mt=1/0,Zt=9007199254740991,Oi=17976931348623157e292,ii=NaN,ie=4294967295,Li=ie-1,Vh=ie>>>1,Xh=[["ary",bt],["bind",k],["bindKey",Z],["curry",H],["curryRight",Q],["flip",ft],["partial",gt],["partialRight",ht],["rearg",$t]],ri="[object Arguments]",Dr="[object Array]",Yh="[object AsyncFunction]",ki="[object Boolean]",Fi="[object Date]",Kh="[object DOMException]",Pr="[object Error]",Mr="[object Function]",ll="[object GeneratorFunction]",Ge="[object Map]",$i="[object Number]",Zh="[object Null]",cn="[object Object]",ul="[object Promise]",Qh="[object Proxy]",Bi="[object RegExp]",Ve="[object Set]",Wi="[object String]",Rr="[object Symbol]",Jh="[object Undefined]",zi="[object WeakMap]",jh="[object WeakSet]",Hi="[object ArrayBuffer]",oi="[object DataView]",es="[object Float32Array]",ns="[object Float64Array]",is="[object Int8Array]",rs="[object Int16Array]",os="[object Int32Array]",ss="[object Uint8Array]",as="[object Uint8ClampedArray]",ls="[object Uint16Array]",us="[object Uint32Array]",tf=/\b__p \+= '';/g,ef=/\b(__p \+=) '' \+/g,nf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,cl=/&(?:amp|lt|gt|quot|#39);/g,hl=/[&<>"']/g,rf=RegExp(cl.source),of=RegExp(hl.source),sf=/<%-([\s\S]+?)%>/g,af=/<%([\s\S]+?)%>/g,fl=/<%=([\s\S]+?)%>/g,lf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,uf=/^\w*$/,cf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,cs=/[\\^$.*+?()[\]{}|]/g,hf=RegExp(cs.source),hs=/^\s+/,ff=/\s/,df=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,gf=/\{\n\/\* \[wrapped with (.+)\] \*/,pf=/,? & /,mf=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,vf=/[()=,{}\[\]\/\s]/,yf=/\\(\\)?/g,bf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dl=/\w*$/,wf=/^[-+]0x[0-9a-f]+$/i,_f=/^0b[01]+$/i,Sf=/^\[object .+?Constructor\]$/,Ef=/^0o[0-7]+$/i,Cf=/^(?:0|[1-9]\d*)$/,xf=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Nr=/($^)/,Af=/['\n\r\u2028\u2029\\]/g,Or="\\ud800-\\udfff",Tf="\\u0300-\\u036f",If="\\ufe20-\\ufe2f",Df="\\u20d0-\\u20ff",gl=Tf+If+Df,pl="\\u2700-\\u27bf",ml="a-z\\xdf-\\xf6\\xf8-\\xff",Pf="\\xac\\xb1\\xd7\\xf7",Mf="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Rf="\\u2000-\\u206f",Nf=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vl="A-Z\\xc0-\\xd6\\xd8-\\xde",yl="\\ufe0e\\ufe0f",bl=Pf+Mf+Rf+Nf,fs="['’]",Of="["+Or+"]",wl="["+bl+"]",Lr="["+gl+"]",_l="\\d+",Lf="["+pl+"]",Sl="["+ml+"]",El="[^"+Or+bl+_l+pl+ml+vl+"]",ds="\\ud83c[\\udffb-\\udfff]",kf="(?:"+Lr+"|"+ds+")",Cl="[^"+Or+"]",gs="(?:\\ud83c[\\udde6-\\uddff]){2}",ps="[\\ud800-\\udbff][\\udc00-\\udfff]",si="["+vl+"]",xl="\\u200d",Al="(?:"+Sl+"|"+El+")",Ff="(?:"+si+"|"+El+")",Tl="(?:"+fs+"(?:d|ll|m|re|s|t|ve))?",Il="(?:"+fs+"(?:D|LL|M|RE|S|T|VE))?",Dl=kf+"?",Pl="["+yl+"]?",$f="(?:"+xl+"(?:"+[Cl,gs,ps].join("|")+")"+Pl+Dl+")*",Bf="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Wf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ml=Pl+Dl+$f,zf="(?:"+[Lf,gs,ps].join("|")+")"+Ml,Hf="(?:"+[Cl+Lr+"?",Lr,gs,ps,Of].join("|")+")",qf=RegExp(fs,"g"),Uf=RegExp(Lr,"g"),ms=RegExp(ds+"(?="+ds+")|"+Hf+Ml,"g"),Gf=RegExp([si+"?"+Sl+"+"+Tl+"(?="+[wl,si,"$"].join("|")+")",Ff+"+"+Il+"(?="+[wl,si+Al,"$"].join("|")+")",si+"?"+Al+"+"+Tl,si+"+"+Il,Wf,Bf,_l,zf].join("|"),"g"),Vf=RegExp("["+xl+Or+gl+yl+"]"),Xf=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Yf=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Kf=-1,xt={};xt[es]=xt[ns]=xt[is]=xt[rs]=xt[os]=xt[ss]=xt[as]=xt[ls]=xt[us]=!0,xt[ri]=xt[Dr]=xt[Hi]=xt[ki]=xt[oi]=xt[Fi]=xt[Pr]=xt[Mr]=xt[Ge]=xt[$i]=xt[cn]=xt[Bi]=xt[Ve]=xt[Wi]=xt[zi]=!1;var St={};St[ri]=St[Dr]=St[Hi]=St[oi]=St[ki]=St[Fi]=St[es]=St[ns]=St[is]=St[rs]=St[os]=St[Ge]=St[$i]=St[cn]=St[Bi]=St[Ve]=St[Wi]=St[Rr]=St[ss]=St[as]=St[ls]=St[us]=!0,St[Pr]=St[Mr]=St[zi]=!1;var Zf={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Qf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jf={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},jf={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},td=parseFloat,ed=parseInt,Rl=typeof Ro=="object"&&Ro&&Ro.Object===Object&&Ro,nd=typeof self=="object"&&self&&self.Object===Object&&self,Jt=Rl||nd||Function("return this")(),vs=e&&!e.nodeType&&e,Wn=vs&&!0&&r&&!r.nodeType&&r,Nl=Wn&&Wn.exports===vs,ys=Nl&&Rl.process,ke=function(){try{var E=Wn&&Wn.require&&Wn.require("util").types;return E||ys&&ys.binding&&ys.binding("util")}catch{}}(),Ol=ke&&ke.isArrayBuffer,Ll=ke&&ke.isDate,kl=ke&&ke.isMap,Fl=ke&&ke.isRegExp,$l=ke&&ke.isSet,Bl=ke&&ke.isTypedArray;function xe(E,T,A){switch(A.length){case 0:return E.call(T);case 1:return E.call(T,A[0]);case 2:return E.call(T,A[0],A[1]);case 3:return E.call(T,A[0],A[1],A[2])}return E.apply(T,A)}function id(E,T,A,B){for(var J=-1,pt=E==null?0:E.length;++J<pt;){var Yt=E[J];T(B,Yt,A(Yt),E)}return B}function Fe(E,T){for(var A=-1,B=E==null?0:E.length;++A<B&&T(E[A],A,E)!==!1;);return E}function rd(E,T){for(var A=E==null?0:E.length;A--&&T(E[A],A,E)!==!1;);return E}function Wl(E,T){for(var A=-1,B=E==null?0:E.length;++A<B;)if(!T(E[A],A,E))return!1;return!0}function xn(E,T){for(var A=-1,B=E==null?0:E.length,J=0,pt=[];++A<B;){var Yt=E[A];T(Yt,A,E)&&(pt[J++]=Yt)}return pt}function kr(E,T){var A=E==null?0:E.length;return!!A&&ai(E,T,0)>-1}function bs(E,T,A){for(var B=-1,J=E==null?0:E.length;++B<J;)if(A(T,E[B]))return!0;return!1}function Tt(E,T){for(var A=-1,B=E==null?0:E.length,J=Array(B);++A<B;)J[A]=T(E[A],A,E);return J}function An(E,T){for(var A=-1,B=T.length,J=E.length;++A<B;)E[J+A]=T[A];return E}function ws(E,T,A,B){var J=-1,pt=E==null?0:E.length;for(B&&pt&&(A=E[++J]);++J<pt;)A=T(A,E[J],J,E);return A}function od(E,T,A,B){var J=E==null?0:E.length;for(B&&J&&(A=E[--J]);J--;)A=T(A,E[J],J,E);return A}function _s(E,T){for(var A=-1,B=E==null?0:E.length;++A<B;)if(T(E[A],A,E))return!0;return!1}var sd=Ss("length");function ad(E){return E.split("")}function ld(E){return E.match(mf)||[]}function zl(E,T,A){var B;return A(E,function(J,pt,Yt){if(T(J,pt,Yt))return B=pt,!1}),B}function Fr(E,T,A,B){for(var J=E.length,pt=A+(B?1:-1);B?pt--:++pt<J;)if(T(E[pt],pt,E))return pt;return-1}function ai(E,T,A){return T===T?wd(E,T,A):Fr(E,Hl,A)}function ud(E,T,A,B){for(var J=A-1,pt=E.length;++J<pt;)if(B(E[J],T))return J;return-1}function Hl(E){return E!==E}function ql(E,T){var A=E==null?0:E.length;return A?Cs(E,T)/A:ii}function Ss(E){return function(T){return T==null?n:T[E]}}function Es(E){return function(T){return E==null?n:E[T]}}function Ul(E,T,A,B,J){return J(E,function(pt,Yt,_t){A=B?(B=!1,pt):T(A,pt,Yt,_t)}),A}function cd(E,T){var A=E.length;for(E.sort(T);A--;)E[A]=E[A].value;return E}function Cs(E,T){for(var A,B=-1,J=E.length;++B<J;){var pt=T(E[B]);pt!==n&&(A=A===n?pt:A+pt)}return A}function xs(E,T){for(var A=-1,B=Array(E);++A<E;)B[A]=T(A);return B}function hd(E,T){return Tt(T,function(A){return[A,E[A]]})}function Gl(E){return E&&E.slice(0,Kl(E)+1).replace(hs,"")}function Ae(E){return function(T){return E(T)}}function As(E,T){return Tt(T,function(A){return E[A]})}function qi(E,T){return E.has(T)}function Vl(E,T){for(var A=-1,B=E.length;++A<B&&ai(T,E[A],0)>-1;);return A}function Xl(E,T){for(var A=E.length;A--&&ai(T,E[A],0)>-1;);return A}function fd(E,T){for(var A=E.length,B=0;A--;)E[A]===T&&++B;return B}var dd=Es(Zf),gd=Es(Qf);function pd(E){return"\\"+jf[E]}function md(E,T){return E==null?n:E[T]}function li(E){return Vf.test(E)}function vd(E){return Xf.test(E)}function yd(E){for(var T,A=[];!(T=E.next()).done;)A.push(T.value);return A}function Ts(E){var T=-1,A=Array(E.size);return E.forEach(function(B,J){A[++T]=[J,B]}),A}function Yl(E,T){return function(A){return E(T(A))}}function Tn(E,T){for(var A=-1,B=E.length,J=0,pt=[];++A<B;){var Yt=E[A];(Yt===T||Yt===v)&&(E[A]=v,pt[J++]=A)}return pt}function $r(E){var T=-1,A=Array(E.size);return E.forEach(function(B){A[++T]=B}),A}function bd(E){var T=-1,A=Array(E.size);return E.forEach(function(B){A[++T]=[B,B]}),A}function wd(E,T,A){for(var B=A-1,J=E.length;++B<J;)if(E[B]===T)return B;return-1}function _d(E,T,A){for(var B=A+1;B--;)if(E[B]===T)return B;return B}function ui(E){return li(E)?Ed(E):sd(E)}function Xe(E){return li(E)?Cd(E):ad(E)}function Kl(E){for(var T=E.length;T--&&ff.test(E.charAt(T)););return T}var Sd=Es(Jf);function Ed(E){for(var T=ms.lastIndex=0;ms.test(E);)++T;return T}function Cd(E){return E.match(ms)||[]}function xd(E){return E.match(Gf)||[]}var Ad=function E(T){T=T==null?Jt:ci.defaults(Jt.Object(),T,ci.pick(Jt,Yf));var A=T.Array,B=T.Date,J=T.Error,pt=T.Function,Yt=T.Math,_t=T.Object,Is=T.RegExp,Td=T.String,$e=T.TypeError,Br=A.prototype,Id=pt.prototype,hi=_t.prototype,Wr=T["__core-js_shared__"],zr=Id.toString,wt=hi.hasOwnProperty,Dd=0,Zl=function(){var t=/[^.]+$/.exec(Wr&&Wr.keys&&Wr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Hr=hi.toString,Pd=zr.call(_t),Md=Jt._,Rd=Is("^"+zr.call(wt).replace(cs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),qr=Nl?T.Buffer:n,In=T.Symbol,Ur=T.Uint8Array,Ql=qr?qr.allocUnsafe:n,Gr=Yl(_t.getPrototypeOf,_t),Jl=_t.create,jl=hi.propertyIsEnumerable,Vr=Br.splice,tu=In?In.isConcatSpreadable:n,Ui=In?In.iterator:n,zn=In?In.toStringTag:n,Xr=function(){try{var t=Vn(_t,"defineProperty");return t({},"",{}),t}catch{}}(),Nd=T.clearTimeout!==Jt.clearTimeout&&T.clearTimeout,Od=B&&B.now!==Jt.Date.now&&B.now,Ld=T.setTimeout!==Jt.setTimeout&&T.setTimeout,Yr=Yt.ceil,Kr=Yt.floor,Ds=_t.getOwnPropertySymbols,kd=qr?qr.isBuffer:n,eu=T.isFinite,Fd=Br.join,$d=Yl(_t.keys,_t),Kt=Yt.max,re=Yt.min,Bd=B.now,Wd=T.parseInt,nu=Yt.random,zd=Br.reverse,Ps=Vn(T,"DataView"),Gi=Vn(T,"Map"),Ms=Vn(T,"Promise"),fi=Vn(T,"Set"),Vi=Vn(T,"WeakMap"),Xi=Vn(_t,"create"),Zr=Vi&&new Vi,di={},Hd=Xn(Ps),qd=Xn(Gi),Ud=Xn(Ms),Gd=Xn(fi),Vd=Xn(Vi),Qr=In?In.prototype:n,Yi=Qr?Qr.valueOf:n,iu=Qr?Qr.toString:n;function p(t){if(Lt(t)&&!nt(t)&&!(t instanceof ut)){if(t instanceof Be)return t;if(wt.call(t,"__wrapped__"))return rc(t)}return new Be(t)}var gi=function(){function t(){}return function(i){if(!Rt(i))return{};if(Jl)return Jl(i);t.prototype=i;var s=new t;return t.prototype=n,s}}();function Jr(){}function Be(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=n}p.templateSettings={escape:sf,evaluate:af,interpolate:fl,variable:"",imports:{_:p}},p.prototype=Jr.prototype,p.prototype.constructor=p,Be.prototype=gi(Jr.prototype),Be.prototype.constructor=Be;function ut(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function Xd(){var t=new ut(this.__wrapped__);return t.__actions__=me(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=me(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=me(this.__views__),t}function Yd(){if(this.__filtered__){var t=new ut(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Kd(){var t=this.__wrapped__.value(),i=this.__dir__,s=nt(t),c=i<0,d=s?t.length:0,m=ap(0,d,this.__views__),b=m.start,w=m.end,C=w-b,D=c?w:b-1,P=this.__iteratees__,M=P.length,L=0,z=re(C,this.__takeCount__);if(!s||!c&&d==C&&z==C)return Tu(t,this.__actions__);var G=[];t:for(;C--&&L<z;){D+=i;for(var ot=-1,V=t[D];++ot<M;){var lt=P[ot],ct=lt.iteratee,De=lt.type,de=ct(V);if(De==ce)V=de;else if(!de){if(De==Ht)continue t;break t}}G[L++]=V}return G}ut.prototype=gi(Jr.prototype),ut.prototype.constructor=ut;function Hn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function Zd(){this.__data__=Xi?Xi(null):{},this.size=0}function Qd(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i}function Jd(t){var i=this.__data__;if(Xi){var s=i[t];return s===f?n:s}return wt.call(i,t)?i[t]:n}function jd(t){var i=this.__data__;return Xi?i[t]!==n:wt.call(i,t)}function tg(t,i){var s=this.__data__;return this.size+=this.has(t)?0:1,s[t]=Xi&&i===n?f:i,this}Hn.prototype.clear=Zd,Hn.prototype.delete=Qd,Hn.prototype.get=Jd,Hn.prototype.has=jd,Hn.prototype.set=tg;function hn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function eg(){this.__data__=[],this.size=0}function ng(t){var i=this.__data__,s=jr(i,t);if(s<0)return!1;var c=i.length-1;return s==c?i.pop():Vr.call(i,s,1),--this.size,!0}function ig(t){var i=this.__data__,s=jr(i,t);return s<0?n:i[s][1]}function rg(t){return jr(this.__data__,t)>-1}function og(t,i){var s=this.__data__,c=jr(s,t);return c<0?(++this.size,s.push([t,i])):s[c][1]=i,this}hn.prototype.clear=eg,hn.prototype.delete=ng,hn.prototype.get=ig,hn.prototype.has=rg,hn.prototype.set=og;function fn(t){var i=-1,s=t==null?0:t.length;for(this.clear();++i<s;){var c=t[i];this.set(c[0],c[1])}}function sg(){this.size=0,this.__data__={hash:new Hn,map:new(Gi||hn),string:new Hn}}function ag(t){var i=ho(this,t).delete(t);return this.size-=i?1:0,i}function lg(t){return ho(this,t).get(t)}function ug(t){return ho(this,t).has(t)}function cg(t,i){var s=ho(this,t),c=s.size;return s.set(t,i),this.size+=s.size==c?0:1,this}fn.prototype.clear=sg,fn.prototype.delete=ag,fn.prototype.get=lg,fn.prototype.has=ug,fn.prototype.set=cg;function qn(t){var i=-1,s=t==null?0:t.length;for(this.__data__=new fn;++i<s;)this.add(t[i])}function hg(t){return this.__data__.set(t,f),this}function fg(t){return this.__data__.has(t)}qn.prototype.add=qn.prototype.push=hg,qn.prototype.has=fg;function Ye(t){var i=this.__data__=new hn(t);this.size=i.size}function dg(){this.__data__=new hn,this.size=0}function gg(t){var i=this.__data__,s=i.delete(t);return this.size=i.size,s}function pg(t){return this.__data__.get(t)}function mg(t){return this.__data__.has(t)}function vg(t,i){var s=this.__data__;if(s instanceof hn){var c=s.__data__;if(!Gi||c.length<a-1)return c.push([t,i]),this.size=++s.size,this;s=this.__data__=new fn(c)}return s.set(t,i),this.size=s.size,this}Ye.prototype.clear=dg,Ye.prototype.delete=gg,Ye.prototype.get=pg,Ye.prototype.has=mg,Ye.prototype.set=vg;function ru(t,i){var s=nt(t),c=!s&&Yn(t),d=!s&&!c&&Nn(t),m=!s&&!c&&!d&&yi(t),b=s||c||d||m,w=b?xs(t.length,Td):[],C=w.length;for(var D in t)(i||wt.call(t,D))&&!(b&&(D=="length"||d&&(D=="offset"||D=="parent")||m&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||mn(D,C)))&&w.push(D);return w}function ou(t){var i=t.length;return i?t[Hs(0,i-1)]:n}function yg(t,i){return fo(me(t),Un(i,0,t.length))}function bg(t){return fo(me(t))}function Rs(t,i,s){(s!==n&&!Ke(t[i],s)||s===n&&!(i in t))&&dn(t,i,s)}function Ki(t,i,s){var c=t[i];(!(wt.call(t,i)&&Ke(c,s))||s===n&&!(i in t))&&dn(t,i,s)}function jr(t,i){for(var s=t.length;s--;)if(Ke(t[s][0],i))return s;return-1}function wg(t,i,s,c){return Dn(t,function(d,m,b){i(c,d,s(d),b)}),c}function su(t,i){return t&&rn(i,Qt(i),t)}function _g(t,i){return t&&rn(i,ye(i),t)}function dn(t,i,s){i=="__proto__"&&Xr?Xr(t,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):t[i]=s}function Ns(t,i){for(var s=-1,c=i.length,d=A(c),m=t==null;++s<c;)d[s]=m?n:da(t,i[s]);return d}function Un(t,i,s){return t===t&&(s!==n&&(t=t<=s?t:s),i!==n&&(t=t>=i?t:i)),t}function We(t,i,s,c,d,m){var b,w=i&y,C=i&S,D=i&x;if(s&&(b=d?s(t,c,d,m):s(t)),b!==n)return b;if(!Rt(t))return t;var P=nt(t);if(P){if(b=up(t),!w)return me(t,b)}else{var M=oe(t),L=M==Mr||M==ll;if(Nn(t))return Pu(t,w);if(M==cn||M==ri||L&&!d){if(b=C||L?{}:Ku(t),!w)return C?Jg(t,_g(b,t)):Qg(t,su(b,t))}else{if(!St[M])return d?t:{};b=cp(t,M,w)}}m||(m=new Ye);var z=m.get(t);if(z)return z;m.set(t,b),Cc(t)?t.forEach(function(V){b.add(We(V,i,s,V,t,m))}):Sc(t)&&t.forEach(function(V,lt){b.set(lt,We(V,i,s,lt,t,m))});var G=D?C?js:Js:C?ye:Qt,ot=P?n:G(t);return Fe(ot||t,function(V,lt){ot&&(lt=V,V=t[lt]),Ki(b,lt,We(V,i,s,lt,t,m))}),b}function Sg(t){var i=Qt(t);return function(s){return au(s,t,i)}}function au(t,i,s){var c=s.length;if(t==null)return!c;for(t=_t(t);c--;){var d=s[c],m=i[d],b=t[d];if(b===n&&!(d in t)||!m(b))return!1}return!0}function lu(t,i,s){if(typeof t!="function")throw new $e(u);return nr(function(){t.apply(n,s)},i)}function Zi(t,i,s,c){var d=-1,m=kr,b=!0,w=t.length,C=[],D=i.length;if(!w)return C;s&&(i=Tt(i,Ae(s))),c?(m=bs,b=!1):i.length>=a&&(m=qi,b=!1,i=new qn(i));t:for(;++d<w;){var P=t[d],M=s==null?P:s(P);if(P=c||P!==0?P:0,b&&M===M){for(var L=D;L--;)if(i[L]===M)continue t;C.push(P)}else m(i,M,c)||C.push(P)}return C}var Dn=Lu(nn),uu=Lu(Ls,!0);function Eg(t,i){var s=!0;return Dn(t,function(c,d,m){return s=!!i(c,d,m),s}),s}function to(t,i,s){for(var c=-1,d=t.length;++c<d;){var m=t[c],b=i(m);if(b!=null&&(w===n?b===b&&!Ie(b):s(b,w)))var w=b,C=m}return C}function Cg(t,i,s,c){var d=t.length;for(s=it(s),s<0&&(s=-s>d?0:d+s),c=c===n||c>d?d:it(c),c<0&&(c+=d),c=s>c?0:Ac(c);s<c;)t[s++]=i;return t}function cu(t,i){var s=[];return Dn(t,function(c,d,m){i(c,d,m)&&s.push(c)}),s}function jt(t,i,s,c,d){var m=-1,b=t.length;for(s||(s=fp),d||(d=[]);++m<b;){var w=t[m];i>0&&s(w)?i>1?jt(w,i-1,s,c,d):An(d,w):c||(d[d.length]=w)}return d}var Os=ku(),hu=ku(!0);function nn(t,i){return t&&Os(t,i,Qt)}function Ls(t,i){return t&&hu(t,i,Qt)}function eo(t,i){return xn(i,function(s){return vn(t[s])})}function Gn(t,i){i=Mn(i,t);for(var s=0,c=i.length;t!=null&&s<c;)t=t[on(i[s++])];return s&&s==c?t:n}function fu(t,i,s){var c=i(t);return nt(t)?c:An(c,s(t))}function he(t){return t==null?t===n?Jh:Zh:zn&&zn in _t(t)?sp(t):bp(t)}function ks(t,i){return t>i}function xg(t,i){return t!=null&&wt.call(t,i)}function Ag(t,i){return t!=null&&i in _t(t)}function Tg(t,i,s){return t>=re(i,s)&&t<Kt(i,s)}function Fs(t,i,s){for(var c=s?bs:kr,d=t[0].length,m=t.length,b=m,w=A(m),C=1/0,D=[];b--;){var P=t[b];b&&i&&(P=Tt(P,Ae(i))),C=re(P.length,C),w[b]=!s&&(i||d>=120&&P.length>=120)?new qn(b&&P):n}P=t[0];var M=-1,L=w[0];t:for(;++M<d&&D.length<C;){var z=P[M],G=i?i(z):z;if(z=s||z!==0?z:0,!(L?qi(L,G):c(D,G,s))){for(b=m;--b;){var ot=w[b];if(!(ot?qi(ot,G):c(t[b],G,s)))continue t}L&&L.push(G),D.push(z)}}return D}function Ig(t,i,s,c){return nn(t,function(d,m,b){i(c,s(d),m,b)}),c}function Qi(t,i,s){i=Mn(i,t),t=ju(t,i);var c=t==null?t:t[on(He(i))];return c==null?n:xe(c,t,s)}function du(t){return Lt(t)&&he(t)==ri}function Dg(t){return Lt(t)&&he(t)==Hi}function Pg(t){return Lt(t)&&he(t)==Fi}function Ji(t,i,s,c,d){return t===i?!0:t==null||i==null||!Lt(t)&&!Lt(i)?t!==t&&i!==i:Mg(t,i,s,c,Ji,d)}function Mg(t,i,s,c,d,m){var b=nt(t),w=nt(i),C=b?Dr:oe(t),D=w?Dr:oe(i);C=C==ri?cn:C,D=D==ri?cn:D;var P=C==cn,M=D==cn,L=C==D;if(L&&Nn(t)){if(!Nn(i))return!1;b=!0,P=!1}if(L&&!P)return m||(m=new Ye),b||yi(t)?Vu(t,i,s,c,d,m):rp(t,i,C,s,c,d,m);if(!(s&I)){var z=P&&wt.call(t,"__wrapped__"),G=M&&wt.call(i,"__wrapped__");if(z||G){var ot=z?t.value():t,V=G?i.value():i;return m||(m=new Ye),d(ot,V,s,c,m)}}return L?(m||(m=new Ye),op(t,i,s,c,d,m)):!1}function Rg(t){return Lt(t)&&oe(t)==Ge}function $s(t,i,s,c){var d=s.length,m=d,b=!c;if(t==null)return!m;for(t=_t(t);d--;){var w=s[d];if(b&&w[2]?w[1]!==t[w[0]]:!(w[0]in t))return!1}for(;++d<m;){w=s[d];var C=w[0],D=t[C],P=w[1];if(b&&w[2]){if(D===n&&!(C in t))return!1}else{var M=new Ye;if(c)var L=c(D,P,C,t,i,M);if(!(L===n?Ji(P,D,I|R,c,M):L))return!1}}return!0}function gu(t){if(!Rt(t)||gp(t))return!1;var i=vn(t)?Rd:Sf;return i.test(Xn(t))}function Ng(t){return Lt(t)&&he(t)==Bi}function Og(t){return Lt(t)&&oe(t)==Ve}function Lg(t){return Lt(t)&&bo(t.length)&&!!xt[he(t)]}function pu(t){return typeof t=="function"?t:t==null?be:typeof t=="object"?nt(t)?yu(t[0],t[1]):vu(t):Fc(t)}function Bs(t){if(!er(t))return $d(t);var i=[];for(var s in _t(t))wt.call(t,s)&&s!="constructor"&&i.push(s);return i}function kg(t){if(!Rt(t))return yp(t);var i=er(t),s=[];for(var c in t)c=="constructor"&&(i||!wt.call(t,c))||s.push(c);return s}function Ws(t,i){return t<i}function mu(t,i){var s=-1,c=ve(t)?A(t.length):[];return Dn(t,function(d,m,b){c[++s]=i(d,m,b)}),c}function vu(t){var i=ea(t);return i.length==1&&i[0][2]?Qu(i[0][0],i[0][1]):function(s){return s===t||$s(s,t,i)}}function yu(t,i){return ia(t)&&Zu(i)?Qu(on(t),i):function(s){var c=da(s,t);return c===n&&c===i?ga(s,t):Ji(i,c,I|R)}}function no(t,i,s,c,d){t!==i&&Os(i,function(m,b){if(d||(d=new Ye),Rt(m))Fg(t,i,b,s,no,c,d);else{var w=c?c(oa(t,b),m,b+"",t,i,d):n;w===n&&(w=m),Rs(t,b,w)}},ye)}function Fg(t,i,s,c,d,m,b){var w=oa(t,s),C=oa(i,s),D=b.get(C);if(D){Rs(t,s,D);return}var P=m?m(w,C,s+"",t,i,b):n,M=P===n;if(M){var L=nt(C),z=!L&&Nn(C),G=!L&&!z&&yi(C);P=C,L||z||G?nt(w)?P=w:Wt(w)?P=me(w):z?(M=!1,P=Pu(C,!0)):G?(M=!1,P=Mu(C,!0)):P=[]:ir(C)||Yn(C)?(P=w,Yn(w)?P=Tc(w):(!Rt(w)||vn(w))&&(P=Ku(C))):M=!1}M&&(b.set(C,P),d(P,C,c,m,b),b.delete(C)),Rs(t,s,P)}function bu(t,i){var s=t.length;if(s)return i+=i<0?s:0,mn(i,s)?t[i]:n}function wu(t,i,s){i.length?i=Tt(i,function(m){return nt(m)?function(b){return Gn(b,m.length===1?m[0]:m)}:m}):i=[be];var c=-1;i=Tt(i,Ae(U()));var d=mu(t,function(m,b,w){var C=Tt(i,function(D){return D(m)});return{criteria:C,index:++c,value:m}});return cd(d,function(m,b){return Zg(m,b,s)})}function $g(t,i){return _u(t,i,function(s,c){return ga(t,c)})}function _u(t,i,s){for(var c=-1,d=i.length,m={};++c<d;){var b=i[c],w=Gn(t,b);s(w,b)&&ji(m,Mn(b,t),w)}return m}function Bg(t){return function(i){return Gn(i,t)}}function zs(t,i,s,c){var d=c?ud:ai,m=-1,b=i.length,w=t;for(t===i&&(i=me(i)),s&&(w=Tt(t,Ae(s)));++m<b;)for(var C=0,D=i[m],P=s?s(D):D;(C=d(w,P,C,c))>-1;)w!==t&&Vr.call(w,C,1),Vr.call(t,C,1);return t}function Su(t,i){for(var s=t?i.length:0,c=s-1;s--;){var d=i[s];if(s==c||d!==m){var m=d;mn(d)?Vr.call(t,d,1):Gs(t,d)}}return t}function Hs(t,i){return t+Kr(nu()*(i-t+1))}function Wg(t,i,s,c){for(var d=-1,m=Kt(Yr((i-t)/(s||1)),0),b=A(m);m--;)b[c?m:++d]=t,t+=s;return b}function qs(t,i){var s="";if(!t||i<1||i>Zt)return s;do i%2&&(s+=t),i=Kr(i/2),i&&(t+=t);while(i);return s}function at(t,i){return sa(Ju(t,i,be),t+"")}function zg(t){return ou(bi(t))}function Hg(t,i){var s=bi(t);return fo(s,Un(i,0,s.length))}function ji(t,i,s,c){if(!Rt(t))return t;i=Mn(i,t);for(var d=-1,m=i.length,b=m-1,w=t;w!=null&&++d<m;){var C=on(i[d]),D=s;if(C==="__proto__"||C==="constructor"||C==="prototype")return t;if(d!=b){var P=w[C];D=c?c(P,C,w):n,D===n&&(D=Rt(P)?P:mn(i[d+1])?[]:{})}Ki(w,C,D),w=w[C]}return t}var Eu=Zr?function(t,i){return Zr.set(t,i),t}:be,qg=Xr?function(t,i){return Xr(t,"toString",{configurable:!0,enumerable:!1,value:ma(i),writable:!0})}:be;function Ug(t){return fo(bi(t))}function ze(t,i,s){var c=-1,d=t.length;i<0&&(i=-i>d?0:d+i),s=s>d?d:s,s<0&&(s+=d),d=i>s?0:s-i>>>0,i>>>=0;for(var m=A(d);++c<d;)m[c]=t[c+i];return m}function Gg(t,i){var s;return Dn(t,function(c,d,m){return s=i(c,d,m),!s}),!!s}function io(t,i,s){var c=0,d=t==null?c:t.length;if(typeof i=="number"&&i===i&&d<=Vh){for(;c<d;){var m=c+d>>>1,b=t[m];b!==null&&!Ie(b)&&(s?b<=i:b<i)?c=m+1:d=m}return d}return Us(t,i,be,s)}function Us(t,i,s,c){var d=0,m=t==null?0:t.length;if(m===0)return 0;i=s(i);for(var b=i!==i,w=i===null,C=Ie(i),D=i===n;d<m;){var P=Kr((d+m)/2),M=s(t[P]),L=M!==n,z=M===null,G=M===M,ot=Ie(M);if(b)var V=c||G;else D?V=G&&(c||L):w?V=G&&L&&(c||!z):C?V=G&&L&&!z&&(c||!ot):z||ot?V=!1:V=c?M<=i:M<i;V?d=P+1:m=P}return re(m,Li)}function Cu(t,i){for(var s=-1,c=t.length,d=0,m=[];++s<c;){var b=t[s],w=i?i(b):b;if(!s||!Ke(w,C)){var C=w;m[d++]=b===0?0:b}}return m}function xu(t){return typeof t=="number"?t:Ie(t)?ii:+t}function Te(t){if(typeof t=="string")return t;if(nt(t))return Tt(t,Te)+"";if(Ie(t))return iu?iu.call(t):"";var i=t+"";return i=="0"&&1/t==-1/0?"-0":i}function Pn(t,i,s){var c=-1,d=kr,m=t.length,b=!0,w=[],C=w;if(s)b=!1,d=bs;else if(m>=a){var D=i?null:np(t);if(D)return $r(D);b=!1,d=qi,C=new qn}else C=i?[]:w;t:for(;++c<m;){var P=t[c],M=i?i(P):P;if(P=s||P!==0?P:0,b&&M===M){for(var L=C.length;L--;)if(C[L]===M)continue t;i&&C.push(M),w.push(P)}else d(C,M,s)||(C!==w&&C.push(M),w.push(P))}return w}function Gs(t,i){return i=Mn(i,t),t=ju(t,i),t==null||delete t[on(He(i))]}function Au(t,i,s,c){return ji(t,i,s(Gn(t,i)),c)}function ro(t,i,s,c){for(var d=t.length,m=c?d:-1;(c?m--:++m<d)&&i(t[m],m,t););return s?ze(t,c?0:m,c?m+1:d):ze(t,c?m+1:0,c?d:m)}function Tu(t,i){var s=t;return s instanceof ut&&(s=s.value()),ws(i,function(c,d){return d.func.apply(d.thisArg,An([c],d.args))},s)}function Vs(t,i,s){var c=t.length;if(c<2)return c?Pn(t[0]):[];for(var d=-1,m=A(c);++d<c;)for(var b=t[d],w=-1;++w<c;)w!=d&&(m[d]=Zi(m[d]||b,t[w],i,s));return Pn(jt(m,1),i,s)}function Iu(t,i,s){for(var c=-1,d=t.length,m=i.length,b={};++c<d;){var w=c<m?i[c]:n;s(b,t[c],w)}return b}function Xs(t){return Wt(t)?t:[]}function Ys(t){return typeof t=="function"?t:be}function Mn(t,i){return nt(t)?t:ia(t,i)?[t]:ic(yt(t))}var Vg=at;function Rn(t,i,s){var c=t.length;return s=s===n?c:s,!i&&s>=c?t:ze(t,i,s)}var Du=Nd||function(t){return Jt.clearTimeout(t)};function Pu(t,i){if(i)return t.slice();var s=t.length,c=Ql?Ql(s):new t.constructor(s);return t.copy(c),c}function Ks(t){var i=new t.constructor(t.byteLength);return new Ur(i).set(new Ur(t)),i}function Xg(t,i){var s=i?Ks(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.byteLength)}function Yg(t){var i=new t.constructor(t.source,dl.exec(t));return i.lastIndex=t.lastIndex,i}function Kg(t){return Yi?_t(Yi.call(t)):{}}function Mu(t,i){var s=i?Ks(t.buffer):t.buffer;return new t.constructor(s,t.byteOffset,t.length)}function Ru(t,i){if(t!==i){var s=t!==n,c=t===null,d=t===t,m=Ie(t),b=i!==n,w=i===null,C=i===i,D=Ie(i);if(!w&&!D&&!m&&t>i||m&&b&&C&&!w&&!D||c&&b&&C||!s&&C||!d)return 1;if(!c&&!m&&!D&&t<i||D&&s&&d&&!c&&!m||w&&s&&d||!b&&d||!C)return-1}return 0}function Zg(t,i,s){for(var c=-1,d=t.criteria,m=i.criteria,b=d.length,w=s.length;++c<b;){var C=Ru(d[c],m[c]);if(C){if(c>=w)return C;var D=s[c];return C*(D=="desc"?-1:1)}}return t.index-i.index}function Nu(t,i,s,c){for(var d=-1,m=t.length,b=s.length,w=-1,C=i.length,D=Kt(m-b,0),P=A(C+D),M=!c;++w<C;)P[w]=i[w];for(;++d<b;)(M||d<m)&&(P[s[d]]=t[d]);for(;D--;)P[w++]=t[d++];return P}function Ou(t,i,s,c){for(var d=-1,m=t.length,b=-1,w=s.length,C=-1,D=i.length,P=Kt(m-w,0),M=A(P+D),L=!c;++d<P;)M[d]=t[d];for(var z=d;++C<D;)M[z+C]=i[C];for(;++b<w;)(L||d<m)&&(M[z+s[b]]=t[d++]);return M}function me(t,i){var s=-1,c=t.length;for(i||(i=A(c));++s<c;)i[s]=t[s];return i}function rn(t,i,s,c){var d=!s;s||(s={});for(var m=-1,b=i.length;++m<b;){var w=i[m],C=c?c(s[w],t[w],w,s,t):n;C===n&&(C=t[w]),d?dn(s,w,C):Ki(s,w,C)}return s}function Qg(t,i){return rn(t,na(t),i)}function Jg(t,i){return rn(t,Xu(t),i)}function oo(t,i){return function(s,c){var d=nt(s)?id:wg,m=i?i():{};return d(s,t,U(c,2),m)}}function pi(t){return at(function(i,s){var c=-1,d=s.length,m=d>1?s[d-1]:n,b=d>2?s[2]:n;for(m=t.length>3&&typeof m=="function"?(d--,m):n,b&&fe(s[0],s[1],b)&&(m=d<3?n:m,d=1),i=_t(i);++c<d;){var w=s[c];w&&t(i,w,c,m)}return i})}function Lu(t,i){return function(s,c){if(s==null)return s;if(!ve(s))return t(s,c);for(var d=s.length,m=i?d:-1,b=_t(s);(i?m--:++m<d)&&c(b[m],m,b)!==!1;);return s}}function ku(t){return function(i,s,c){for(var d=-1,m=_t(i),b=c(i),w=b.length;w--;){var C=b[t?w:++d];if(s(m[C],C,m)===!1)break}return i}}function jg(t,i,s){var c=i&k,d=tr(t);function m(){var b=this&&this!==Jt&&this instanceof m?d:t;return b.apply(c?s:this,arguments)}return m}function Fu(t){return function(i){i=yt(i);var s=li(i)?Xe(i):n,c=s?s[0]:i.charAt(0),d=s?Rn(s,1).join(""):i.slice(1);return c[t]()+d}}function mi(t){return function(i){return ws(Lc(Oc(i).replace(qf,"")),t,"")}}function tr(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=gi(t.prototype),c=t.apply(s,i);return Rt(c)?c:s}}function tp(t,i,s){var c=tr(t);function d(){for(var m=arguments.length,b=A(m),w=m,C=vi(d);w--;)b[w]=arguments[w];var D=m<3&&b[0]!==C&&b[m-1]!==C?[]:Tn(b,C);if(m-=D.length,m<s)return Hu(t,i,so,d.placeholder,n,b,D,n,n,s-m);var P=this&&this!==Jt&&this instanceof d?c:t;return xe(P,this,b)}return d}function $u(t){return function(i,s,c){var d=_t(i);if(!ve(i)){var m=U(s,3);i=Qt(i),s=function(w){return m(d[w],w,d)}}var b=t(i,s,c);return b>-1?d[m?i[b]:b]:n}}function Bu(t){return pn(function(i){var s=i.length,c=s,d=Be.prototype.thru;for(t&&i.reverse();c--;){var m=i[c];if(typeof m!="function")throw new $e(u);if(d&&!b&&co(m)=="wrapper")var b=new Be([],!0)}for(c=b?c:s;++c<s;){m=i[c];var w=co(m),C=w=="wrapper"?ta(m):n;C&&ra(C[0])&&C[1]==(bt|H|gt|$t)&&!C[4].length&&C[9]==1?b=b[co(C[0])].apply(b,C[3]):b=m.length==1&&ra(m)?b[w]():b.thru(m)}return function(){var D=arguments,P=D[0];if(b&&D.length==1&&nt(P))return b.plant(P).value();for(var M=0,L=s?i[M].apply(this,D):P;++M<s;)L=i[M].call(this,L);return L}})}function so(t,i,s,c,d,m,b,w,C,D){var P=i&bt,M=i&k,L=i&Z,z=i&(H|Q),G=i&ft,ot=L?n:tr(t);function V(){for(var lt=arguments.length,ct=A(lt),De=lt;De--;)ct[De]=arguments[De];if(z)var de=vi(V),Pe=fd(ct,de);if(c&&(ct=Nu(ct,c,d,z)),m&&(ct=Ou(ct,m,b,z)),lt-=Pe,z&&lt<D){var zt=Tn(ct,de);return Hu(t,i,so,V.placeholder,s,ct,zt,w,C,D-lt)}var Ze=M?s:this,bn=L?Ze[t]:t;return lt=ct.length,w?ct=wp(ct,w):G&&lt>1&&ct.reverse(),P&&C<lt&&(ct.length=C),this&&this!==Jt&&this instanceof V&&(bn=ot||tr(bn)),bn.apply(Ze,ct)}return V}function Wu(t,i){return function(s,c){return Ig(s,t,i(c),{})}}function ao(t,i){return function(s,c){var d;if(s===n&&c===n)return i;if(s!==n&&(d=s),c!==n){if(d===n)return c;typeof s=="string"||typeof c=="string"?(s=Te(s),c=Te(c)):(s=xu(s),c=xu(c)),d=t(s,c)}return d}}function Zs(t){return pn(function(i){return i=Tt(i,Ae(U())),at(function(s){var c=this;return t(i,function(d){return xe(d,c,s)})})})}function lo(t,i){i=i===n?" ":Te(i);var s=i.length;if(s<2)return s?qs(i,t):i;var c=qs(i,Yr(t/ui(i)));return li(i)?Rn(Xe(c),0,t).join(""):c.slice(0,t)}function ep(t,i,s,c){var d=i&k,m=tr(t);function b(){for(var w=-1,C=arguments.length,D=-1,P=c.length,M=A(P+C),L=this&&this!==Jt&&this instanceof b?m:t;++D<P;)M[D]=c[D];for(;C--;)M[D++]=arguments[++w];return xe(L,d?s:this,M)}return b}function zu(t){return function(i,s,c){return c&&typeof c!="number"&&fe(i,s,c)&&(s=c=n),i=yn(i),s===n?(s=i,i=0):s=yn(s),c=c===n?i<s?1:-1:yn(c),Wg(i,s,c,t)}}function uo(t){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=qe(i),s=qe(s)),t(i,s)}}function Hu(t,i,s,c,d,m,b,w,C,D){var P=i&H,M=P?b:n,L=P?n:b,z=P?m:n,G=P?n:m;i|=P?gt:ht,i&=~(P?ht:gt),i&F||(i&=-4);var ot=[t,i,d,z,M,G,L,w,C,D],V=s.apply(n,ot);return ra(t)&&tc(V,ot),V.placeholder=c,ec(V,t,i)}function Qs(t){var i=Yt[t];return function(s,c){if(s=qe(s),c=c==null?0:re(it(c),292),c&&eu(s)){var d=(yt(s)+"e").split("e"),m=i(d[0]+"e"+(+d[1]+c));return d=(yt(m)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return i(s)}}var np=fi&&1/$r(new fi([,-0]))[1]==Mt?function(t){return new fi(t)}:ba;function qu(t){return function(i){var s=oe(i);return s==Ge?Ts(i):s==Ve?bd(i):hd(i,t(i))}}function gn(t,i,s,c,d,m,b,w){var C=i&Z;if(!C&&typeof t!="function")throw new $e(u);var D=c?c.length:0;if(D||(i&=-97,c=d=n),b=b===n?b:Kt(it(b),0),w=w===n?w:it(w),D-=d?d.length:0,i&ht){var P=c,M=d;c=d=n}var L=C?n:ta(t),z=[t,i,s,c,d,P,M,m,b,w];if(L&&vp(z,L),t=z[0],i=z[1],s=z[2],c=z[3],d=z[4],w=z[9]=z[9]===n?C?0:t.length:Kt(z[9]-D,0),!w&&i&(H|Q)&&(i&=-25),!i||i==k)var G=jg(t,i,s);else i==H||i==Q?G=tp(t,i,w):(i==gt||i==(k|gt))&&!d.length?G=ep(t,i,s,c):G=so.apply(n,z);var ot=L?Eu:tc;return ec(ot(G,z),t,i)}function Uu(t,i,s,c){return t===n||Ke(t,hi[s])&&!wt.call(c,s)?i:t}function Gu(t,i,s,c,d,m){return Rt(t)&&Rt(i)&&(m.set(i,t),no(t,i,n,Gu,m),m.delete(i)),t}function ip(t){return ir(t)?n:t}function Vu(t,i,s,c,d,m){var b=s&I,w=t.length,C=i.length;if(w!=C&&!(b&&C>w))return!1;var D=m.get(t),P=m.get(i);if(D&&P)return D==i&&P==t;var M=-1,L=!0,z=s&R?new qn:n;for(m.set(t,i),m.set(i,t);++M<w;){var G=t[M],ot=i[M];if(c)var V=b?c(ot,G,M,i,t,m):c(G,ot,M,t,i,m);if(V!==n){if(V)continue;L=!1;break}if(z){if(!_s(i,function(lt,ct){if(!qi(z,ct)&&(G===lt||d(G,lt,s,c,m)))return z.push(ct)})){L=!1;break}}else if(!(G===ot||d(G,ot,s,c,m))){L=!1;break}}return m.delete(t),m.delete(i),L}function rp(t,i,s,c,d,m,b){switch(s){case oi:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)return!1;t=t.buffer,i=i.buffer;case Hi:return!(t.byteLength!=i.byteLength||!m(new Ur(t),new Ur(i)));case ki:case Fi:case $i:return Ke(+t,+i);case Pr:return t.name==i.name&&t.message==i.message;case Bi:case Wi:return t==i+"";case Ge:var w=Ts;case Ve:var C=c&I;if(w||(w=$r),t.size!=i.size&&!C)return!1;var D=b.get(t);if(D)return D==i;c|=R,b.set(t,i);var P=Vu(w(t),w(i),c,d,m,b);return b.delete(t),P;case Rr:if(Yi)return Yi.call(t)==Yi.call(i)}return!1}function op(t,i,s,c,d,m){var b=s&I,w=Js(t),C=w.length,D=Js(i),P=D.length;if(C!=P&&!b)return!1;for(var M=C;M--;){var L=w[M];if(!(b?L in i:wt.call(i,L)))return!1}var z=m.get(t),G=m.get(i);if(z&&G)return z==i&&G==t;var ot=!0;m.set(t,i),m.set(i,t);for(var V=b;++M<C;){L=w[M];var lt=t[L],ct=i[L];if(c)var De=b?c(ct,lt,L,i,t,m):c(lt,ct,L,t,i,m);if(!(De===n?lt===ct||d(lt,ct,s,c,m):De)){ot=!1;break}V||(V=L=="constructor")}if(ot&&!V){var de=t.constructor,Pe=i.constructor;de!=Pe&&"constructor"in t&&"constructor"in i&&!(typeof de=="function"&&de instanceof de&&typeof Pe=="function"&&Pe instanceof Pe)&&(ot=!1)}return m.delete(t),m.delete(i),ot}function pn(t){return sa(Ju(t,n,ac),t+"")}function Js(t){return fu(t,Qt,na)}function js(t){return fu(t,ye,Xu)}var ta=Zr?function(t){return Zr.get(t)}:ba;function co(t){for(var i=t.name+"",s=di[i],c=wt.call(di,i)?s.length:0;c--;){var d=s[c],m=d.func;if(m==null||m==t)return d.name}return i}function vi(t){var i=wt.call(p,"placeholder")?p:t;return i.placeholder}function U(){var t=p.iteratee||va;return t=t===va?pu:t,arguments.length?t(arguments[0],arguments[1]):t}function ho(t,i){var s=t.__data__;return dp(i)?s[typeof i=="string"?"string":"hash"]:s.map}function ea(t){for(var i=Qt(t),s=i.length;s--;){var c=i[s],d=t[c];i[s]=[c,d,Zu(d)]}return i}function Vn(t,i){var s=md(t,i);return gu(s)?s:n}function sp(t){var i=wt.call(t,zn),s=t[zn];try{t[zn]=n;var c=!0}catch{}var d=Hr.call(t);return c&&(i?t[zn]=s:delete t[zn]),d}var na=Ds?function(t){return t==null?[]:(t=_t(t),xn(Ds(t),function(i){return jl.call(t,i)}))}:wa,Xu=Ds?function(t){for(var i=[];t;)An(i,na(t)),t=Gr(t);return i}:wa,oe=he;(Ps&&oe(new Ps(new ArrayBuffer(1)))!=oi||Gi&&oe(new Gi)!=Ge||Ms&&oe(Ms.resolve())!=ul||fi&&oe(new fi)!=Ve||Vi&&oe(new Vi)!=zi)&&(oe=function(t){var i=he(t),s=i==cn?t.constructor:n,c=s?Xn(s):"";if(c)switch(c){case Hd:return oi;case qd:return Ge;case Ud:return ul;case Gd:return Ve;case Vd:return zi}return i});function ap(t,i,s){for(var c=-1,d=s.length;++c<d;){var m=s[c],b=m.size;switch(m.type){case"drop":t+=b;break;case"dropRight":i-=b;break;case"take":i=re(i,t+b);break;case"takeRight":t=Kt(t,i-b);break}}return{start:t,end:i}}function lp(t){var i=t.match(gf);return i?i[1].split(pf):[]}function Yu(t,i,s){i=Mn(i,t);for(var c=-1,d=i.length,m=!1;++c<d;){var b=on(i[c]);if(!(m=t!=null&&s(t,b)))break;t=t[b]}return m||++c!=d?m:(d=t==null?0:t.length,!!d&&bo(d)&&mn(b,d)&&(nt(t)||Yn(t)))}function up(t){var i=t.length,s=new t.constructor(i);return i&&typeof t[0]=="string"&&wt.call(t,"index")&&(s.index=t.index,s.input=t.input),s}function Ku(t){return typeof t.constructor=="function"&&!er(t)?gi(Gr(t)):{}}function cp(t,i,s){var c=t.constructor;switch(i){case Hi:return Ks(t);case ki:case Fi:return new c(+t);case oi:return Xg(t,s);case es:case ns:case is:case rs:case os:case ss:case as:case ls:case us:return Mu(t,s);case Ge:return new c;case $i:case Wi:return new c(t);case Bi:return Yg(t);case Ve:return new c;case Rr:return Kg(t)}}function hp(t,i){var s=i.length;if(!s)return t;var c=s-1;return i[c]=(s>1?"& ":"")+i[c],i=i.join(s>2?", ":" "),t.replace(df,`{
/* [wrapped with `+i+`] */
`)}function fp(t){return nt(t)||Yn(t)||!!(tu&&t&&t[tu])}function mn(t,i){var s=typeof t;return i=i??Zt,!!i&&(s=="number"||s!="symbol"&&Cf.test(t))&&t>-1&&t%1==0&&t<i}function fe(t,i,s){if(!Rt(s))return!1;var c=typeof i;return(c=="number"?ve(s)&&mn(i,s.length):c=="string"&&i in s)?Ke(s[i],t):!1}function ia(t,i){if(nt(t))return!1;var s=typeof t;return s=="number"||s=="symbol"||s=="boolean"||t==null||Ie(t)?!0:uf.test(t)||!lf.test(t)||i!=null&&t in _t(i)}function dp(t){var i=typeof t;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?t!=="__proto__":t===null}function ra(t){var i=co(t),s=p[i];if(typeof s!="function"||!(i in ut.prototype))return!1;if(t===s)return!0;var c=ta(s);return!!c&&t===c[0]}function gp(t){return!!Zl&&Zl in t}var pp=Wr?vn:_a;function er(t){var i=t&&t.constructor,s=typeof i=="function"&&i.prototype||hi;return t===s}function Zu(t){return t===t&&!Rt(t)}function Qu(t,i){return function(s){return s==null?!1:s[t]===i&&(i!==n||t in _t(s))}}function mp(t){var i=vo(t,function(c){return s.size===g&&s.clear(),c}),s=i.cache;return i}function vp(t,i){var s=t[1],c=i[1],d=s|c,m=d<(k|Z|bt),b=c==bt&&s==H||c==bt&&s==$t&&t[7].length<=i[8]||c==(bt|$t)&&i[7].length<=i[8]&&s==H;if(!(m||b))return t;c&k&&(t[2]=i[2],d|=s&k?0:F);var w=i[3];if(w){var C=t[3];t[3]=C?Nu(C,w,i[4]):w,t[4]=C?Tn(t[3],v):i[4]}return w=i[5],w&&(C=t[5],t[5]=C?Ou(C,w,i[6]):w,t[6]=C?Tn(t[5],v):i[6]),w=i[7],w&&(t[7]=w),c&bt&&(t[8]=t[8]==null?i[8]:re(t[8],i[8])),t[9]==null&&(t[9]=i[9]),t[0]=i[0],t[1]=d,t}function yp(t){var i=[];if(t!=null)for(var s in _t(t))i.push(s);return i}function bp(t){return Hr.call(t)}function Ju(t,i,s){return i=Kt(i===n?t.length-1:i,0),function(){for(var c=arguments,d=-1,m=Kt(c.length-i,0),b=A(m);++d<m;)b[d]=c[i+d];d=-1;for(var w=A(i+1);++d<i;)w[d]=c[d];return w[i]=s(b),xe(t,this,w)}}function ju(t,i){return i.length<2?t:Gn(t,ze(i,0,-1))}function wp(t,i){for(var s=t.length,c=re(i.length,s),d=me(t);c--;){var m=i[c];t[c]=mn(m,s)?d[m]:n}return t}function oa(t,i){if(!(i==="constructor"&&typeof t[i]=="function")&&i!="__proto__")return t[i]}var tc=nc(Eu),nr=Ld||function(t,i){return Jt.setTimeout(t,i)},sa=nc(qg);function ec(t,i,s){var c=i+"";return sa(t,hp(c,_p(lp(c),s)))}function nc(t){var i=0,s=0;return function(){var c=Bd(),d=Pt-(c-s);if(s=c,d>0){if(++i>=ue)return arguments[0]}else i=0;return t.apply(n,arguments)}}function fo(t,i){var s=-1,c=t.length,d=c-1;for(i=i===n?c:i;++s<i;){var m=Hs(s,d),b=t[m];t[m]=t[s],t[s]=b}return t.length=i,t}var ic=mp(function(t){var i=[];return t.charCodeAt(0)===46&&i.push(""),t.replace(cf,function(s,c,d,m){i.push(d?m.replace(yf,"$1"):c||s)}),i});function on(t){if(typeof t=="string"||Ie(t))return t;var i=t+"";return i=="0"&&1/t==-1/0?"-0":i}function Xn(t){if(t!=null){try{return zr.call(t)}catch{}try{return t+""}catch{}}return""}function _p(t,i){return Fe(Xh,function(s){var c="_."+s[0];i&s[1]&&!kr(t,c)&&t.push(c)}),t.sort()}function rc(t){if(t instanceof ut)return t.clone();var i=new Be(t.__wrapped__,t.__chain__);return i.__actions__=me(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}function Sp(t,i,s){(s?fe(t,i,s):i===n)?i=1:i=Kt(it(i),0);var c=t==null?0:t.length;if(!c||i<1)return[];for(var d=0,m=0,b=A(Yr(c/i));d<c;)b[m++]=ze(t,d,d+=i);return b}function Ep(t){for(var i=-1,s=t==null?0:t.length,c=0,d=[];++i<s;){var m=t[i];m&&(d[c++]=m)}return d}function Cp(){var t=arguments.length;if(!t)return[];for(var i=A(t-1),s=arguments[0],c=t;c--;)i[c-1]=arguments[c];return An(nt(s)?me(s):[s],jt(i,1))}var xp=at(function(t,i){return Wt(t)?Zi(t,jt(i,1,Wt,!0)):[]}),Ap=at(function(t,i){var s=He(i);return Wt(s)&&(s=n),Wt(t)?Zi(t,jt(i,1,Wt,!0),U(s,2)):[]}),Tp=at(function(t,i){var s=He(i);return Wt(s)&&(s=n),Wt(t)?Zi(t,jt(i,1,Wt,!0),n,s):[]});function Ip(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===n?1:it(i),ze(t,i<0?0:i,c)):[]}function Dp(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===n?1:it(i),i=c-i,ze(t,0,i<0?0:i)):[]}function Pp(t,i){return t&&t.length?ro(t,U(i,3),!0,!0):[]}function Mp(t,i){return t&&t.length?ro(t,U(i,3),!0):[]}function Rp(t,i,s,c){var d=t==null?0:t.length;return d?(s&&typeof s!="number"&&fe(t,i,s)&&(s=0,c=d),Cg(t,i,s,c)):[]}function oc(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=s==null?0:it(s);return d<0&&(d=Kt(c+d,0)),Fr(t,U(i,3),d)}function sc(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=c-1;return s!==n&&(d=it(s),d=s<0?Kt(c+d,0):re(d,c-1)),Fr(t,U(i,3),d,!0)}function ac(t){var i=t==null?0:t.length;return i?jt(t,1):[]}function Np(t){var i=t==null?0:t.length;return i?jt(t,Mt):[]}function Op(t,i){var s=t==null?0:t.length;return s?(i=i===n?1:it(i),jt(t,i)):[]}function Lp(t){for(var i=-1,s=t==null?0:t.length,c={};++i<s;){var d=t[i];c[d[0]]=d[1]}return c}function lc(t){return t&&t.length?t[0]:n}function kp(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=s==null?0:it(s);return d<0&&(d=Kt(c+d,0)),ai(t,i,d)}function Fp(t){var i=t==null?0:t.length;return i?ze(t,0,-1):[]}var $p=at(function(t){var i=Tt(t,Xs);return i.length&&i[0]===t[0]?Fs(i):[]}),Bp=at(function(t){var i=He(t),s=Tt(t,Xs);return i===He(s)?i=n:s.pop(),s.length&&s[0]===t[0]?Fs(s,U(i,2)):[]}),Wp=at(function(t){var i=He(t),s=Tt(t,Xs);return i=typeof i=="function"?i:n,i&&s.pop(),s.length&&s[0]===t[0]?Fs(s,n,i):[]});function zp(t,i){return t==null?"":Fd.call(t,i)}function He(t){var i=t==null?0:t.length;return i?t[i-1]:n}function Hp(t,i,s){var c=t==null?0:t.length;if(!c)return-1;var d=c;return s!==n&&(d=it(s),d=d<0?Kt(c+d,0):re(d,c-1)),i===i?_d(t,i,d):Fr(t,Hl,d,!0)}function qp(t,i){return t&&t.length?bu(t,it(i)):n}var Up=at(uc);function uc(t,i){return t&&t.length&&i&&i.length?zs(t,i):t}function Gp(t,i,s){return t&&t.length&&i&&i.length?zs(t,i,U(s,2)):t}function Vp(t,i,s){return t&&t.length&&i&&i.length?zs(t,i,n,s):t}var Xp=pn(function(t,i){var s=t==null?0:t.length,c=Ns(t,i);return Su(t,Tt(i,function(d){return mn(d,s)?+d:d}).sort(Ru)),c});function Yp(t,i){var s=[];if(!(t&&t.length))return s;var c=-1,d=[],m=t.length;for(i=U(i,3);++c<m;){var b=t[c];i(b,c,t)&&(s.push(b),d.push(c))}return Su(t,d),s}function aa(t){return t==null?t:zd.call(t)}function Kp(t,i,s){var c=t==null?0:t.length;return c?(s&&typeof s!="number"&&fe(t,i,s)?(i=0,s=c):(i=i==null?0:it(i),s=s===n?c:it(s)),ze(t,i,s)):[]}function Zp(t,i){return io(t,i)}function Qp(t,i,s){return Us(t,i,U(s,2))}function Jp(t,i){var s=t==null?0:t.length;if(s){var c=io(t,i);if(c<s&&Ke(t[c],i))return c}return-1}function jp(t,i){return io(t,i,!0)}function tm(t,i,s){return Us(t,i,U(s,2),!0)}function em(t,i){var s=t==null?0:t.length;if(s){var c=io(t,i,!0)-1;if(Ke(t[c],i))return c}return-1}function nm(t){return t&&t.length?Cu(t):[]}function im(t,i){return t&&t.length?Cu(t,U(i,2)):[]}function rm(t){var i=t==null?0:t.length;return i?ze(t,1,i):[]}function om(t,i,s){return t&&t.length?(i=s||i===n?1:it(i),ze(t,0,i<0?0:i)):[]}function sm(t,i,s){var c=t==null?0:t.length;return c?(i=s||i===n?1:it(i),i=c-i,ze(t,i<0?0:i,c)):[]}function am(t,i){return t&&t.length?ro(t,U(i,3),!1,!0):[]}function lm(t,i){return t&&t.length?ro(t,U(i,3)):[]}var um=at(function(t){return Pn(jt(t,1,Wt,!0))}),cm=at(function(t){var i=He(t);return Wt(i)&&(i=n),Pn(jt(t,1,Wt,!0),U(i,2))}),hm=at(function(t){var i=He(t);return i=typeof i=="function"?i:n,Pn(jt(t,1,Wt,!0),n,i)});function fm(t){return t&&t.length?Pn(t):[]}function dm(t,i){return t&&t.length?Pn(t,U(i,2)):[]}function gm(t,i){return i=typeof i=="function"?i:n,t&&t.length?Pn(t,n,i):[]}function la(t){if(!(t&&t.length))return[];var i=0;return t=xn(t,function(s){if(Wt(s))return i=Kt(s.length,i),!0}),xs(i,function(s){return Tt(t,Ss(s))})}function cc(t,i){if(!(t&&t.length))return[];var s=la(t);return i==null?s:Tt(s,function(c){return xe(i,n,c)})}var pm=at(function(t,i){return Wt(t)?Zi(t,i):[]}),mm=at(function(t){return Vs(xn(t,Wt))}),vm=at(function(t){var i=He(t);return Wt(i)&&(i=n),Vs(xn(t,Wt),U(i,2))}),ym=at(function(t){var i=He(t);return i=typeof i=="function"?i:n,Vs(xn(t,Wt),n,i)}),bm=at(la);function wm(t,i){return Iu(t||[],i||[],Ki)}function _m(t,i){return Iu(t||[],i||[],ji)}var Sm=at(function(t){var i=t.length,s=i>1?t[i-1]:n;return s=typeof s=="function"?(t.pop(),s):n,cc(t,s)});function hc(t){var i=p(t);return i.__chain__=!0,i}function Em(t,i){return i(t),t}function go(t,i){return i(t)}var Cm=pn(function(t){var i=t.length,s=i?t[0]:0,c=this.__wrapped__,d=function(m){return Ns(m,t)};return i>1||this.__actions__.length||!(c instanceof ut)||!mn(s)?this.thru(d):(c=c.slice(s,+s+(i?1:0)),c.__actions__.push({func:go,args:[d],thisArg:n}),new Be(c,this.__chain__).thru(function(m){return i&&!m.length&&m.push(n),m}))});function xm(){return hc(this)}function Am(){return new Be(this.value(),this.__chain__)}function Tm(){this.__values__===n&&(this.__values__=xc(this.value()));var t=this.__index__>=this.__values__.length,i=t?n:this.__values__[this.__index__++];return{done:t,value:i}}function Im(){return this}function Dm(t){for(var i,s=this;s instanceof Jr;){var c=rc(s);c.__index__=0,c.__values__=n,i?d.__wrapped__=c:i=c;var d=c;s=s.__wrapped__}return d.__wrapped__=t,i}function Pm(){var t=this.__wrapped__;if(t instanceof ut){var i=t;return this.__actions__.length&&(i=new ut(this)),i=i.reverse(),i.__actions__.push({func:go,args:[aa],thisArg:n}),new Be(i,this.__chain__)}return this.thru(aa)}function Mm(){return Tu(this.__wrapped__,this.__actions__)}var Rm=oo(function(t,i,s){wt.call(t,s)?++t[s]:dn(t,s,1)});function Nm(t,i,s){var c=nt(t)?Wl:Eg;return s&&fe(t,i,s)&&(i=n),c(t,U(i,3))}function Om(t,i){var s=nt(t)?xn:cu;return s(t,U(i,3))}var Lm=$u(oc),km=$u(sc);function Fm(t,i){return jt(po(t,i),1)}function $m(t,i){return jt(po(t,i),Mt)}function Bm(t,i,s){return s=s===n?1:it(s),jt(po(t,i),s)}function fc(t,i){var s=nt(t)?Fe:Dn;return s(t,U(i,3))}function dc(t,i){var s=nt(t)?rd:uu;return s(t,U(i,3))}var Wm=oo(function(t,i,s){wt.call(t,s)?t[s].push(i):dn(t,s,[i])});function zm(t,i,s,c){t=ve(t)?t:bi(t),s=s&&!c?it(s):0;var d=t.length;return s<0&&(s=Kt(d+s,0)),wo(t)?s<=d&&t.indexOf(i,s)>-1:!!d&&ai(t,i,s)>-1}var Hm=at(function(t,i,s){var c=-1,d=typeof i=="function",m=ve(t)?A(t.length):[];return Dn(t,function(b){m[++c]=d?xe(i,b,s):Qi(b,i,s)}),m}),qm=oo(function(t,i,s){dn(t,s,i)});function po(t,i){var s=nt(t)?Tt:mu;return s(t,U(i,3))}function Um(t,i,s,c){return t==null?[]:(nt(i)||(i=i==null?[]:[i]),s=c?n:s,nt(s)||(s=s==null?[]:[s]),wu(t,i,s))}var Gm=oo(function(t,i,s){t[s?0:1].push(i)},function(){return[[],[]]});function Vm(t,i,s){var c=nt(t)?ws:Ul,d=arguments.length<3;return c(t,U(i,4),s,d,Dn)}function Xm(t,i,s){var c=nt(t)?od:Ul,d=arguments.length<3;return c(t,U(i,4),s,d,uu)}function Ym(t,i){var s=nt(t)?xn:cu;return s(t,yo(U(i,3)))}function Km(t){var i=nt(t)?ou:zg;return i(t)}function Zm(t,i,s){(s?fe(t,i,s):i===n)?i=1:i=it(i);var c=nt(t)?yg:Hg;return c(t,i)}function Qm(t){var i=nt(t)?bg:Ug;return i(t)}function Jm(t){if(t==null)return 0;if(ve(t))return wo(t)?ui(t):t.length;var i=oe(t);return i==Ge||i==Ve?t.size:Bs(t).length}function jm(t,i,s){var c=nt(t)?_s:Gg;return s&&fe(t,i,s)&&(i=n),c(t,U(i,3))}var tv=at(function(t,i){if(t==null)return[];var s=i.length;return s>1&&fe(t,i[0],i[1])?i=[]:s>2&&fe(i[0],i[1],i[2])&&(i=[i[0]]),wu(t,jt(i,1),[])}),mo=Od||function(){return Jt.Date.now()};function ev(t,i){if(typeof i!="function")throw new $e(u);return t=it(t),function(){if(--t<1)return i.apply(this,arguments)}}function gc(t,i,s){return i=s?n:i,i=t&&i==null?t.length:i,gn(t,bt,n,n,n,n,i)}function pc(t,i){var s;if(typeof i!="function")throw new $e(u);return t=it(t),function(){return--t>0&&(s=i.apply(this,arguments)),t<=1&&(i=n),s}}var ua=at(function(t,i,s){var c=k;if(s.length){var d=Tn(s,vi(ua));c|=gt}return gn(t,c,i,s,d)}),mc=at(function(t,i,s){var c=k|Z;if(s.length){var d=Tn(s,vi(mc));c|=gt}return gn(i,c,t,s,d)});function vc(t,i,s){i=s?n:i;var c=gn(t,H,n,n,n,n,n,i);return c.placeholder=vc.placeholder,c}function yc(t,i,s){i=s?n:i;var c=gn(t,Q,n,n,n,n,n,i);return c.placeholder=yc.placeholder,c}function bc(t,i,s){var c,d,m,b,w,C,D=0,P=!1,M=!1,L=!0;if(typeof t!="function")throw new $e(u);i=qe(i)||0,Rt(s)&&(P=!!s.leading,M="maxWait"in s,m=M?Kt(qe(s.maxWait)||0,i):m,L="trailing"in s?!!s.trailing:L);function z(zt){var Ze=c,bn=d;return c=d=n,D=zt,b=t.apply(bn,Ze),b}function G(zt){return D=zt,w=nr(lt,i),P?z(zt):b}function ot(zt){var Ze=zt-C,bn=zt-D,$c=i-Ze;return M?re($c,m-bn):$c}function V(zt){var Ze=zt-C,bn=zt-D;return C===n||Ze>=i||Ze<0||M&&bn>=m}function lt(){var zt=mo();if(V(zt))return ct(zt);w=nr(lt,ot(zt))}function ct(zt){return w=n,L&&c?z(zt):(c=d=n,b)}function De(){w!==n&&Du(w),D=0,c=C=d=w=n}function de(){return w===n?b:ct(mo())}function Pe(){var zt=mo(),Ze=V(zt);if(c=arguments,d=this,C=zt,Ze){if(w===n)return G(C);if(M)return Du(w),w=nr(lt,i),z(C)}return w===n&&(w=nr(lt,i)),b}return Pe.cancel=De,Pe.flush=de,Pe}var nv=at(function(t,i){return lu(t,1,i)}),iv=at(function(t,i,s){return lu(t,qe(i)||0,s)});function rv(t){return gn(t,ft)}function vo(t,i){if(typeof t!="function"||i!=null&&typeof i!="function")throw new $e(u);var s=function(){var c=arguments,d=i?i.apply(this,c):c[0],m=s.cache;if(m.has(d))return m.get(d);var b=t.apply(this,c);return s.cache=m.set(d,b)||m,b};return s.cache=new(vo.Cache||fn),s}vo.Cache=fn;function yo(t){if(typeof t!="function")throw new $e(u);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}function ov(t){return pc(2,t)}var sv=Vg(function(t,i){i=i.length==1&&nt(i[0])?Tt(i[0],Ae(U())):Tt(jt(i,1),Ae(U()));var s=i.length;return at(function(c){for(var d=-1,m=re(c.length,s);++d<m;)c[d]=i[d].call(this,c[d]);return xe(t,this,c)})}),ca=at(function(t,i){var s=Tn(i,vi(ca));return gn(t,gt,n,i,s)}),wc=at(function(t,i){var s=Tn(i,vi(wc));return gn(t,ht,n,i,s)}),av=pn(function(t,i){return gn(t,$t,n,n,n,i)});function lv(t,i){if(typeof t!="function")throw new $e(u);return i=i===n?i:it(i),at(t,i)}function uv(t,i){if(typeof t!="function")throw new $e(u);return i=i==null?0:Kt(it(i),0),at(function(s){var c=s[i],d=Rn(s,0,i);return c&&An(d,c),xe(t,this,d)})}function cv(t,i,s){var c=!0,d=!0;if(typeof t!="function")throw new $e(u);return Rt(s)&&(c="leading"in s?!!s.leading:c,d="trailing"in s?!!s.trailing:d),bc(t,i,{leading:c,maxWait:i,trailing:d})}function hv(t){return gc(t,1)}function fv(t,i){return ca(Ys(i),t)}function dv(){if(!arguments.length)return[];var t=arguments[0];return nt(t)?t:[t]}function gv(t){return We(t,x)}function pv(t,i){return i=typeof i=="function"?i:n,We(t,x,i)}function mv(t){return We(t,y|x)}function vv(t,i){return i=typeof i=="function"?i:n,We(t,y|x,i)}function yv(t,i){return i==null||au(t,i,Qt(i))}function Ke(t,i){return t===i||t!==t&&i!==i}var bv=uo(ks),wv=uo(function(t,i){return t>=i}),Yn=du(function(){return arguments}())?du:function(t){return Lt(t)&&wt.call(t,"callee")&&!jl.call(t,"callee")},nt=A.isArray,_v=Ol?Ae(Ol):Dg;function ve(t){return t!=null&&bo(t.length)&&!vn(t)}function Wt(t){return Lt(t)&&ve(t)}function Sv(t){return t===!0||t===!1||Lt(t)&&he(t)==ki}var Nn=kd||_a,Ev=Ll?Ae(Ll):Pg;function Cv(t){return Lt(t)&&t.nodeType===1&&!ir(t)}function xv(t){if(t==null)return!0;if(ve(t)&&(nt(t)||typeof t=="string"||typeof t.splice=="function"||Nn(t)||yi(t)||Yn(t)))return!t.length;var i=oe(t);if(i==Ge||i==Ve)return!t.size;if(er(t))return!Bs(t).length;for(var s in t)if(wt.call(t,s))return!1;return!0}function Av(t,i){return Ji(t,i)}function Tv(t,i,s){s=typeof s=="function"?s:n;var c=s?s(t,i):n;return c===n?Ji(t,i,n,s):!!c}function ha(t){if(!Lt(t))return!1;var i=he(t);return i==Pr||i==Kh||typeof t.message=="string"&&typeof t.name=="string"&&!ir(t)}function Iv(t){return typeof t=="number"&&eu(t)}function vn(t){if(!Rt(t))return!1;var i=he(t);return i==Mr||i==ll||i==Yh||i==Qh}function _c(t){return typeof t=="number"&&t==it(t)}function bo(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Zt}function Rt(t){var i=typeof t;return t!=null&&(i=="object"||i=="function")}function Lt(t){return t!=null&&typeof t=="object"}var Sc=kl?Ae(kl):Rg;function Dv(t,i){return t===i||$s(t,i,ea(i))}function Pv(t,i,s){return s=typeof s=="function"?s:n,$s(t,i,ea(i),s)}function Mv(t){return Ec(t)&&t!=+t}function Rv(t){if(pp(t))throw new J(l);return gu(t)}function Nv(t){return t===null}function Ov(t){return t==null}function Ec(t){return typeof t=="number"||Lt(t)&&he(t)==$i}function ir(t){if(!Lt(t)||he(t)!=cn)return!1;var i=Gr(t);if(i===null)return!0;var s=wt.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&zr.call(s)==Pd}var fa=Fl?Ae(Fl):Ng;function Lv(t){return _c(t)&&t>=-9007199254740991&&t<=Zt}var Cc=$l?Ae($l):Og;function wo(t){return typeof t=="string"||!nt(t)&&Lt(t)&&he(t)==Wi}function Ie(t){return typeof t=="symbol"||Lt(t)&&he(t)==Rr}var yi=Bl?Ae(Bl):Lg;function kv(t){return t===n}function Fv(t){return Lt(t)&&oe(t)==zi}function $v(t){return Lt(t)&&he(t)==jh}var Bv=uo(Ws),Wv=uo(function(t,i){return t<=i});function xc(t){if(!t)return[];if(ve(t))return wo(t)?Xe(t):me(t);if(Ui&&t[Ui])return yd(t[Ui]());var i=oe(t),s=i==Ge?Ts:i==Ve?$r:bi;return s(t)}function yn(t){if(!t)return t===0?t:0;if(t=qe(t),t===Mt||t===-1/0){var i=t<0?-1:1;return i*Oi}return t===t?t:0}function it(t){var i=yn(t),s=i%1;return i===i?s?i-s:i:0}function Ac(t){return t?Un(it(t),0,ie):0}function qe(t){if(typeof t=="number")return t;if(Ie(t))return ii;if(Rt(t)){var i=typeof t.valueOf=="function"?t.valueOf():t;t=Rt(i)?i+"":i}if(typeof t!="string")return t===0?t:+t;t=Gl(t);var s=_f.test(t);return s||Ef.test(t)?ed(t.slice(2),s?2:8):wf.test(t)?ii:+t}function Tc(t){return rn(t,ye(t))}function zv(t){return t?Un(it(t),-9007199254740991,Zt):t===0?t:0}function yt(t){return t==null?"":Te(t)}var Hv=pi(function(t,i){if(er(i)||ve(i)){rn(i,Qt(i),t);return}for(var s in i)wt.call(i,s)&&Ki(t,s,i[s])}),Ic=pi(function(t,i){rn(i,ye(i),t)}),_o=pi(function(t,i,s,c){rn(i,ye(i),t,c)}),qv=pi(function(t,i,s,c){rn(i,Qt(i),t,c)}),Uv=pn(Ns);function Gv(t,i){var s=gi(t);return i==null?s:su(s,i)}var Vv=at(function(t,i){t=_t(t);var s=-1,c=i.length,d=c>2?i[2]:n;for(d&&fe(i[0],i[1],d)&&(c=1);++s<c;)for(var m=i[s],b=ye(m),w=-1,C=b.length;++w<C;){var D=b[w],P=t[D];(P===n||Ke(P,hi[D])&&!wt.call(t,D))&&(t[D]=m[D])}return t}),Xv=at(function(t){return t.push(n,Gu),xe(Dc,n,t)});function Yv(t,i){return zl(t,U(i,3),nn)}function Kv(t,i){return zl(t,U(i,3),Ls)}function Zv(t,i){return t==null?t:Os(t,U(i,3),ye)}function Qv(t,i){return t==null?t:hu(t,U(i,3),ye)}function Jv(t,i){return t&&nn(t,U(i,3))}function jv(t,i){return t&&Ls(t,U(i,3))}function ty(t){return t==null?[]:eo(t,Qt(t))}function ey(t){return t==null?[]:eo(t,ye(t))}function da(t,i,s){var c=t==null?n:Gn(t,i);return c===n?s:c}function ny(t,i){return t!=null&&Yu(t,i,xg)}function ga(t,i){return t!=null&&Yu(t,i,Ag)}var iy=Wu(function(t,i,s){i!=null&&typeof i.toString!="function"&&(i=Hr.call(i)),t[i]=s},ma(be)),ry=Wu(function(t,i,s){i!=null&&typeof i.toString!="function"&&(i=Hr.call(i)),wt.call(t,i)?t[i].push(s):t[i]=[s]},U),oy=at(Qi);function Qt(t){return ve(t)?ru(t):Bs(t)}function ye(t){return ve(t)?ru(t,!0):kg(t)}function sy(t,i){var s={};return i=U(i,3),nn(t,function(c,d,m){dn(s,i(c,d,m),c)}),s}function ay(t,i){var s={};return i=U(i,3),nn(t,function(c,d,m){dn(s,d,i(c,d,m))}),s}var ly=pi(function(t,i,s){no(t,i,s)}),Dc=pi(function(t,i,s,c){no(t,i,s,c)}),uy=pn(function(t,i){var s={};if(t==null)return s;var c=!1;i=Tt(i,function(m){return m=Mn(m,t),c||(c=m.length>1),m}),rn(t,js(t),s),c&&(s=We(s,y|S|x,ip));for(var d=i.length;d--;)Gs(s,i[d]);return s});function cy(t,i){return Pc(t,yo(U(i)))}var hy=pn(function(t,i){return t==null?{}:$g(t,i)});function Pc(t,i){if(t==null)return{};var s=Tt(js(t),function(c){return[c]});return i=U(i),_u(t,s,function(c,d){return i(c,d[0])})}function fy(t,i,s){i=Mn(i,t);var c=-1,d=i.length;for(d||(d=1,t=n);++c<d;){var m=t==null?n:t[on(i[c])];m===n&&(c=d,m=s),t=vn(m)?m.call(t):m}return t}function dy(t,i,s){return t==null?t:ji(t,i,s)}function gy(t,i,s,c){return c=typeof c=="function"?c:n,t==null?t:ji(t,i,s,c)}var Mc=qu(Qt),Rc=qu(ye);function py(t,i,s){var c=nt(t),d=c||Nn(t)||yi(t);if(i=U(i,4),s==null){var m=t&&t.constructor;d?s=c?new m:[]:Rt(t)?s=vn(m)?gi(Gr(t)):{}:s={}}return(d?Fe:nn)(t,function(b,w,C){return i(s,b,w,C)}),s}function my(t,i){return t==null?!0:Gs(t,i)}function vy(t,i,s){return t==null?t:Au(t,i,Ys(s))}function yy(t,i,s,c){return c=typeof c=="function"?c:n,t==null?t:Au(t,i,Ys(s),c)}function bi(t){return t==null?[]:As(t,Qt(t))}function by(t){return t==null?[]:As(t,ye(t))}function wy(t,i,s){return s===n&&(s=i,i=n),s!==n&&(s=qe(s),s=s===s?s:0),i!==n&&(i=qe(i),i=i===i?i:0),Un(qe(t),i,s)}function _y(t,i,s){return i=yn(i),s===n?(s=i,i=0):s=yn(s),t=qe(t),Tg(t,i,s)}function Sy(t,i,s){if(s&&typeof s!="boolean"&&fe(t,i,s)&&(i=s=n),s===n&&(typeof i=="boolean"?(s=i,i=n):typeof t=="boolean"&&(s=t,t=n)),t===n&&i===n?(t=0,i=1):(t=yn(t),i===n?(i=t,t=0):i=yn(i)),t>i){var c=t;t=i,i=c}if(s||t%1||i%1){var d=nu();return re(t+d*(i-t+td("1e-"+((d+"").length-1))),i)}return Hs(t,i)}var Ey=mi(function(t,i,s){return i=i.toLowerCase(),t+(s?Nc(i):i)});function Nc(t){return pa(yt(t).toLowerCase())}function Oc(t){return t=yt(t),t&&t.replace(xf,dd).replace(Uf,"")}function Cy(t,i,s){t=yt(t),i=Te(i);var c=t.length;s=s===n?c:Un(it(s),0,c);var d=s;return s-=i.length,s>=0&&t.slice(s,d)==i}function xy(t){return t=yt(t),t&&of.test(t)?t.replace(hl,gd):t}function Ay(t){return t=yt(t),t&&hf.test(t)?t.replace(cs,"\\$&"):t}var Ty=mi(function(t,i,s){return t+(s?"-":"")+i.toLowerCase()}),Iy=mi(function(t,i,s){return t+(s?" ":"")+i.toLowerCase()}),Dy=Fu("toLowerCase");function Py(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;if(!i||c>=i)return t;var d=(i-c)/2;return lo(Kr(d),s)+t+lo(Yr(d),s)}function My(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;return i&&c<i?t+lo(i-c,s):t}function Ry(t,i,s){t=yt(t),i=it(i);var c=i?ui(t):0;return i&&c<i?lo(i-c,s)+t:t}function Ny(t,i,s){return s||i==null?i=0:i&&(i=+i),Wd(yt(t).replace(hs,""),i||0)}function Oy(t,i,s){return(s?fe(t,i,s):i===n)?i=1:i=it(i),qs(yt(t),i)}function Ly(){var t=arguments,i=yt(t[0]);return t.length<3?i:i.replace(t[1],t[2])}var ky=mi(function(t,i,s){return t+(s?"_":"")+i.toLowerCase()});function Fy(t,i,s){return s&&typeof s!="number"&&fe(t,i,s)&&(i=s=n),s=s===n?ie:s>>>0,s?(t=yt(t),t&&(typeof i=="string"||i!=null&&!fa(i))&&(i=Te(i),!i&&li(t))?Rn(Xe(t),0,s):t.split(i,s)):[]}var $y=mi(function(t,i,s){return t+(s?" ":"")+pa(i)});function By(t,i,s){return t=yt(t),s=s==null?0:Un(it(s),0,t.length),i=Te(i),t.slice(s,s+i.length)==i}function Wy(t,i,s){var c=p.templateSettings;s&&fe(t,i,s)&&(i=n),t=yt(t),i=_o({},i,c,Uu);var d=_o({},i.imports,c.imports,Uu),m=Qt(d),b=As(d,m),w,C,D=0,P=i.interpolate||Nr,M="__p += '",L=Is((i.escape||Nr).source+"|"+P.source+"|"+(P===fl?bf:Nr).source+"|"+(i.evaluate||Nr).source+"|$","g"),z="//# sourceURL="+(wt.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Kf+"]")+`
`;t.replace(L,function(V,lt,ct,De,de,Pe){return ct||(ct=De),M+=t.slice(D,Pe).replace(Af,pd),lt&&(w=!0,M+=`' +
__e(`+lt+`) +
'`),de&&(C=!0,M+=`';
`+de+`;
__p += '`),ct&&(M+=`' +
((__t = (`+ct+`)) == null ? '' : __t) +
'`),D=Pe+V.length,V}),M+=`';
`;var G=wt.call(i,"variable")&&i.variable;if(!G)M=`with (obj) {
`+M+`
}
`;else if(vf.test(G))throw new J(h);M=(C?M.replace(tf,""):M).replace(ef,"$1").replace(nf,"$1;"),M="function("+(G||"obj")+`) {
`+(G?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var ot=kc(function(){return pt(m,z+"return "+M).apply(n,b)});if(ot.source=M,ha(ot))throw ot;return ot}function zy(t){return yt(t).toLowerCase()}function Hy(t){return yt(t).toUpperCase()}function qy(t,i,s){if(t=yt(t),t&&(s||i===n))return Gl(t);if(!t||!(i=Te(i)))return t;var c=Xe(t),d=Xe(i),m=Vl(c,d),b=Xl(c,d)+1;return Rn(c,m,b).join("")}function Uy(t,i,s){if(t=yt(t),t&&(s||i===n))return t.slice(0,Kl(t)+1);if(!t||!(i=Te(i)))return t;var c=Xe(t),d=Xl(c,Xe(i))+1;return Rn(c,0,d).join("")}function Gy(t,i,s){if(t=yt(t),t&&(s||i===n))return t.replace(hs,"");if(!t||!(i=Te(i)))return t;var c=Xe(t),d=Vl(c,Xe(i));return Rn(c,d).join("")}function Vy(t,i){var s=le,c=Bt;if(Rt(i)){var d="separator"in i?i.separator:d;s="length"in i?it(i.length):s,c="omission"in i?Te(i.omission):c}t=yt(t);var m=t.length;if(li(t)){var b=Xe(t);m=b.length}if(s>=m)return t;var w=s-ui(c);if(w<1)return c;var C=b?Rn(b,0,w).join(""):t.slice(0,w);if(d===n)return C+c;if(b&&(w+=C.length-w),fa(d)){if(t.slice(w).search(d)){var D,P=C;for(d.global||(d=Is(d.source,yt(dl.exec(d))+"g")),d.lastIndex=0;D=d.exec(P);)var M=D.index;C=C.slice(0,M===n?w:M)}}else if(t.indexOf(Te(d),w)!=w){var L=C.lastIndexOf(d);L>-1&&(C=C.slice(0,L))}return C+c}function Xy(t){return t=yt(t),t&&rf.test(t)?t.replace(cl,Sd):t}var Yy=mi(function(t,i,s){return t+(s?" ":"")+i.toUpperCase()}),pa=Fu("toUpperCase");function Lc(t,i,s){return t=yt(t),i=s?n:i,i===n?vd(t)?xd(t):ld(t):t.match(i)||[]}var kc=at(function(t,i){try{return xe(t,n,i)}catch(s){return ha(s)?s:new J(s)}}),Ky=pn(function(t,i){return Fe(i,function(s){s=on(s),dn(t,s,ua(t[s],t))}),t});function Zy(t){var i=t==null?0:t.length,s=U();return t=i?Tt(t,function(c){if(typeof c[1]!="function")throw new $e(u);return[s(c[0]),c[1]]}):[],at(function(c){for(var d=-1;++d<i;){var m=t[d];if(xe(m[0],this,c))return xe(m[1],this,c)}})}function Qy(t){return Sg(We(t,y))}function ma(t){return function(){return t}}function Jy(t,i){return t==null||t!==t?i:t}var jy=Bu(),tb=Bu(!0);function be(t){return t}function va(t){return pu(typeof t=="function"?t:We(t,y))}function eb(t){return vu(We(t,y))}function nb(t,i){return yu(t,We(i,y))}var ib=at(function(t,i){return function(s){return Qi(s,t,i)}}),rb=at(function(t,i){return function(s){return Qi(t,s,i)}});function ya(t,i,s){var c=Qt(i),d=eo(i,c);s==null&&!(Rt(i)&&(d.length||!c.length))&&(s=i,i=t,t=this,d=eo(i,Qt(i)));var m=!(Rt(s)&&"chain"in s)||!!s.chain,b=vn(t);return Fe(d,function(w){var C=i[w];t[w]=C,b&&(t.prototype[w]=function(){var D=this.__chain__;if(m||D){var P=t(this.__wrapped__),M=P.__actions__=me(this.__actions__);return M.push({func:C,args:arguments,thisArg:t}),P.__chain__=D,P}return C.apply(t,An([this.value()],arguments))})}),t}function ob(){return Jt._===this&&(Jt._=Md),this}function ba(){}function sb(t){return t=it(t),at(function(i){return bu(i,t)})}var ab=Zs(Tt),lb=Zs(Wl),ub=Zs(_s);function Fc(t){return ia(t)?Ss(on(t)):Bg(t)}function cb(t){return function(i){return t==null?n:Gn(t,i)}}var hb=zu(),fb=zu(!0);function wa(){return[]}function _a(){return!1}function db(){return{}}function gb(){return""}function pb(){return!0}function mb(t,i){if(t=it(t),t<1||t>Zt)return[];var s=ie,c=re(t,ie);i=U(i),t-=ie;for(var d=xs(c,i);++s<t;)i(s);return d}function vb(t){return nt(t)?Tt(t,on):Ie(t)?[t]:me(ic(yt(t)))}function yb(t){var i=++Dd;return yt(t)+i}var bb=ao(function(t,i){return t+i},0),wb=Qs("ceil"),_b=ao(function(t,i){return t/i},1),Sb=Qs("floor");function Eb(t){return t&&t.length?to(t,be,ks):n}function Cb(t,i){return t&&t.length?to(t,U(i,2),ks):n}function xb(t){return ql(t,be)}function Ab(t,i){return ql(t,U(i,2))}function Tb(t){return t&&t.length?to(t,be,Ws):n}function Ib(t,i){return t&&t.length?to(t,U(i,2),Ws):n}var Db=ao(function(t,i){return t*i},1),Pb=Qs("round"),Mb=ao(function(t,i){return t-i},0);function Rb(t){return t&&t.length?Cs(t,be):0}function Nb(t,i){return t&&t.length?Cs(t,U(i,2)):0}return p.after=ev,p.ary=gc,p.assign=Hv,p.assignIn=Ic,p.assignInWith=_o,p.assignWith=qv,p.at=Uv,p.before=pc,p.bind=ua,p.bindAll=Ky,p.bindKey=mc,p.castArray=dv,p.chain=hc,p.chunk=Sp,p.compact=Ep,p.concat=Cp,p.cond=Zy,p.conforms=Qy,p.constant=ma,p.countBy=Rm,p.create=Gv,p.curry=vc,p.curryRight=yc,p.debounce=bc,p.defaults=Vv,p.defaultsDeep=Xv,p.defer=nv,p.delay=iv,p.difference=xp,p.differenceBy=Ap,p.differenceWith=Tp,p.drop=Ip,p.dropRight=Dp,p.dropRightWhile=Pp,p.dropWhile=Mp,p.fill=Rp,p.filter=Om,p.flatMap=Fm,p.flatMapDeep=$m,p.flatMapDepth=Bm,p.flatten=ac,p.flattenDeep=Np,p.flattenDepth=Op,p.flip=rv,p.flow=jy,p.flowRight=tb,p.fromPairs=Lp,p.functions=ty,p.functionsIn=ey,p.groupBy=Wm,p.initial=Fp,p.intersection=$p,p.intersectionBy=Bp,p.intersectionWith=Wp,p.invert=iy,p.invertBy=ry,p.invokeMap=Hm,p.iteratee=va,p.keyBy=qm,p.keys=Qt,p.keysIn=ye,p.map=po,p.mapKeys=sy,p.mapValues=ay,p.matches=eb,p.matchesProperty=nb,p.memoize=vo,p.merge=ly,p.mergeWith=Dc,p.method=ib,p.methodOf=rb,p.mixin=ya,p.negate=yo,p.nthArg=sb,p.omit=uy,p.omitBy=cy,p.once=ov,p.orderBy=Um,p.over=ab,p.overArgs=sv,p.overEvery=lb,p.overSome=ub,p.partial=ca,p.partialRight=wc,p.partition=Gm,p.pick=hy,p.pickBy=Pc,p.property=Fc,p.propertyOf=cb,p.pull=Up,p.pullAll=uc,p.pullAllBy=Gp,p.pullAllWith=Vp,p.pullAt=Xp,p.range=hb,p.rangeRight=fb,p.rearg=av,p.reject=Ym,p.remove=Yp,p.rest=lv,p.reverse=aa,p.sampleSize=Zm,p.set=dy,p.setWith=gy,p.shuffle=Qm,p.slice=Kp,p.sortBy=tv,p.sortedUniq=nm,p.sortedUniqBy=im,p.split=Fy,p.spread=uv,p.tail=rm,p.take=om,p.takeRight=sm,p.takeRightWhile=am,p.takeWhile=lm,p.tap=Em,p.throttle=cv,p.thru=go,p.toArray=xc,p.toPairs=Mc,p.toPairsIn=Rc,p.toPath=vb,p.toPlainObject=Tc,p.transform=py,p.unary=hv,p.union=um,p.unionBy=cm,p.unionWith=hm,p.uniq=fm,p.uniqBy=dm,p.uniqWith=gm,p.unset=my,p.unzip=la,p.unzipWith=cc,p.update=vy,p.updateWith=yy,p.values=bi,p.valuesIn=by,p.without=pm,p.words=Lc,p.wrap=fv,p.xor=mm,p.xorBy=vm,p.xorWith=ym,p.zip=bm,p.zipObject=wm,p.zipObjectDeep=_m,p.zipWith=Sm,p.entries=Mc,p.entriesIn=Rc,p.extend=Ic,p.extendWith=_o,ya(p,p),p.add=bb,p.attempt=kc,p.camelCase=Ey,p.capitalize=Nc,p.ceil=wb,p.clamp=wy,p.clone=gv,p.cloneDeep=mv,p.cloneDeepWith=vv,p.cloneWith=pv,p.conformsTo=yv,p.deburr=Oc,p.defaultTo=Jy,p.divide=_b,p.endsWith=Cy,p.eq=Ke,p.escape=xy,p.escapeRegExp=Ay,p.every=Nm,p.find=Lm,p.findIndex=oc,p.findKey=Yv,p.findLast=km,p.findLastIndex=sc,p.findLastKey=Kv,p.floor=Sb,p.forEach=fc,p.forEachRight=dc,p.forIn=Zv,p.forInRight=Qv,p.forOwn=Jv,p.forOwnRight=jv,p.get=da,p.gt=bv,p.gte=wv,p.has=ny,p.hasIn=ga,p.head=lc,p.identity=be,p.includes=zm,p.indexOf=kp,p.inRange=_y,p.invoke=oy,p.isArguments=Yn,p.isArray=nt,p.isArrayBuffer=_v,p.isArrayLike=ve,p.isArrayLikeObject=Wt,p.isBoolean=Sv,p.isBuffer=Nn,p.isDate=Ev,p.isElement=Cv,p.isEmpty=xv,p.isEqual=Av,p.isEqualWith=Tv,p.isError=ha,p.isFinite=Iv,p.isFunction=vn,p.isInteger=_c,p.isLength=bo,p.isMap=Sc,p.isMatch=Dv,p.isMatchWith=Pv,p.isNaN=Mv,p.isNative=Rv,p.isNil=Ov,p.isNull=Nv,p.isNumber=Ec,p.isObject=Rt,p.isObjectLike=Lt,p.isPlainObject=ir,p.isRegExp=fa,p.isSafeInteger=Lv,p.isSet=Cc,p.isString=wo,p.isSymbol=Ie,p.isTypedArray=yi,p.isUndefined=kv,p.isWeakMap=Fv,p.isWeakSet=$v,p.join=zp,p.kebabCase=Ty,p.last=He,p.lastIndexOf=Hp,p.lowerCase=Iy,p.lowerFirst=Dy,p.lt=Bv,p.lte=Wv,p.max=Eb,p.maxBy=Cb,p.mean=xb,p.meanBy=Ab,p.min=Tb,p.minBy=Ib,p.stubArray=wa,p.stubFalse=_a,p.stubObject=db,p.stubString=gb,p.stubTrue=pb,p.multiply=Db,p.nth=qp,p.noConflict=ob,p.noop=ba,p.now=mo,p.pad=Py,p.padEnd=My,p.padStart=Ry,p.parseInt=Ny,p.random=Sy,p.reduce=Vm,p.reduceRight=Xm,p.repeat=Oy,p.replace=Ly,p.result=fy,p.round=Pb,p.runInContext=E,p.sample=Km,p.size=Jm,p.snakeCase=ky,p.some=jm,p.sortedIndex=Zp,p.sortedIndexBy=Qp,p.sortedIndexOf=Jp,p.sortedLastIndex=jp,p.sortedLastIndexBy=tm,p.sortedLastIndexOf=em,p.startCase=$y,p.startsWith=By,p.subtract=Mb,p.sum=Rb,p.sumBy=Nb,p.template=Wy,p.times=mb,p.toFinite=yn,p.toInteger=it,p.toLength=Ac,p.toLower=zy,p.toNumber=qe,p.toSafeInteger=zv,p.toString=yt,p.toUpper=Hy,p.trim=qy,p.trimEnd=Uy,p.trimStart=Gy,p.truncate=Vy,p.unescape=Xy,p.uniqueId=yb,p.upperCase=Yy,p.upperFirst=pa,p.each=fc,p.eachRight=dc,p.first=lc,ya(p,function(){var t={};return nn(p,function(i,s){wt.call(p.prototype,s)||(t[s]=i)}),t}(),{chain:!1}),p.VERSION=o,Fe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){p[t].placeholder=p}),Fe(["drop","take"],function(t,i){ut.prototype[t]=function(s){s=s===n?1:Kt(it(s),0);var c=this.__filtered__&&!i?new ut(this):this.clone();return c.__filtered__?c.__takeCount__=re(s,c.__takeCount__):c.__views__.push({size:re(s,ie),type:t+(c.__dir__<0?"Right":"")}),c},ut.prototype[t+"Right"]=function(s){return this.reverse()[t](s).reverse()}}),Fe(["filter","map","takeWhile"],function(t,i){var s=i+1,c=s==Ht||s==Ct;ut.prototype[t]=function(d){var m=this.clone();return m.__iteratees__.push({iteratee:U(d,3),type:s}),m.__filtered__=m.__filtered__||c,m}}),Fe(["head","last"],function(t,i){var s="take"+(i?"Right":"");ut.prototype[t]=function(){return this[s](1).value()[0]}}),Fe(["initial","tail"],function(t,i){var s="drop"+(i?"":"Right");ut.prototype[t]=function(){return this.__filtered__?new ut(this):this[s](1)}}),ut.prototype.compact=function(){return this.filter(be)},ut.prototype.find=function(t){return this.filter(t).head()},ut.prototype.findLast=function(t){return this.reverse().find(t)},ut.prototype.invokeMap=at(function(t,i){return typeof t=="function"?new ut(this):this.map(function(s){return Qi(s,t,i)})}),ut.prototype.reject=function(t){return this.filter(yo(U(t)))},ut.prototype.slice=function(t,i){t=it(t);var s=this;return s.__filtered__&&(t>0||i<0)?new ut(s):(t<0?s=s.takeRight(-t):t&&(s=s.drop(t)),i!==n&&(i=it(i),s=i<0?s.dropRight(-i):s.take(i-t)),s)},ut.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},ut.prototype.toArray=function(){return this.take(ie)},nn(ut.prototype,function(t,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),d=p[c?"take"+(i=="last"?"Right":""):i],m=c||/^find/.test(i);d&&(p.prototype[i]=function(){var b=this.__wrapped__,w=c?[1]:arguments,C=b instanceof ut,D=w[0],P=C||nt(b),M=function(lt){var ct=d.apply(p,An([lt],w));return c&&L?ct[0]:ct};P&&s&&typeof D=="function"&&D.length!=1&&(C=P=!1);var L=this.__chain__,z=!!this.__actions__.length,G=m&&!L,ot=C&&!z;if(!m&&P){b=ot?b:new ut(this);var V=t.apply(b,w);return V.__actions__.push({func:go,args:[M],thisArg:n}),new Be(V,L)}return G&&ot?t.apply(this,w):(V=this.thru(M),G?c?V.value()[0]:V.value():V)})}),Fe(["pop","push","shift","sort","splice","unshift"],function(t){var i=Br[t],s=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",c=/^(?:pop|shift)$/.test(t);p.prototype[t]=function(){var d=arguments;if(c&&!this.__chain__){var m=this.value();return i.apply(nt(m)?m:[],d)}return this[s](function(b){return i.apply(nt(b)?b:[],d)})}}),nn(ut.prototype,function(t,i){var s=p[i];if(s){var c=s.name+"";wt.call(di,c)||(di[c]=[]),di[c].push({name:i,func:s})}}),di[so(n,Z).name]=[{name:"wrapper",func:n}],ut.prototype.clone=Xd,ut.prototype.reverse=Yd,ut.prototype.value=Kd,p.prototype.at=Cm,p.prototype.chain=xm,p.prototype.commit=Am,p.prototype.next=Tm,p.prototype.plant=Dm,p.prototype.reverse=Pm,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Mm,p.prototype.first=p.prototype.head,Ui&&(p.prototype[Ui]=Im),p},ci=Ad();Wn?((Wn.exports=ci)._=ci,vs._=ci):Jt._=ci}).call(_w)}(gr,gr.exports)),gr.exports}var Ee=Sw();const Ew=()=>({stage:null,layer:null,selectionTransformer:null,stageInitiated:!1,activePanel:null,layersSearchString:"",layersSortable:null,selectedGroupChildNodes:[],selectionColors:{fill:"hsla(205,90%,48%,0.15)",stroke:"hsl(205,90%,48%)"},aiTasksQueue:[],activeTool:null,activeFillTab:"color",editingTextNode:null,editingTextarea:null,container:null,konvajsContent:null,containerDimensions:{x:0,y:0,width:0,height:0},konvajsContentDimensions:{x:0,y:0,width:0,height:0},selectedFont:"",fontsSearchString:"",lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],adaptiveResize:!0,prevStageWidth:null,prevStageHeight:null,busy:!1,zoomOffsetX:0,zoomOffsetY:0,zoomLevel:100,isSpacePressed:!1,isPanning:!1,reachedMinZoom:!1,reachedMaxZoom:!1,activeTooltipDropdown:null,guidelineOffset:5,placeholderImage:"https://placehold.co/600x400@2x?text=MagicAI",templatesList:[],loadingTemplatesFailed:!1,history:[],historyPointer:-1,maxHistoryLength:30,historyListeners:["fill","fillLinearGradientStartPoint","fillLinearGradientStartPointX","fillLinearGradientStartPointY","fillLinearGradientEndPoint","fillLinearGradientEndPointX","fillLinearGradientEndPointY","fillLinearGradientColorStops","fillRadialGradientStartPoint","fillRadialGradientStartPointX","fillRadialGradientStartPointY","fillRadialGradientEndPoint","fillRadialGradientEndPointX","fillRadialGradientEndPointY","fillRadialGradientStartRadius","fillRadialGradientEndRadius","fillRadialGradientColorStops","stroke","strokeWidth","lineJoin","lineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","dash","x","y","width","height","opacity","scale","scaleX","scaleY","rotation","offset","offsetX","offsetY","fontFamily","fontSize","fontStyle","fontVariant","textDecoration","text","align","verticalAlign","padding","lineHeight","wrap","ellipsis","image","crop","blurRadius","skew","skewX","skewY","sides","numPoints","innerRadius","outerRadius","angle"],get creativeSuite(){return this.$data},get nodes(){var r;return((r=this.layer)==null?void 0:r.getChildren(e=>{const n=e.name(),o=e.getType();return e.id(),(o==="Shape"||o==="Group")&&!["lqd-cs-guide-line","lqd-cs-highlighter","lqd-cs-selection-transformer","lqd-cs-selection-rectangle"].includes(n)}))??[]},get selectedNodes(){var r;return((r=this.selectionTransformer)==null?void 0:r.nodes())??[]},set selectedNodes(r={nodes:[],ids:[],event:{}}){let e=r.nodes||[],n=r.ids||[],o=r.event||{},a=o.metaKey||o.ctrlKey,l=o.shiftKey;if(n.length&&!e.length&&(e=this.nodes.filter(u=>n.includes(u.id()))),e==="all"&&(e=this.nodes),l){let u=[...this.selectedNodes];e.forEach(h=>{const f=u.findIndex(g=>g.id()===h.id());f!==-1?u.splice(f,1):u.push(h)}),e=u.filter(h=>!h.findAncestors("Group").some(v=>v.getChildren(y=>y.id()===h.id())))}a||e.forEach(u=>{const h=u.findAncestors("Group"),f=h.length;h.forEach((g,v)=>{f>1&&v===0||!e.find(y=>y.id()===g.id())&&!this.selectedGroupChildNodes.find(y=>y.id()===u.id())&&(e.push(g),e=e.filter(y=>y.id()!==u.id()))})}),this.selectedGroupChildNodes.forEach(u=>{const f=u.findAncestors("Group").some(y=>e.some(S=>S.id()===y.id())),v=e.filter(y=>y.getClassName()==="Group").find(y=>y.findOne(`#${u.id()}`));(!e.find(y=>y.id()===u.id())||f||v)&&(u.draggable(!1),this.selectedGroupChildNodes=this.selectedGroupChildNodes.filter(y=>y.id()!==u.id()))}),e=e.filter(u=>!u.getAttr("locked")),this.selectionTransformer.nodes(e),this.selectionTransformer.zIndex(this.nodes.length+1),this.$dispatch("nodes-selected",{nodes:this.selectedNodes,nodesCount:this.selectedNodes.length,selectedNodesRect:this.selectedNodesRect})},get selectedNodesRect(){return this.selectedNodes.length?this.selectionTransformer.getClientRect():{x:0,y:0}},get selectedNodesProps(){const r=this.selectedNodes;if(!r.length)return{};const e=r[0],n=r.find(S=>S.getClassName()==="Rect"),o=r.find(S=>S.getClassName()==="Image"),a=r.find(S=>S.getClassName()==="RegularPolygon"),l=r.find(S=>S.getClassName()==="Star"),u=r.find(S=>S.getClassName()==="Ring"),h=r.find(S=>S.getClassName()==="Arc"),f=r.find(S=>S.getClassName()==="Wedge"),g=r.find(S=>S.getClassName()==="Text"),v=r.find(S=>S.getClassName()==="TextPath"),y={x:e.x(),y:e.y(),rotation:e.rotation(),width:e.width(),height:e.height(),opacity:e.opacity(),fill:e.fill(),fillPatternX:e.fillPatternX()??0,fillPatternY:e.fillPatternY()??0,fillPatternScaleX:e.fillPatternScaleX()??0,fillPatternScaleY:e.fillPatternScaleY()??0,fillPatternRepeat:e.fillPatternRepeat(),cornerRadius:((n==null?void 0:n.cornerRadius())||(o==null?void 0:o.cornerRadius()))??0,sides:(a==null?void 0:a.sides())??0,numPoints:(l==null?void 0:l.numPoints())??0,innerRadius:((l==null?void 0:l.innerRadius())||(u==null?void 0:u.innerRadius())||(h==null?void 0:h.innerRadius()))??0,outerRadius:((l==null?void 0:l.outerRadius())||(u==null?void 0:u.outerRadius())||(h==null?void 0:h.outerRadius()))??0,angle:((h==null?void 0:h.angle())||(f==null?void 0:f.angle()))??0,fontFamily:((g==null?void 0:g.fontFamily())||(v==null?void 0:v.fontFamily()))??"",fontSize:((g==null?void 0:g.fontSize())||(v==null?void 0:v.fontSize()))??0,fontStyle:((g==null?void 0:g.fontStyle())||(v==null?void 0:v.fontStyle()))??"normal 400",textDecoration:((g==null?void 0:g.textDecoration())||(v==null?void 0:v.textDecoration()))??"",lineHeight:g==null?void 0:g.lineHeight(),letterSpacing:((g==null?void 0:g.letterSpacing())||(v==null?void 0:v.letterSpacing()))??0,align:((g==null?void 0:g.align())||(v==null?void 0:v.align()))??"",stroke:e.stroke()??"",strokeWidth:e.strokeWidth()??0,dash:e.dash()??0,blurRadius:e.blurRadius()??null,skewX:e.skewX()??null,skewY:e.skewY()??null,globalCompositeOperation:e.globalCompositeOperation()??null};return Object.fromEntries(Object.entries(y).map(([S,x])=>{const R=r.every(k=>this.isPropertyNotApplicableToNodeType(S,k.getClassName())?!0:k[S]()===x)?this.formatPropertyValue(S,x):magicai_localize.mixed;return[S,R]}))},set selectedNodesProps(r={x:null,y:null,rotation:null,width:null,height:null,scaleX:null,scaleY:null,opacity:null,fill:null,fillPatternX:null,fillPatternY:null,fillPatternScaleX:null,fillPatternScaleY:null,fillPatternRepeat:null,cornerRadius:null,sides:null,numPoints:null,innerRadius:null,outerRadius:null,angle:null,fontFamily:null,fontSize:null,fontStyle:null,textDecoration:null,lineHeight:null,letterSpacing:null,align:null,stroke:null,strokeWidth:null,dash:null,blurRadius:null,skewX:null,skewY:null,globalCompositeOperation:null,useRelativeValue:!1}){const e=this.selectedNodes.length>1||r.useRelativeValue,n=["x","y","rotation","width","height","scaleX","scaleY","opacity","fill","fillPatternX","fillPatternY","fillPatternScaleX","fillPatternScaleY","fillPatternRepeat","cornerRadius","sides","numPoints","innerRadius","outerRadius","angle","fontFamily","fontSize","fontStyle","textDecoration","lineHeight","letterSpacing","align","stroke","strokeWidth","dash","blurRadius","skewX","skewY","globalCompositeOperation"];this.selectedNodes.forEach(o=>{const a=o.getClassName();n.forEach(l=>{if(r[l]==null||this.isPropertyNotApplicableToNodeType(l,a))return;const u=o[l==="fontWeight"?"fontStyle":l](),h=!isNaN(parseInt(u)),f=h&&r[l]==="flip"?u*-1:r[l],g=h?parseFloat(f):f;let v=h&&e?u+g:g;if(l==="fontStyle"){const y=(u??"").split(" ");let S=y[0]??"normal",x=y[1]??"400";isNaN(parseInt(r[l]))?S=r[l]:x=r[l],v=`${S} ${x}`}if(l==="rotation"&&["Rect","Text","TextPath","Image"].includes(a)){let y=(v%360+360)%360;y>180&&(y-=360),v=y;const{x:S,y:x,rotation:I}=this.rotateNodeAroundCenter(o,v);o.rotation(I),o.x(S),o.y(x);return}switch(l){case"width":case"height":case"cornerRadius":case"innerRadius":case"outerRadius":v=Math.max(0,v);break;case"sides":case"numPoints":v=Math.max(3,v);break;case"angle":v=Math.max(0,Math.min(360,v));break;case"opacity":v=Math.max(0,Math.min(1,v));break}this.applyFilters(o,r),o[l](v)})})},init(){this.googleFontsList=window.lqdGoogleFontsList,this.beforeUnloadHandler=this.beforeUnloadHandler.bind(this),this.positionTooltip=this.positionTooltip.bind(this),this.addToHistory=Ee.debounce(this.addToHistory.bind(this),250,{leading:!1,trailing:!0}),this.loadGoogleFontPreview=Ee.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.resizeStage=Ee.throttle(this.resizeStage.bind(this),50),this.onWindowResize=Ee.throttle(this.onWindowResize.bind(this),250),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.$watch("selectedFont",r=>{this.$dispatch("font-selected",{font:r})}),this.$watch("nodes.length",r=>{this.beforeUnloadListened||(r>0?this.addBeforeUnloadListener():this.removeBeforeUnloadListener())}),this.$watch("[zoomLevel, zoomOffsetX, zoomOffsetY]",()=>{this.positionTooltip(),this.positionEditingTextArea(),this.updateSelectionTransformerStroke()}),this.initiateStage()},initiateStage(r={width:720,height:720}){const e=r.width??720,n=r.height??720;if(this.$refs.editorCanvasContainer===null){console.error("Creative Suite canvas was not found");return}if(this.stageInitiated||this.stage){console.warn("Creative Suite canvas was already initiated");return}this.stage=new Konva.Stage({container:this.$refs.editorCanvasContainer,width:e,height:n}),this.container=this.stage.container(),this.selectionTransformer=new Konva.Transformer({keepRatio:!1,borderStroke:this.selectionColors.stroke,anchorSize:6,rotationSnaps:[0,45,90,135,180,225,270,315,360],rotationSnapTolerance:5,rotateAnchorOffset:30,ignoreStroke:!0,flipEnabled:!1,id:"lqd-cs-selection-transformer",name:"lqd-cs-selection-transformer"}),this.selectionRectangle=new Konva.Rect({fill:this.selectionColors.fill,stroke:this.selectionColors.stroke,strokeWidth:1,visible:!1,id:"lqd-cs-selection-rectangle",name:"lqd-cs-selection-rectangle"}),this.layer=new Konva.Layer,this.layer.add(this.selectionTransformer),this.layer.add(this.selectionRectangle),this.stage.add(this.layer),this.container.tabIndex=1,this.container.focus(),this.konvajsContent=this.container.querySelector(".konvajs-content"),this.setContainerDimensions(),this.selectionTransformerEvents(),this.handleSelectionRectangle(),this.initLayers(),this.stageEvents(),this.containerEvents(),this.initWheelZoom(),this.positionTooltip(),this.handleWindowResize(),this.stageInitiated=!0},setContainerDimensions(){this.containerDimensions={x:this.container.offsetLeft,y:this.container.offsetTop,width:this.container.clientWidth,height:this.container.offsetHeight},this.konvajsContentDimensions={x:this.konvajsContent.offsetLeft,y:this.konvajsContent.offsetTop,width:this.konvajsContent.clientWidth,height:this.konvajsContent.offsetHeight}},handleSelectionRectangle(){let r,e,n,o,a=this.layer.getChildren().length;function l(u){if(!(!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed)){Ee.defer(()=>{this.selectionRectangle.visible(!1)});var h=this.selectionRectangle.getClientRect(),f=this.nodes.filter(g=>Konva.Util.haveIntersection(h,g.getClientRect()));this.selectedNodes={nodes:f,event:u}}}this.stage.on("mousedown touchstart",u=>{if(this.isPanning||this.isSpacePressed)return;const h=u.target;h._id===this.stage._id?(a=this.layer.getChildren().length,r=this.stage.getPointerPosition().x,e=this.stage.getPointerPosition().y,n=this.stage.getPointerPosition().x,o=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:r,y:e,width:0,height:0,visible:!0,zIndex:a-1})):this.nodes.find(f=>f.id()===h.id())&&!this.selectedNodes.find(f=>f.id()===h.id())&&(this.selectedNodes={nodes:[h],event:u.evt})}),this.stage.on("mousemove touchmove",u=>{!this.selectionRectangle.visible()||this.isPanning||this.isSpacePressed||(n=this.stage.getPointerPosition().x,o=this.stage.getPointerPosition().y,this.selectionRectangle.setAttrs({x:Math.min(r,n),y:Math.min(e,o),width:Math.abs(n-r),height:Math.abs(o-e),zIndex:a-1}))}),window.addEventListener("mouseup",l.bind(this)),window.addEventListener("touchend",l.bind(this)),this.stage.on("dblclick dbltap",u=>{let h=u.target;if(h._id===this.stage._id)return;const f=h.findAncestors("Group");f.length&&(f.length>1&&(h=f[0]),h.draggable(!0),this.selectedGroupChildNodes.push(h),this.selectedNodes={nodes:[h],event:u.evt})}),this.stage.on("click tap",u=>{const h=u.target;if(!(u.evt.shiftKey||this.selectionRectangle.visible()&&this.selectionRectangle.width()>0&&this.selectionRectangle.height()>0)){if(h._id===this.stage._id){this.selectedNodes.length&&(this.selectedNodes={});return}this.selectedNodes={nodes:[h],event:u.evt}}}),this.container.addEventListener("keydown",u=>{const h=u.key;if(!h||this.editingTextNode)return;const f=u.ctrlKey||u.metaKey,g=u.shiftKey;let v=1;switch(f&&(v=.1),g&&(v=10),h){case"Backspace":u.preventDefault(),this.destroySelectedNodes();break;case"ArrowUp":u.preventDefault(),this.selectedNodesProps={y:-v,useRelativeValue:!0},this.positionTooltip();break;case"ArrowDown":u.preventDefault(),this.selectedNodesProps={y:v,useRelativeValue:!0},this.positionTooltip();break;case"ArrowLeft":u.preventDefault(),this.selectedNodesProps={x:-v,useRelativeValue:!0},this.positionTooltip();break;case"ArrowRight":u.preventDefault(),this.selectedNodesProps={x:v,useRelativeValue:!0},this.positionTooltip();break;case"a":u.preventDefault(),f&&(this.selectedNodes={nodes:"all"});break}}),this.konvajsContent.addEventListener("dragover",u=>{u.preventDefault()}),this.konvajsContent.addEventListener("drop",u=>{u.preventDefault(),this.stage.setPointersPositions(u);const h=JSON.parse(u.dataTransfer.getData("data")??"{}");if(!h.type)return;let{x:f,y:g}=this.stage.getPointerPosition();const v=this.addNodeToStage({type:h.type,attrs:{...h.attrs},beforeAdd:y=>{const S=y.getClassName(),x=S==="Rect"||S==="Path",I=y.getClientRect();y.setAttrs({x:f-(x?I.width/2:0),y:g-(x?I.height/2:0)})}});this.selectedNodes={nodes:[v]}})},stageEvents(){this.stage.on("click tap",()=>{this.setActiveTooltipDropdown(null)}),this.stage.on("widthChange heightChange",this.addToHistory)},containerEvents(){const r=e=>{e.target===this.container&&this.selectedNodes.length&&(this.selectedNodes={})};this.container.addEventListener("click",r.bind(this)),this.container.addEventListener("tap",r.bind(this)),this.container.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="z"&&!e.shiftKey&&(e.preventDefault(),this.undo()),((e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="z"||(e.ctrlKey||e.metaKey)&&e.key==="y")&&(e.preventDefault(),this.redo())})},selectionTransformerEvents(){function r(n,o,a){const l=n.getClassName();if(["Rect","Image","Text"].includes(l))n.width(n.width()*o),n.height(n.height()*a),n.scaleX(1),n.scaleY(1);else if(l==="Circle"||l==="RegularPolygon"){const u=n.radius(),h=(o+a)/2;n.radius(u*h),n.scaleX(1),n.scaleY(1)}else l==="Ellipse"&&(n.radiusX(n.radiusX()*o),n.radiusY(n.radiusY()*a),n.scaleX(1),n.scaleY(1))}function e(n,o,a){n.getChildren().forEach(l=>{const u=l.getClassName(),{x:h,y:f}=l.position();if(l.position({x:h*o,y:f*a}),u==="Group"){const g=l.scaleX()*o,v=l.scaleY()*a;l.scaleX(1),l.scaleY(1),e(l,g,v)}else r(l,o*l.scaleX(),a*l.scaleY())})}this.selectionTransformer.on("transform",n=>{this.selectedNodes.forEach(a=>{const l=a.getClassName(),u=a.scaleX(),h=a.scaleY();if(l==="Group"){a.scaleX(1),a.scaleY(1),e(a,u,h);return}r(a,u,h)})})},createNode(r={type:null,attrs:{}}){var u;if(!this.stageInitiated)return;if(!Konva[r.type]){console.error(`Konva does not support the type "${r.type}"`);return}const e=this.generateNameByType(r.type),n=this.stage.width(),o=this.stage.height(),a={x:n/2,y:o/2,fill:Konva.Util.getRandomColor(),stroke:"",strokeWidth:0,draggable:!0,strokeScaleEnabled:!1,text:((u=r.attrs)==null?void 0:u.text)||magicai_localize.double_click_to_edit,fontSize:30,fontStyle:"normal 400",id:`${e.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:e,perfectDrawEnabled:!1,offset:{x:0,y:0},...r.attrs},l=new Konva[r.type](a);return a.x==="left"&&l.x(0),a.x==="center"&&l.x((n-l.width())/2),a.x==="right"&&l.x(n-l.width()),a.y==="top"&&l.y(0),a.y==="middle"&&l.y((o-l.height())/2),a.y==="bottom"&&l.y(o-l.height()),r.type==="Group"&&this.addGroupHighlighter(l),["Text","TextPath"].includes(r.type)&&this.handleTextEdit(l),r.type==="Image"&&this.handleImageUpload(l,a.fillSource||this.placeholderImage),l.on("heightChange widthChange innerRadiusChange outerRadiusChange radiusChange radiusXChange radiusYChange",()=>{this.handleFillCover(l)}),l.on(this.historyListeners.map(h=>h+="Change").join(" "),this.addToHistory),l},addNodeToStage(r={type:"Ellipse",attrs:{},beforeAdd:null,node:null,addHistory:!0}){if(!this.stageInitiated)return;const e=r.node||this.createNode(r),n=r.addHistory??!0;return r.beforeAdd&&typeof r.beforeAdd=="function"&&r.beforeAdd.call(this,e),this.layer.add(e),this.selectedNodes={nodes:[e]},n&&this.addToHistory(),e},addGroupHighlighter(r){const e=new Konva.Transformer({id:`highlighter-${r.id()}`,name:"lqd-cs-highlighter",enabledAnchors:[],rotateEnabled:!1,borderStroke:this.selectionColors.stroke,draggable:!1});r.setAttr("highlighter",e.id()),this.layer.add(e)},handleHighlighterVisibility(r){let e="",n="",o=r;r.on("mouseover",a=>{const l=a.evt.ctrlKey||a.evt.metaKey,h=r.findAncestors("Group").at(-1);if(!l&&h&&(o=h),o.getType()==="Group"&&l)return;const f=this.layer.findOne(`#highlighter-${o.id()}`),g=this.selectedNodes.find(v=>v.id()===o.id());e=r.stroke(),n=r.strokeWidth(),g||(f&&f.nodes([o]),o.stroke(this.selectionColors.stroke),o.strokeWidth(n??2))}),r.on("mouseout",()=>{const a=o.getAttr("highlighter");a&&this.layer.findOne(`#${a}`).nodes([]),o.stroke(e),o.strokeWidth(n),o=r})},applyFilters(r,e){e.blurRadius?(r.clearCache(),r.cache(),r.filters([Konva.Filters.Blur])):!e.blurRadius&&!r.blurRadius()&&r.isCached()&&r.clearCache()},handleTextEdit(r){const e=r.getClassName();r.off("dblclick.editText dbltap.editText"),r.on("dblclick.editText dbltap.editText",()=>{if(r.getAttr("aiTaskInProgress"))return toastr.warn("An AI task is in progress. please wait until it's done.");r.hide(),this.selectionTransformer.hide(),this.editingTextarea=document.createElement("textarea"),this.container.insertAdjacentElement("afterend",this.editingTextarea);const n=()=>{this.editingTextarea.style.height="auto",this.editingTextarea.style.height=this.editingTextarea.scrollHeight+r.fontSize()+"px"};this.editingTextarea.classList.add("absolute","border-none","p-0","m-0","overflow-hidden","bg-transparent","outline-none","resize-none","whitespace-pre","origin-top-left","placeholder:text-transparent"),this.editingTextNode=r;const o=r.fontStyle().split(" ");let a=o[0],l=o[1];isNaN(parseInt(a))||(a=null,l=a),this.editingTextarea.style.width="9999px",this.editingTextarea.style.fontFamily=r.fontFamily(),this.editingTextarea.style.lineHeight=e==="Text"?r.lineHeight().toString():"1.2",this.editingTextarea.style.textAlign=r.align(),this.editingTextarea.style.color=r.fill().toString(),this.editingTextarea.style.transformOrigin="top left",this.editingTextarea.style.textDecoration=r.textDecoration(),this.editingTextarea.value=r.text(),this.editingTextarea.placeholder=this.editingTextarea.value,a&&(this.editingTextarea.style.fontStyle=a),l&&(this.editingTextarea.style.fontWeight=l),n(),this.editingTextarea.focus(),this.editingTextarea.select(),this.positionEditingTextArea();const u=()=>{!this.editingTextNode||!this.editingTextarea||(this.editingTextarea.remove(),window.removeEventListener("click",h),window.removeEventListener("tap",h),r.show(),this.selectionTransformer.show(),this.selectionTransformer.forceUpdate(),this.editingTextNode=null,this.editingTextarea=null)},h=f=>{this.editingTextNode&&f.target!==this.editingTextarea&&(r.text(this.editingTextarea.value),u())};this.editingTextarea.addEventListener("keydown",f=>{if(this.editingTextarea){if(f.key==="Enter"&&!f.shiftKey){r.text(this.editingTextarea.value),u();return}if(f.key==="Escape"){u();return}this.editingTextarea.placeholder=this.editingTextarea.value,n()}}),Ee.defer(()=>{window.addEventListener("click",h),window.addEventListener("tap",h)})}),r.on("fontFamilyChange fontSizeChange fontStyleChange textDecorationChange lineHeightChange letterSpacingChange",({newVal:n,type:o})=>{if(n==null||o==null||!this.editingTextarea)return;const a=o.replace("Change","");let l=n;(a==="letterSpacing"||a==="fontSize")&&(l+="px"),this.editingTextarea.style[a]=l})},positionEditingTextArea(){if(!this.editingTextNode)return;const r=this.editingTextNode.getClientRect(),e=this.zoomLevel/100,n={x:r.x*e,y:r.y*e},o=this.konvajsContent.getBoundingClientRect(),a=this.editingTextNode.rotation(),l=this.editingTextNode.getClassName();l==="TextPath"&&(n.x+=r.width/2*e,n.y+=r.height/2*e),this.editingTextarea.style.top=Math.max(0,o.top+n.y)+"px",this.editingTextarea.style.left=Math.max(0,o.left+n.x)+"px",this.editingTextarea.style.fontSize=this.editingTextNode.fontSize()*e+"px",this.editingTextarea.style.letterSpacing=this.editingTextNode.letterSpacing()*e+"px",a&&l!=="TextPath"&&(this.editingTextarea.style.transform=`rotate(${a}deg)`)},updateSelectionTransformerStroke(){const e=100/this.zoomLevel,n=1*Math.min(3,Math.max(.5,e)),a=6*Math.min(3,Math.max(.5,e));this.selectionTransformer.borderStrokeWidth(n),this.selectionTransformer.anchorSize(a)},getNodesFromOptions(r={ids:[],nodes:[],id:null,node:null}){var n,o,a;let e=[];return(n=r.nodes)!=null&&n.length?r.nodes==="all"?e=this.nodes:e=r.nodes:(o=r.ids)!=null&&o.length?e=this.nodes.filter(l=>r.ids.includes(l.id())):r.id?e=[this.nodes.find(l=>l.id()===r.id)]:r.node&&(this.nodes.find(l=>{var u;return l.id()===((u=r.node)==null?void 0:u.id())})?e=[r.node]:console.warn("Could not find the node: ",((a=r.node)==null?void 0:a.id())??"Unknown node ID")),e},deselectNodes(r){const e=this.getNodesFromOptions(r).map(n=>n.id());this.selectedNodes={nodes:this.selectedNodes.filter(n=>!e.includes(n.id()))}},removeNodes(r){const e=this.getNodesFromOptions(r);this.deselectNodes({nodes:e}),e.forEach(n=>n.remove())},destroyNodes(r){const e=this.getNodesFromOptions(r);this.deselectNodes({nodes:e}),e.forEach(n=>n.destroy())},destroySelectedNodes(){this.destroyNodes({nodes:this.selectedNodes})},cloneSelectedNodes(){const r=this.selectedNodes.map(e=>{const n=this.generateNameByType(e.getClassName());return e.clone({x:e.x()+20,y:e.y()+20,name:n,id:`${n.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`})});r.filter(e=>["Text","TextPath"].includes(e.getClassName())).forEach(e=>this.handleTextEdit(e)),this.layer.add(...r),this.selectedNodes={nodes:r}},groupSelectedNodes(){const r=this.selectedNodes;if(!r.length)return;this.generateNameByType("Group");const e=this.addNodeToStage({type:"Group",attrs:{x:0,y:0,width:null,height:null,fill:null,draggable:!0}});r.forEach(n=>{e.add(n),n.draggable(!1)}),this.layer.add(e),this.addGroupHighlighter(e),this.selectedNodes={nodes:[e]}},ungroupSelectedNodes(){const r=this.selectedNodes;if(!r.length)return;r.filter(n=>n.getType()==="Group").forEach(n=>{const o=n.getChildren(),a=n.findAncestors("Group"),l=a==null?void 0:a.at(0),u=n.id(),h=n.getAttr("highlighter"),f=[];o.forEach(g=>{g.findAncestors("Group").length<=1&&f.push(g)}),f.forEach(g=>{const v=g.getAbsolutePosition(l??this.stage),y=g.rotation(),S=n.rotation(),x=(y+S)%360;g.moveTo(l??this.layer),g.position(v),g.rotation(x),g.draggable(!l)}),this.destroyNodes({ids:[u,h]}),this.selectedNodes={nodes:f}})},getNodesByType(r){return r?this.nodes.filter(e=>e.getClassName()===r):[]},generateNameByType(r){var a;if(!r)return"Node 0";const e=this.getNodesByType(r),n=e.length;return`${((a=e[0])==null?void 0:a.getClassName())||r} ${n+1}`},moveNode(r){this.selectedNodes.forEach(e=>e[r]())},initLayers(){const e=(navigator.userAgentData?navigator.userAgentData.platform.includes("macOS"):navigator.platform.includes("Mac"))?"Meta":"Control";this.layersSortable=X.create(this.$refs.layers,{multiDrag:!0,selectedClass:"selected",multiDragKey:e,animation:150,draggable:".lqd-cs-layer",filter:".lqd-cs-layers-list-template",onSelect:n=>{const o=n.originalEvent.target,a=n.items.map(l=>l.dataset.id);this.selectedNodes={ids:a},this.elementIsFocusable(o)||this.$nextTick(()=>{this.container.focus()})},onEnd:()=>{const n=[...this.nodes],o=this.selectedNodes,a=this.layersSortable.toArray();n.sort((l,u)=>{const h=a.indexOf(l.id());return a.indexOf(u.id())-h}),Ee.defer(()=>this.removeNodes({nodes:"all"})),Ee.defer(()=>{this.layer.add(...n),this.selectedNodes={nodes:o}})}})},alignSelectedNodes(r){const e=this.selectedNodes;if(e.length===1){const o=e[0],a=o.getClientRect(),l=this.stage.width(),u=this.stage.height(),h=o.x(),f=o.y();switch(r){case"left":o.x(h-a.x);break;case"center":o.x(h-a.x+(l-a.width)/2);break;case"right":o.x(h-a.x+l-a.width);break;case"top":o.y(f-a.y);break;case"middle":o.y(f-a.y+(u-a.height)/2);break;case"bottom":o.y(f-a.y+u-a.height);break}return}const n=e.reduce((o,a)=>{const l=a.getClientRect();return{left:Math.min(o.left,l.x),right:Math.max(o.right,l.x+l.width),top:Math.min(o.top,l.y),bottom:Math.max(o.bottom,l.y+l.height),centerX:(o.left+o.right)/2,centerY:(o.top+o.bottom)/2}},{left:1/0,right:-1/0,top:1/0,bottom:-1/0,centerX:0,centerY:0});n.centerX=(n.left+n.right)/2,n.centerY=(n.top+n.bottom)/2,e.forEach(o=>{const a=o.getClientRect(),l=o.x(),u=o.y();switch(r){case"left":o.x(l-(a.x-n.left));break;case"center":o.x(l+(n.centerX-(a.x+a.width/2)));break;case"right":o.x(l+(n.right-(a.x+a.width)));break;case"top":o.y(u-(a.y-n.top));break;case"middle":o.y(u+(n.centerY-(a.y+a.height/2)));break;case"bottom":o.y(u+(n.bottom-(a.y+a.height)));break}})},rotatePoint({x:r,y:e},n){const o=Math.cos(n),a=Math.sin(n);return{x:r*o-e*a,y:e*o+r*a}},rotateNodeAroundCenter(r,e){const n={x:-r.width()/2,y:-r.height()/2},o=this.rotatePoint(n,Konva.getAngle(r.rotation())),a=this.rotatePoint(n,Konva.getAngle(e)),l=a.x-o.x,u=a.y-o.y,h=r.x()+l,f=r.y()+u;return{rotation:e,x:h,y:f}},isPropertyNotApplicableToNodeType(r,e){return r==="cornerRadius"&&!["Rect","Image"].includes(e)||r==="sides"&&e!=="RegularPolygon"||r==="numPoints"&&e!=="Star"||r==="innerRadius"&&!["Star","Ring","Arc"].includes(e)||r==="outerRadius"&&!["Star","Ring","Arc"].includes(e)||r==="angle"&&!["Arc","Wedge"].includes(e)||["fontSize","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","letterSpacing","align"].includes(r)&&!["Text","TextPath"].includes(e)||r==="lineHeight"&&e!=="Text"},formatPropertyValue(r,e){return typeof e=="number"?r==="opacity"?e.toFixed(2):Number.isInteger(e)?e:e.toFixed(1):r==="fontStyle"&&e==="normal"?400:e},handleFillCover(r){r.getAttr("fillCover")&&this.applyFillCover(r)},async handleImageUpload(r,e){if(e)return fetch(e).then(o=>o.blob()).then(o=>{const a=new File([o],"image",{type:o.type});this.uploadImageAndSetFill({file:a,node:r})}).catch(o=>{toastr.error("Failed to load image"),console.error("Error creating file from URL:",o)});const n=document.createElement("input");n.type="file",n.accept="image/*",n.style.display="none",document.body.appendChild(n),n.addEventListener("cancel",async o=>{!o.target.files[0]&&!r.fillPatternImage()&&this.destroyNodes({nodes:[r]})}),n.addEventListener("change",async o=>{await this.uploadImageAndSetFill({event:o,node:r}),this.activeFillTab="image",this.$nextTick(()=>{document.body.removeChild(n)})}),n.click()},async uploadImageAndSetFill({event:r,file:e,node:n,setSize:o=!0}){if(r&&!e&&(e=r.target.files[0]),!e||!n)return;if(!e.type.startsWith("image/")){toastr.error("Please upload a valid image file");return}const a=new Image;return n.getClassName(),new Promise((l,u)=>{a.onload=()=>{n.fillPatternImage(a),n.fillPriority("pattern"),n.setAttr("fillImageWidth",a.naturalWidth),n.setAttr("fillImageHeight",a.naturalHeight),n.setAttr("fillSource",a.src),n.setAttr("fillCover",!0),this.applyFillCover(n),l(a)},a.onerror=function(h){u(h)},a.src=URL.createObjectURL(e)})},removeFillPattern(){const r=this.selectedNodes[0];r.fillPatternImage(null),r.fillPriority("color"),this.$refs.selectedNodeFillPatternInput&&(this.$refs.selectedNodeFillPatternInput.value=""),r.setAttr("fillImageWidth",null),r.setAttr("fillImageHeight",null),r.setAttr("fillSource",null),r.setAttr("fillCover",null),r.setAttr("fillAlign",null)},getFillCoverProps(r){const e=r.getAttr("fillAlign")??"center-middle",n=r.getClassName(),o=r.getClientRect(),a=r.getAttr("fillImageWidth")??o.width,l=r.getAttr("fillImageHeight")??o.height;let u,h,f=!1;n==="Circle"?u=h=r.radius()*2:n==="Ellipse"?(u=r.radiusX()*2,h=r.radiusY()*2):["Rect","Image","Text"].includes(n)?(u=r.width(),h=r.height()):(u=o.width,h=o.height,f=!0);const g=a/l,v=u/h;let y,S;v>=g?(y=u/a,S=u/g/l):(y=h*g/a,S=h/l);const x=a*y,I=l*S;let R=0,k=0;return f||!["Rect","Image","Text"].includes(n)?(e.includes("left")?R=-u/2:e.includes("center")?R=-x/2:e.includes("right")&&(R=-x+u/2),e.includes("top")?k=-h/2:e.includes("middle")?k=-I/2:e.includes("bottom")&&(k=-I+h/2)):(e.includes("left")?R=0:e.includes("center")?R=(u-x)/2:e.includes("right")&&(R=u-x),e.includes("top")?k=0:e.includes("middle")?k=(h-I)/2:e.includes("bottom")&&(k=h-I)),n==="Path"&&f&&(R+=o.x,k+=o.y),{offsetX:R,offsetY:k,scaleX:y,scaleY:S}},applyFillCover(r){if(r=r??this.selectedNodes[0],!r)return;r.setAttr("fillPatternRepeat","no-repeat");const e=this.getFillCoverProps(r);r.setAttrs({fillPatternX:e.offsetX,fillPatternY:e.offsetY,fillPatternScaleX:e.scaleX,fillPatternScaleY:e.scaleY})},onFontsSearchInput(){const r=this.$event.target.value.trim();if(!r){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(e=>e.toLowerCase().includes(r.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)},addToGoogleFontLoadQueue(r,e=!1){if(!(e&&this.lqdFontPreview.includes(r))){if(!e)return this.loadGoogleFontFull(r);this.loadingFontPreviewQueue.push(r),this.loadGoogleFontPreview(r),this.lqdFontPreview.push(r)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const r=this.loadingFontPreviewQueue.map(o=>`family=${o}`).join("&").replaceAll(" ","+"),e=encodeURIComponent(this.loadingFontPreviewQueue.join("")),n=`https://fonts.googleapis.com/css2?${r}&display=swap&text=${e}`;this.createFontLink(n),this.loadingFontPreviewQueue=[]},async loadGoogleFontFull(r){const e=`https://fonts.googleapis.com/css2?family=${r.replaceAll(/ /g,"+")}:wght@400;500;600;700;800;900&display=swap`;this.createFontLink(e),document.fonts.ready.finally(()=>{this.selectedNodes.find(n=>["Text","TextPath"].includes(n.getClassName()))&&this.selectionTransformer.forceUpdate()})},createFontLink(r){const e=document.createElement("link");e.href=r,e.rel="stylesheet",e.type="text/css",document.head.appendChild(e)},handleStageResize({width:r,height:e,preserveAspectRatio:n=!1}){if(r==null&&e==null)return;const o=parseInt(this.stage.width(),10),a=parseInt(this.stage.height(),10);let l=r??o,u=e??a;if(n&&o&&a){const h=o/a;if(r&&!e)u=l/h;else if(!r&&e)l=u*h;else if(r&&e){const f=l/u;f>h?l=u*h:f<h&&(u=l/h)}}this.prevStageWidth=o,this.prevStageHeight=a,this.resizeStage(l,u)},resizeStage(r,e){this.stage.width(r),this.stage.height(e),this.container.style.width=r+"px",this.container.style.height=e+"px";const n=r/(this.prevStageWidth??1),o=e/(this.prevStageHeight??1);if(this.adaptiveResize&&this.prevStageWidth>0&&this.prevStageHeight>0){const l=r>this.prevStageWidth||e>this.prevStageHeight?Math.max(n,o):Math.min(n,o);this.nodes.forEach(u=>{u.x(u.x()*n),u.y(u.y()*o);const h=u.getClassName();if(u.width&&u.height){const f=u.width(),g=u.height();u.width(f*l),u.height(g*l)}if(h==="Circle"&&u.radius(u.radius()*l),h==="Ellipse"){const f=u.radiusX(),g=u.radiusY();u.radiusX(f*l),u.radiusY(g*l)}h==="RegularPolygon"&&u.radius(u.radius()*l),h==="Star"&&(u.innerRadius(u.innerRadius()*l),u.outerRadius(u.outerRadius()*l)),(h==="Text"||h==="TextPath")&&u.fontSize(u.fontSize()*l),u.fillPatternImage&&u.fillPatternScaleX&&u.fillPatternScaleY&&(u.fillPatternScaleX(u.fillPatternScaleX()*l),u.fillPatternScaleY(u.fillPatternScaleY()*l))}),this.selectionTransformer.forceUpdate(),this.fitToScreen(),Ee.defer(()=>{this.setContainerDimensions()})}},getMaxZoom(){return 200},getMinZoom(){return 20},getFitToScreenZoom(){const r=this.$refs.editorCanvasContainer.clientWidth,e=this.$refs.editorCanvasContainer.clientHeight,n=this.stage.width(),o=this.stage.height(),a=80,l=80,u=r-a,h=e-l,f=u/n*100,g=h/o*100,v=Math.min(f,g),y=this.getMinZoom(),S=this.getMaxZoom();return Math.max(y,Math.min(v,S))},setZoomLevel(r){const e=this.getMinZoom(),n=this.getMaxZoom();this.zoomLevel=Math.max(e,Math.min(n,r)),this.reachedMinZoom=this.zoomLevel===e,this.reachedMaxZoom=this.zoomLevel>=n},zoomIn(){this.setZoomLevel(this.zoomLevel+10)},zoomOut(){this.setZoomLevel(this.zoomLevel-10)},fitToScreen(){this.zoomOffsetX=0,this.zoomOffsetY=0;const r=this.getFitToScreenZoom();this.setZoomLevel(r)},positionTooltip(){if(!this.selectedNodes.length)return;const r=this.konvajsContent.getBoundingClientRect(),e=this.selectedNodesRect,n=this.zoomLevel/100,o=r.left+e.x*n+e.width*n/2,a=r.top+e.y*n-40;this.$refs.tooltip.style.left=`${o}px`,this.$refs.tooltip.style.top=`${a}px`},initWheelZoom(){let r={x:0,y:0};const e=f=>{if(!this.nodes.length)return;f.preventDefault();const g=this.konvajsContent.getBoundingClientRect(),v=f.clientX-g.left,y=f.clientY-g.top;if(f.metaKey||f.ctrlKey){const I=(f.deltaY<0?1:-1)*2,R=this.getMinZoom(),k=this.getMaxZoom(),Z=Math.max(R,Math.min(k,this.zoomLevel+I)),F=this.zoomLevel,Q=Z/F;this.setZoomLevel(Z);const gt=g.width/2,ht=g.height/2,bt=(v-gt)/F,$t=(y-ht)/F;this.zoomOffsetX-=bt*(Q-1),this.zoomOffsetY-=$t*(Q-1)}else this.zoomOffsetX-=f.deltaX/(this.zoomLevel/15),this.zoomOffsetY-=f.deltaY/(this.zoomLevel/15)},n=f=>{this.editingTextNode||f.code==="Space"&&!f.repeat&&!this.isSpacePressed&&this.nodes.length&&(this.isSpacePressed=!0,document.body.classList.add("is-panning"),this.container.classList.add("is-panning"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),f.preventDefault())},o=f=>{this.editingTextNode||f.code==="Space"&&(this.isSpacePressed=!1,this.isPanning=!1,document.body.classList.remove("is-panning","is-panning-active"),this.container.classList.remove("is-panning","is-panning-active"))},a=f=>{this.editingTextNode||this.isSpacePressed&&f.button===0&&this.nodes.length&&(this.isPanning=!0,r={x:f.clientX,y:f.clientY},document.body.classList.add("is-panning-active"),this.container.classList.add("is-panning-active"),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this.container.focus(),f.stopPropagation(),f.preventDefault())},l=f=>{if(!this.editingTextNode&&this.isPanning){const g=f.clientX-r.x,v=f.clientY-r.y;r={x:f.clientX,y:f.clientY},this.zoomOffsetX+=g/(this.zoomLevel/15),this.zoomOffsetY+=v/(this.zoomLevel/15),f.preventDefault(),f.stopPropagation()}},u=()=>{this.editingTextNode||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))},h=()=>{this.editingTextNode||this.isPanning&&(this.isPanning=!1,document.body.classList.remove("is-panning-active"),this.container.classList.remove("is-panning-active"))};this.container.addEventListener("wheel",e,{passive:!1}),this.container.addEventListener("mousedown",a),document.addEventListener("keydown",n),document.addEventListener("keyup",o),document.addEventListener("mousemove",l),document.addEventListener("mouseup",u),document.addEventListener("mouseleave",h),window.addEventListener("resize",this.positionTooltip),this.selectionTransformer.on("dragmove",this.positionTooltip),this.selectionTransformer.on("transform",this.positionTooltip),document.addEventListener("nodes-selected",this.positionTooltip)},initNodesSnap(){let r=this.nodes;const e=()=>{var l=[0,this.stage.width()/2,this.stage.width()],u=[0,this.stage.height()/2,this.stage.height()];return r.forEach(h=>{if(!this.selectionTransformer.nodes().find(g=>g.id()===h.id())){var f=h.getClientRect();l.push([f.x,f.x+f.width,f.x+f.width/2]),u.push([f.y,f.y+f.height,f.y+f.height/2])}}),{vertical:l.flat(),horizontal:u.flat()}},n=()=>{const l=this.selectionTransformer.getClientRect(),u=this.selectionTransformer.absolutePosition();return l.height=l.height-this.selectionTransformer.rotateAnchorOffset(),l.y=l.y+this.selectionTransformer.rotateAnchorOffset(),{vertical:[{guide:Math.round(l.x),offset:Math.round(u.x-l.x),snap:"start"},{guide:Math.round(l.x+l.width/2),offset:Math.round(u.x-l.x-l.width/2),snap:"center"},{guide:Math.round(l.x+l.width),offset:Math.round(u.x-l.x-l.width),snap:"end"}],horizontal:[{guide:Math.round(l.y),offset:Math.round(u.y-l.y),snap:"start"},{guide:Math.round(l.y+l.height/2),offset:Math.round(u.y-l.y-l.height/2),snap:"center"},{guide:Math.round(l.y+l.height),offset:Math.round(u.y-l.y-l.height),snap:"end"}]}},o=(l,u)=>{var h=[],f=[];l.vertical.forEach(S=>{u.vertical.forEach(x=>{var I=Math.abs(S-x.guide);I<this.guidelineOffset&&h.push({lineGuide:S,diff:I,snap:x.snap,offset:x.offset})})}),l.horizontal.forEach(S=>{u.horizontal.forEach(x=>{var I=Math.abs(S-x.guide);I<this.guidelineOffset&&f.push({lineGuide:S,diff:I,snap:x.snap,offset:x.offset})})});var g=[],v=h.sort((S,x)=>S.diff-x.diff)[0],y=f.sort((S,x)=>S.diff-x.diff)[0];return v&&g.push({lineGuide:v.lineGuide,offset:v.offset,orientation:"V",snap:v.snap}),y&&g.push({lineGuide:y.lineGuide,offset:y.offset,orientation:"H",snap:y.snap}),g},a=l=>{l.forEach(u=>{const h=u.orientation==="H";var f=new Konva.Line({points:h?[-6e3,0,6e3,0]:[0,-6e3,0,6e3],stroke:this.selectionColors.stroke,strokeWidth:1,name:"lqd-cs-guide-line",dash:[4,6]});this.layer.add(f),f.absolutePosition({x:h?0:u.lineGuide,y:h?u.lineGuide:0})})};this.selectionTransformer.on("dragstart",()=>{r=this.nodes}),this.selectionTransformer.on("dragmove",()=>{this.layer.find(".lqd-cs-guide-line").forEach(f=>f.destroy());var l=e(),u=n(),h=o(l,u);h.length&&(a(h),this.selectedNodes.forEach(f=>{const g=f.absolutePosition(),v=this.selectionTransformer.absolutePosition(),y=g.x-v.x,S=g.y-v.y;h.forEach(x=>{switch(x.orientation){case"V":{g.x=x.lineGuide+x.offset+y;break}case"H":{g.y=x.lineGuide+x.offset+S;break}}}),f.absolutePosition(g)}))}),this.layer.on("dragend",()=>{this.layer.find(".lqd-cs-guide-line").forEach(l=>l.destroy())})},addToHistory(){this.history.length>this.maxHistoryLength-1&&this.history.shift(),this.historyPointer!==this.history.length-1&&(this.history=this.history.slice(0,this.historyPointer+1)),this.history.push({stage:{width:this.stage.width(),height:this.stage.height()},zoom:{zoomOffsetX:this.zoomOffsetX,zoomOffsetY:this.zoomOffsetY,zoomLevel:this.zoomLevel},nodes:this.nodes.map(r=>r.toJSON()),selectedNodeIds:this.selectedNodes.map(r=>r.id())}),this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1)},undo(){this.historyPointer!==-1&&(this.historyPointer=Math.max(-1,this.historyPointer-1),this.applyHistory())},redo(){this.historyPointer!==this.history.length-1&&(this.historyPointer=Math.min(this.history.length-1,this.historyPointer+1),this.applyHistory())},applyHistory(){var a,l,u;if(this.historyPointer===-1)return this.destroyNodes({nodes:"all"});const r=this.history[this.historyPointer];if(!r)return;const e=this.stage.width(),n=this.stage.height();let o=!1;(a=r.stage)!=null&&a.width&&r.stage.width!==e&&(this.stage.width(r.stage.width),o=!0),(l=r.stage)!=null&&l.height&&r.stage.height!==n&&(this.stage.height(r.stage.height),o=!0),o&&r.zoom&&this.$nextTick(()=>{this.fitToScreen()}),this.destroyNodes({nodes:"all"}),(u=r.nodes)==null||u.forEach(h=>{try{const f=Konva.Node.create(h),g=f.getClassName(),v=f.getAttrs();this.addNodeToStage({type:g,attrs:v,addHistory:!1}),f.destroy(),r.selectedNodeIds&&(this.selectedNodes={ids:r.selectedNodeIds})}catch(f){console.error("Error creating node:",f)}})},downloadImage(){if(this.stage){this.busy=!0;try{const r=this.selectionTransformer.visible();this.selectionTransformer.visible(!1);const e=document.createElement("div");e.style.position="absolute",e.style.zIndex="-1",e.style.opacity="0",e.style.width=`${this.stage.width()}px`,e.style.height=`${this.stage.height()}px`,document.body.appendChild(e);const n=new Konva.Stage({container:e,width:this.stage.width(),height:this.stage.height(),background:"white"}),o=this.layer.clone();o.find("#lqd-cs-selection-transformer, #lqd-cs-selection-rectangle").forEach(a=>{a.remove()}),n.add(o),n.toDataURL({mimeType:"image/png",quality:1,pixelRatio:2,callback:a=>{const l=document.createElement("a");l.download=`canvas-export-${new Date().getTime()}.png`,l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),document.body.removeChild(e),n.destroy(),this.selectionTransformer.visible(r),this.busy=!1}})}catch(r){console.error("Error exporting image:",r),this.busy=!1,this.selectionTransformer.visible(!0)}}},resetCanvas(){this.nodes.length&&confirm(magicai_localize.are_you_sure_)&&(this.resetHistory(),this.removeNodes({nodes:"all"}),this.fitToScreen())},resetHistory(){this.history=[],this.historyPointer=-1},beforeUnloadHandler(r){if(this.nodes.length>0){const e=magicai_localize.you_have_unsaved_changes__are_you_sure_you_want_to_leave_;return r.preventDefault(),r.returnValue=e,e}},addBeforeUnloadListener(){this.beforeUnloadListened=!0,window.addEventListener("beforeunload",this.beforeUnloadHandler)},removeBeforeUnloadListener(){this.beforeUnloadListened=!1,window.removeEventListener("beforeunload",this.beforeUnloadHandler)},handleExport(){if(!(!this.stage||!this.nodes.length))try{const r=this.nodes.map(a=>a.toJSON()),e={stage:{width:this.stage.width(),height:this.stage.height()},nodes:r},n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),o=document.createElement("a");o.setAttribute("href",n),o.setAttribute("download",`canvas-export-${new Date().getTime()}.json`),document.body.appendChild(o),o.click(),o.remove(),toastr.success("Canvas exported successfully")}catch(r){console.error("Error exporting canvas:",r),toastr.error("Failed to export canvas")}},handleImport(){const r=document.createElement("input");r.type="file",r.accept=".json",r.style.display="none",r.addEventListener("change",e=>{const n=e.target.files[0];if(!n)return;const o=new FileReader;o.onload=a=>{try{const l=JSON.parse(a.target.result);this.importData(l),toastr.success("Canvas imported successfully")}catch(l){console.error("Error importing canvas:",l),toastr.error("Failed to import canvas")}},o.readAsText(n),r.remove()}),document.body.appendChild(r),r.click()},importData(r){if(!r.nodes||!Array.isArray(r.nodes))throw new Error("Invalid file format");(!this.nodes.length||this.nodes.length&&confirm(magicai_localize.are_you_sure_))&&(this.destroyNodes({nodes:"all"}),r.stage&&this.handleStageResize({width:r.stage.width,height:r.stage.height}),r.nodes.forEach(e=>{try{const n=Konva.Node.create(e),o=n.getClassName(),a=n.getAttrs();this.addNodeToStage({type:o,attrs:a,addHistory:!1,beforeAdd:l=>{a.fontFamily&&this.loadGoogleFontFull(a.fontFamily),o==="Group"&&n.getChildren().forEach(h=>{h.draggable(!1),l.add(h.clone())})}}),n.destroy()}catch(n){console.error("Error creating node:",n)}}),this.resetHistory())},async loadTemplatesList(r){if(r==null)return;this.loadingTemplatesFailed=!1;const n=await(await fetch(r)).json();if(!(n instanceof Array)||!n.length){this.loadingTemplatesFailed=!0,toastr.error(magicai_localize.could_not_fetch_templates_list_please_try_again||"Could not fetch templates list. Please try again.");return}this.templatesList=n},loadTemplate(r){if(r==null)return;const e=this.templatesList.find(n=>n.id==r);if(!e)return toastr.error(magicai_localize.could_not_fetch_template_data_please_try_again||"Could not fetch template data. Please try again.");this.importData(e.data)},handleWindowResize(){window.addEventListener("resize",this.onWindowResize)},onWindowResize(){this.setContainerDimensions()},setActiveTooltipDropdown(r){if(!r||this.activeTooltipDropdown===r)return this.activeTooltipDropdown=null;this.activeTooltipDropdown=r},elementIsFocusable(r,e=[]){if(!r||!(r instanceof HTMLElement))return;const n=["INPUT","BUTTON","TEXTAREA","SELECT","A"];return Ee.difference(n,e).includes(r.tagName)},async aiTextAction({prompt:r=""}){if(!r.trim())return;const e=this.selectedNodes.filter(n=>n.getClassName()==="Text");e.length&&e.forEach(async n=>{const o=`request-${n.id()}`,a=new FormData;a.append("lock_key",o),a.append("prompt",r),a.append("content",n.text()),this.aiTasksQueue.push(o),n.setAttr("aiTaskInProgress",!0);const l=await fetch("/dashboard/user/openai/update-writing",{method:"POST",body:a,headers:{Accept:"application/json"}});this.aiTasksQueue=this.aiTasksQueue.filter(h=>h===o),n.setAttr("aiTaskInProgress",!1);const u=await l.json();if(u.type==="error"){toastr.error(u.message);return}u.result&&n.text(u.result)})},async generateUploadingImage(r){const n=await(await fetch(r)).blob();return new File([n],"image",{type:n.type})},async aiImageAction(r){const e=this.selectedNodes.filter(n=>n.getClassName()==="Image"||n.fillPatternImage());e.length&&e.forEach(async n=>{var y,S;const o=`request-${n.id()}`,a=new FormData(r.target),l=Math.min(720,n.width()),u=Math.min(720,n.getAttr("fillImageWidth")??720),h=await n.toBlob({pixelRatio:Math.min(2,Math.max(1,u/l))}),f=new File([h],"image",{type:h.type});a.append("lock_key",o),a.append("uploaded_image",f),this.aiTasksQueue.push(o),n.setAttr("aiTaskInProgress",!0);const g=await fetch(r.target.action,{method:"POST",body:a,headers:{Accept:"application/json"}});if(this.aiTasksQueue=this.aiTasksQueue.filter(x=>x===o),n.setAttr("aiTaskInProgress",!1),!g.ok)return g.json().then(x=>{toastr.error(x.message||"An unknown error occurred")});const v=await g.json();if(v.type==="error"){toastr.error(v.message);return}((y=v==null?void 0:v.data)==null?void 0:y.status)==="CREATED"||((S=v==null?void 0:v.data)==null?void 0:S.status)==="IN_PROGRESS"?this.getAIImageStatus(v.data,n,o):this.onAIImageProcessDone(v.data,n,o)})},async getAIImageStatus(r={},e,n){const o=await fetch("/dashboard/user/advanced-image/editor/"+r.id+"/status",{method:"GET",headers:{Accept:"application/json"}});if(!o.ok)return o.json().then(l=>{toastr.error(l.message||"An unknown error occurred")});const a=await o.json();if(a.status==="error")return toastr.error(a.message);a.data.status==="COMPLETED"?this.onAIImageProcessDone(a.data,e,n):setTimeout(()=>{this.getAIImageStatus(a.data,e,n)},1e3)},onAIImageProcessDone(r,e,n){console.log(r)}});var Cw=Object.defineProperty,Bh=(r,e)=>{for(var n in e)Cw(r,n,{get:e[n],enumerable:!0})},xw={};Bh(xw,{lerp:()=>zh,makeCurveEasings:()=>qh,pointOnCurve:()=>Hh,scaleSpreadArray:()=>Aw,shuffleArray:()=>Wh});function Wh(r,e=Math.random){const n=[...r];let o=n.length,a;for(;o!=0;)a=Math.floor(e()*o),o--,[n[o],n[a]]=[n[a],n[o]];return n}var zh=(r,e,n)=>e+r*(n-e),Aw=(r,e,n=zh)=>{if(!r||r.length<2)throw new Error("valuesToFill array must have at least two values.");if(e<r.length)throw new Error("Target size must be greater than or equal to the valuesToFill array length.");const o=e-r.length,a=r.map(l=>[l]);for(let l=0;l<o;l++)a[l%(r.length-1)].push(null);for(let l=0;l<a.length-1;l++){const u=a[l],h=a[l+1],f=u[0],g=h[0];for(let v=1;v<u.length;v++){const y=v/u.length;u[v]=n(y,f,g)}}return a.flat()},Hh=(r,e)=>n=>{const o=Math.PI/2,a=o/1,l=n;let u=0,h=0;if(r==="lamé"){const f=l*o,g=2/(2+20*e),v=Math.cos(f),y=Math.sin(f);u=Math.sign(v)*Math.abs(v)**g,h=Math.sign(y)*Math.abs(y)**g}else if(r==="arc")h=Math.cos(-Math.PI/2+n*a+e),u=Math.sin(Math.PI/2+n*a-e);else if(r==="pow")u=Math.pow(1-l,1-e),h=Math.pow(l,1-e);else if(r==="powY")u=Math.pow(1-l,e),h=Math.pow(l,1-e);else if(r==="powX")u=Math.pow(l,e),h=Math.pow(l,1-e);else if(typeof r=="function"){const[f,g]=r(n,e);u=f,h=g}else throw new Error(`pointOnCurve() curveAccent parameter is expected to be "lamé" | "arc" | "pow" | "powY" | "powX" or a function but \`${r}\` given.`);return{x:u,y:h}},qh=(r,e)=>{const n=Hh(r,e);return{sEasing:o=>n(o).x,lEasing:o=>n(o).y}},Ja={};Bh(Ja,{colorHarmonies:()=>Iw,colorToCSS:()=>Mw,harveyHue:()=>Tw,hsv2hsl:()=>Uh,normalizeHue:()=>mt,uniqueRandomHues:()=>Dw});function mt(r){return(r%360+360)%360}function Tw(r){if(r=mt(r)/360,r===1||r===0)return r;r=1+r%1;const e=1/6,n=r%e/e*Math.PI/2,[o,a]=[e*Math.cos(n),e*Math.sin(n)],l=Math.floor(r*6);return[a,1/3-o,1/3+a,2/3-o,2/3+a,1-o][l%6]*360}var Iw={complementary:r=>[mt(r),mt(r+180)],splitComplementary:r=>[mt(r),mt(r+150),mt(r-150)],triadic:r=>[mt(r),mt(r+120),mt(r+240)],tetradic:r=>[mt(r),mt(r+90),mt(r+180),mt(r+270)],monochromatic:r=>[mt(r),mt(r)],doubleComplementary:r=>[mt(r),mt(r+180),mt(r+30),mt(r+210)],compound:r=>[mt(r),mt(r+180),mt(r+60),mt(r+240)],analogous:r=>[mt(r),mt(r+30),mt(r+60),mt(r+90),mt(r+120),mt(r+150)]};function Dw({startHue:r=0,total:e=9,minHueDiffAngle:n=60,rndFn:o=Math.random}={}){n=Math.min(n,360/e);const a=r||o()*360,l=Array.from({length:Math.round(360/n)},(h,f)=>(a+f*n)%360);let u=Wh(l,o);return u.length>e&&(u=u.slice(0,e)),u}var Uh=([r,e,n])=>{const o=n-n*e/2,a=Math.min(o,1-o),l=a===0?0:(n-o)/a;return[r,l,o]},Pw={oklch:r=>[r[2]*100+"%",r[1]*100+"%",r[0]],lch:r=>[r[2]*100+"%",r[1]*100+"%",r[0]],hsl:r=>[r[0],r[1]*100+"%",r[2]*100+"%"],hsv:r=>{const[e,n,o]=Uh(r);return[e,n*100+"%",o*100+"%"]}},Mw=(r,e="oklch")=>`${e==="hsv"?"hsl":e}(${Pw[e](r).join(" ")})`;function ja({total:r=9,hStart:e=Math.random()*360,hStartCenter:n=.5,hEasing:o=y=>y,hCycles:a=1,sRange:l=[.4,.35],sEasing:u=y=>Math.pow(y,2),lRange:h=[Math.random()*.1,.9],lEasing:f=y=>Math.pow(y,1.5),transformFn:g=([y,S,x])=>[y,S,x],hueList:v}={}){const y=h[1]-h[0],S=l[1]-l[0],x=v&&v.length>0?v.length:r;return Array.from({length:x},(I,R)=>{const k=R/(x-1),Z=1/x,F=v?v[R]:mt(e+(1-o(k,Z)-n)*(360*a)),H=l[0]+S*u(k,Z),Q=h[0]+y*f(k,Z);return g([F,H,Q],R)})}var Rw=({total:r=9,hStart:e=Math.random()*360,hStartCenter:n=.5,hCycles:o=1,sRange:a=[.4,.35],lRange:l=[Math.random()*.1,.9],hueList:u,curveMethod:h="lamé",curveAccent:f=.5,transformFn:g=([v,y,S])=>[v,y,S]}={})=>{const{sEasing:v,lEasing:y}=qh(h,f);return ja({total:r,hStart:e,hStartCenter:n,hCycles:o,sRange:a,lRange:l,sEasing:v,lEasing:y,transformFn:g,hueList:u})};function Nw(){return{options:{},styleTag:document.querySelector("#lqd-customizer-style"),darkMode:document.body.classList.contains("theme-dark"),rootStyles:null,styleString:"",lqdFontPreview:[],googleFontsList:[],showingGoogleFonts:[],fontsPaginationCurrent:20,fontsPaginationLimit:20,loadingFontPreviewQueue:[],localStorageKey:"lqdCustomizerStyle",cssSelectors:{light:":root",dark:".theme-dark"},init(){const r=document.body.getAttribute("data-theme");this.localStorageKey=r+":"+this.localStorageKey,this.onImportStyles=_.throttle(this.onImportStyles.bind(this),300,{leading:!1}),this.loadGoogleFontPreview=_.throttle(this.loadGoogleFontPreview.bind(this),300,{leading:!1}),this.options=window.lqdCustomizerOptions,this.googleFontsList=window.lqdGoogleFontsList,this.currentEdits=this.readFromLocalStorage();const e=document.body.classList.contains("theme-dark");this.rootStyles=getComputedStyle(e?document.body:document.documentElement),Object.entries(this.options).forEach(([n])=>{this.options[n].type==="color"&&(this.options[n].values={},this.options[n].values.light={},this.options[n].values.dark={})}),this.$watch("$store.darkMode.on",n=>{this.darkMode=n,this.rootStyles=getComputedStyle(n?document.body:document.documentElement)}),this.$watch("options",this.updateOutputs.bind(this)),this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit),this.currentEdits&&this.onImportStyles(this.currentEdits)},setStyleStrings(){let r="",e="";if(Object.entries(this.options).forEach(([n,o])=>{var f,g;const a=o.type==="font",l=o.cssVar;let u=o.value,h=null;(f=o.values)!=null&&f.light&&(u=o.values.light.twHsl),(g=o.values)!=null&&g.dark&&(h=o.values.dark.twHsl),u&&(r+=`	${l}: ${a?`'${u}'`:u};
`),h&&(e+=`	${l}: ${h};
`)}),!r.length&&!e.length)return this.styleString="";this.styleString=`${this.cssSelectors.light} {
${r}}`,e.length&&(this.styleString+=`
${this.cssSelectors.dark} {
${e}}`)},updateOutputs(){this.setStyleStrings(),this.fillStyleTag(),this.writeToLocalStorage()},fillStyleTag(){if(!this.styleTag)return console.error("Style tag not found");this.styleTag.innerText=this.styleString.replace(/[\n\t]/g,"")},onColorInput({key:r,color:e,manipulations:n=[],assosiatedKeys:o=[]}){var u;if(((u=this.options[r])==null?void 0:u.type)!=="color")return;const a=this.parseColor({color:e,format:["twHsl","hex"],manipulations:n}),l=this.darkMode?"dark":"light";this.options[r].values[l]={twHsl:a.twHsl,hex:a.hex},o.length&&o.forEach(({key:h,color:f,manipulations:g})=>{this.onColorInput({key:h,color:f||e,manipulations:g})})},parseColor({color:r,format:e="hsl",manipulations:n=[]}){const o=typeof r=="string";let a=o?r.trim():r;o&&(/^--[\w-]+$/.test(r)&&(a=this.rootStyles.getPropertyValue(r).trim()),/\S+\s+\S+/.test(a)&&!a.startsWith("hsl")&&(a=`hsl(${a})`));let l=tinycolor(a);if(n.length&&n.forEach(({type:u,value:h,condition:f})=>{if(!(f==="lightMode"&&this.darkMode||f==="darkMode"&&!this.darkMode)){if(u==="autoBlackWhite")return l=l.getLuminance()>=.4?tinycolor("#000"):tinycolor("#fff");l=l[u](h)}}),Array.isArray(e)){const u={};return e.forEach(h=>{u[h]=this.getColorString(l,h)}),u}return this.getColorString(l,e)},getColorString(r,e="hsl"){if(e==="colorObj")return r;if(e==="twHsl"){const n=r.toHsl();return`${Math.ceil(n.h)} ${Math.ceil(n.s*100)}% ${Math.ceil(n.l*100)}%${n.a&&n.a!==1?` / ${Math.ceil(n.a*100)}%`:""}`}return r.toString(e)},randomColors(){const r=tinycolor.random();let e=[.25,1],n=[1,.05];this.darkMode&&(e[1]=.7,n=n.reverse());const o=ja({total:7,hStart:r.toHsl().h,hStartCenter:0,hCycles:.75,hEasing:(Ct,Mt)=>Ct+(-Mt+Math.random()*Mt*2)*.5,sRange:e,lRange:n,sEasing:(Ct,Mt)=>Ct+(-Mt+Math.random()*Mt*2)*.5,lEasing:(Ct,Mt)=>Ct+(-Mt+Math.random()*Mt*2)*.5}),a=Rw({hueList:Ja.colorHarmonies.splitComplementary(r.toHsl().h),sRange:e.reverse(),lRange:n.reverse(),curveMethod:"arc",curveAccent:.01}),l=ja({hueList:Ja.uniqueRandomHues({startHue:0,total:4,minDistance:90}),sRange:[.5,.9],lRange:[.5,.9]}),u=Math.floor(o.length/2),h=o[u],f=o[u-1],g=o[u+1],v=o[0],y=o[o.length-1],S=o[1],x=Math.floor(a.length/2),I=a[a.length-1],R=a[0],k=a[x],Z=l[0],F=l[1],H=l[2],Q=tinycolor({h:h[0],s:h[1],l:h[2]}),gt=tinycolor({h:f[0],s:Math.min(1,f[1]),l:Math.min(1,f[2])}),ht=tinycolor({h:g[0],s:Math.min(1,g[1]),l:Math.min(1,g[2])}),bt=tinycolor({h:y[0],s:Math.min(1,y[1]),l:Math.min(1,y[2])}),$t=tinycolor({h:v[0],s:Math.min(1,v[1]),l:Math.min(1,v[2])}).desaturate(this.darkMode?30:0),ft=tinycolor({h:S[0],s:Math.min(1,S[1]),l:Math.min(1,S[2])}).desaturate(20).setAlpha(.55),le=tinycolor({h:I[0],s:Math.min(1,I[1]),l:Math.min(1,I[2])}).desaturate(this.darkMode?30:0),Bt=tinycolor({h:R[0],s:Math.min(1,R[1]),l:Math.min(1,R[2])}),ue=tinycolor({h:k[0],s:Math.min(1,k[1]),l:Math.min(1,k[2])})[this.darkMode?"lighten":"darken"](30),Pt=tinycolor({h:Z[0],s:Math.min(1,Z[1]),l:Math.min(1,Z[2])}),Ht=tinycolor({h:F[0],s:Math.min(1,F[1]),l:Math.min(1,F[2])}),ce=tinycolor({h:H[0],s:Math.min(1,H[1]),l:Math.min(1,H[2])});this.onColorInput({key:"colorMainPrimary",color:Q,assosiatedKeys:[{key:"colorMainPrimaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainSecondary",color:gt,assosiatedKeys:[{key:"colorMainSecondaryForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainAccent",color:ht,assosiatedKeys:[{key:"colorMainAccentForeground",manipulations:[{type:"autoBlackWhite"}]}]}),this.onColorInput({key:"colorMainForeground",color:bt,assosiatedKeys:[{key:"colorMainHeadingForeground",manipulations:[{type:"darken",value:22,condition:"lightMode"},{type:"lighten",value:30,condition:"darkMode"},{type:"desaturate",value:7,condition:"lightMode"},{type:"desaturate",value:30,condition:"darkMode"}]}]}),this.onColorInput({key:"colorMainBackground",color:$t}),this.onColorInput({key:"colorMainBorder",color:ft}),this.onColorInput({key:"colorNavbarBackground",color:le}),this.onColorInput({key:"colorNavbarForeground",color:Bt}),this.onColorInput({key:"colorNavbarActiveBackground",color:ue,assosiatedKeys:[{key:"colorNavbarActiveForeground"},{key:"colorNavbarHoverForeground"},{key:"colorNavbarHoverBackground"}]}),this.onColorInput({key:"colorMainGradientFrom",color:Pt}),this.onColorInput({key:"colorMainGradientVia",color:Ht}),this.onColorInput({key:"colorMainGradientTo",color:ce})},addToGoogleFontLoadQueue(r,e=!1){if(!(e&&this.lqdFontPreview.includes(r))){if(!e)return this.loadGoogleFontFull(r);this.loadingFontPreviewQueue.push(r),this.loadGoogleFontPreview(r),this.lqdFontPreview.push(r)}},loadGoogleFontPreview(){if(!this.loadingFontPreviewQueue.length)return;const r=this.loadingFontPreviewQueue.map(o=>`family=${o}`).join("&").replaceAll(" ","+"),e=encodeURIComponent(this.loadingFontPreviewQueue.join("")),n=`https://fonts.googleapis.com/css2?${r}&display=swap&text=${e}`;this.createLink(n),this.loadingFontPreviewQueue=[]},loadGoogleFontFull(r){const e=`https://fonts.googleapis.com/css2?family=${r.replaceAll(/ /g,"+")}&display=swap`;this.createLink(e)},createLink(r){const e=document.createElement("link");e.href=r,e.rel="stylesheet",e.type="text/css",document.head.appendChild(e)},onImportStyles(r){if(!r)return;let e=r.trim();const n={},o=/([\w\s\.\:\-\#]+)\s*\{([^}]*)\}/g;let a;for(;(a=o.exec(e))!==null;){const l=a[1].trim(),u=a[2].trim().split(";").filter(Boolean);n[l]=n[l]||[];for(const h of u){const f=h.indexOf(":");if(f>0){const g=h.slice(0,f).trim(),v=h.slice(f+1).trim();g&&v&&n[l].push({property:g,value:v})}}}Object.entries(this.options).forEach(([l,u])=>{const h=u.cssVar;Object.entries(this.cssSelectors).forEach(([f,g])=>{var S;const v=(S=n[g])==null?void 0:S.find(x=>x.property===h);if(!v)return;const y=this.sanitizeCssValue(v.value);if(u.type==="color"){const x=this.parseColor({color:y,format:["twHsl","hex"]});this.options[l].values[f].twHsl=x.twHsl,this.options[l].values[f].hex=x.hex}else if(u.type==="font"){const x=y.replace(/['"]/g,"");this.options[l].value=x,this.addToGoogleFontLoadQueue(x)}else this.options[l].value=y})})},sanitizeCssValue(r){if(!r)return"";r=r.replace(/javascript:/gi,"").replace(/expression\(/gi,"").replace(/eval\(/gi,"").replace(/url\(/gi,"").replace(/data:/gi,""),r=r.replace(/[^\w\s,.#:;%\/\-+()[\]@!~="'*]/g,"");const e=(r.match(/'/g)||[]).length,n=(r.match(/"/g)||[]).length;return e%2!==0&&(r=r.replace(/'/g,"")),n%2!==0&&(r=r.replace(/"/g,"")),r},resetStyles(){Object.entries(this.options).forEach(([r,e])=>{e.type==="color"?(this.options[r].values.light={},this.options[r].values.dark={}):e.type==="font"?this.options[r].value="":this.options[r].value=""})},readFromLocalStorage(){let r=localStorage.getItem(this.localStorageKey);return r||(r=this.styleTag.textContent),r},writeToLocalStorage(){const r=this.styleString.replace(/[\n\t]/g,"");if(!r){this.emptyLocalStorage();return}localStorage.setItem(this.localStorageKey,r)},emptyLocalStorage(){localStorage.removeItem(this.localStorageKey)},saveAndClose(){this.setBackEnd(this.styleString??"")},discardChanges(){var e,n;!(((n=(e=this.currentEdits)==null?void 0:e.replace(/[\n\t]/g,""))==null?void 0:n.trim())??"").length&&this.resetStyles(),this.emptyLocalStorage(),this.setBackEnd("",!0)},async setBackEnd(r="",e=!1){const n={};Object.entries(this.options).forEach(([l,u])=>{u.type==="font"&&(n[l]=u.value)});const o=await fetch("/dashboard/admin/live-customizer",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({style:r,fonts:n,clear:e})});let a=await o.json();if(!o.ok){toastr.error("Error uploading the customizer styles");return}if(a.status==="success"){toastr.success(a.message),setTimeout(()=>{this.emptyLocalStorage(),window.location.reload()},1e3);return}toastr.error(a.message??"Error uploading the customizer styles")}}}function Ow(r){return{dropdownOpen:!1,selectedFont:"",searchString:"",init(){this.$watch("selectedFont",e=>{this.options[r].value=e})},onSearchInput(){const e=this.$event.target.value.trim();if(!e){this.fontsPaginationCurrent=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationLimit);return}this.showingGoogleFonts=this.googleFontsList.filter(n=>n.toLowerCase().includes(e.toLowerCase()))},loadMoreFonts(){this.fontsPaginationCurrent+=this.fontsPaginationLimit,this.showingGoogleFonts=this.googleFontsList.slice(0,this.fontsPaginationCurrent)}}}q.store("realtimeChatStatus",{active:!1,conversationStarted:!1,setActive(r){this.active=r,this.onActiveChange()},setConversationStarted(r){this.conversationStarted=r,this.onConversationStartedChange()},onActiveChange(){var r,e;document.querySelectorAll(".lqd-realtime-chat-button").forEach(n=>n.classList.toggle("active",this.active)),(e=(r=document.querySelector(".lqd-audio-vis-wrap"))==null?void 0:r.classList)==null||e.toggle("active",this.active)},onConversationStartedChange(){const r=document.querySelector(".chats-wrap");r.classList.toggle("conversation-started",this.conversationStarted),r.classList.toggle("conversation-not-started",!this.conversationStarted),document.querySelectorAll(".lqd-realtime-chat-button").forEach(e=>{e.classList.toggle("conversation-started",this.conversationStarted),e.classList.toggle("conversation-not-started",!this.conversationStarted)})}});const Lw=r=>({agentId:r,recordingActive:!1,buffer:new Uint8Array,conversation:null,audioRecorder:null,audioPlayer:null,activeVisulaizer:"idle",audioVisWrap:null,audioVisBars:null,audioVisDotWrap:null,audioVisLoader:null,conversationArea:document.querySelector(".conversation-area"),chatsContainer:document.querySelector(".chats-container"),userBubbleTemplate:document.querySelector("#chat_user_bubble"),aiBubbleTemplate:document.querySelector("#chat_ai_bubble"),lastAiBubble:null,lastUserBubble:null,lastUserQuestion:"",lastAiResponse:"",lastResponseSaved:!1,init(){var e,n,o;this.audioVisWrap=document.querySelector(".lqd-audio-vis-wrap"),this.audioVisBars=(e=this.audioVisWrap)==null?void 0:e.querySelectorAll(".lqd-audio-vis-bar"),this.audioVisDotWrap=(n=this.audioVisWrap)==null?void 0:n.querySelector(".lqd-audio-vis-dot-wrap"),this.audioVisLoader=(o=this.audioVisWrap)==null?void 0:o.querySelector(".lqd-audio-vis-loader"),this.processAudioRecordingBuffer=this.processAudioRecordingBuffer.bind(this)},async start(){if(q.store("realtimeChatStatus").isActive)return;q.store("realtimeChatStatus").setActive(!0),this.switchVisualizers("waiting");const e=await this.checkBalance(!0);if(e.shouldStop){toastr.error(e.errorMsg),this.stop();return}this.conversation=await $b.startSession({agentId:this.agentId,onConnect:async()=>{await Promise.all([this.startRecorder(),this.startPlayer()]).then(()=>{this.startBarsVisualizer(),this.startDotVisualizer(),this.switchVisualizers("idle"),q.store("realtimeChatStatus").setConversationStarted(!0)}).catch(n=>{this.stop(),console.error("Error starting recorder and player:",n),this.appendToChatBubble("ai","[Error]: Unable to start audio recorder and player. Please check your microphone permissions and refresh the page.")})},onDisconnect:()=>{var n;this.disconnectHandle((n=this.conversation)==null?void 0:n.connection),this.stop()},onModeChange:n=>{this.checkBalance().then(o=>{if(o.shouldStop){this.stop(),toastr.error(o.errorMsg);return}})},onMessage:n=>{n.source=="ai"?(this.createChatBubble("ai"),this.appendToChatBubble("ai",n.message),this.lastAiResponse=n.message,"saveResponseAsync"in window&&(saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.lastResponseSaved=!0),"formatString"in window&&this.lastAiBubble&&(this.lastAiBubble.innerHTML=formatString(this.lastAiResponse)),this.lastAiResponse=this.lastUserQuestion=""):(this.createChatBubble("user"),this.appendToChatBubble("user",n.message),this.lastUserQuestion+=" "+n.message,this.lastResponseSaved=!1)},onError:n=>{console.error("Error:",n),this.stop()}})},async stop(){!this.lastResponseSaved&&"saveResponseAsync"in window&&this.lastUserQuestion.trim()!==""&&this.lastAiResponse.trim()!==""&&saveResponseAsync(this.lastUserQuestion.trim(),this.lastAiResponse.trim(),document.querySelector("#chat_id").value,"","","","","elevenlabs-voice-chatbot"),this.resetPlayers(),this.conversation&&(await this.conversation.endSession(),this.conversation=null),this.switchVisualizers(""),q.store("realtimeChatStatus").setActive(!1)},async startPlayer(){try{this.audioPlayer=new $h,await this.audioPlayer.init(24e3)}catch(e){console.error("Error starting audio player:",e)}},async startRecorder(){try{this.audioRecorder=new ch(this.processAudioRecordingBuffer);const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});await this.audioRecorder.start(e),this.recordingActive=!0}catch(e){console.error("Error starting audio recorder:",e)}},combineArray(e){const n=new Uint8Array(this.buffer.length+e.length);n.set(this.buffer),n.set(e,this.buffer.length),this.buffer=n},processAudioRecordingBuffer(e){const n=new Uint8Array(e);if(this.combineArray(n),this.buffer.length>=4800){const o=new Uint8Array(this.buffer.slice(0,4800));this.buffer=new Uint8Array(this.buffer.slice(4800));const a=String.fromCharCode(...o);btoa(a)}},async resetPlayers(){var e,n;this.recordingActive=!1,(e=this.audioRecorder)==null||e.stop(),(n=this.audioPlayer)==null||n.clear()},getSystemMessage(){return""},getTemperature(){return parseFloat(.8)},getVoice(){return"alloy"},switchVisualizers(e){var n;this.activeVisulaizer=e,(n=this.audioVisWrap)==null||n.setAttribute("data-state",this.activeVisulaizer)},createChatBubble(e){const o=(e==="user"?this.userBubbleTemplate:this.aiBubbleTemplate).content.cloneNode(!0),a=o.querySelector(".chat-content");this.chatsContainer.appendChild(o),e==="user"?this.lastUserBubble=a:this.lastAiBubble=a,this.scrollConversationAreaToBottom()},appendToChatBubble(e,n){const o=e==="user"?this.lastUserBubble:this.lastAiBubble;o?(o.textContent+=n,this.scrollConversationAreaToBottom()):(this.createChatBubble(e),this.appendToChatBubble(e,n))},scrollConversationAreaToBottom(){this.conversationArea.scrollTo({top:this.conversationArea.scrollHeight+200,left:0})},startBarsVisualizer(){var h;if(!((h=this.audioVisBars)!=null&&h.length))return;const e=this.audioPlayer.audioContext.createAnalyser();e.fftSize=4096;const n=e.frequencyBinCount,o=new Uint8Array(n),a=this.audioVisBars.length;this.audioPlayer.playbackNode.connect(e);const l=[[85,150],[150,250],[250,400],[400,600],[600,1e3]];this.barHeights=this.barHeights||new Array(a).fill(0);const u=()=>{e.getByteFrequencyData(o),this.audioVisBars.forEach((f,g)=>{const[v,y]=l[g],S=Math.floor(v/(this.audioPlayer.audioContext.sampleRate/e.fftSize)),x=Math.ceil(y/(this.audioPlayer.audioContext.sampleRate/e.fftSize));let I=0;for(let k=S;k<=x&&k<o.length;k++)o[k]>I&&(I=o[k]);let R=I/255*80;this.barHeights[g]+=(R-this.barHeights[g])*.4,this.barHeights[g]+=(Math.random()-.5)*2,this.barHeights[g]=Math.max(5,Math.min(100,this.barHeights[g])),f.animate([{height:f.style.height},{height:`${this.barHeights[g]}%`}],{duration:30,fill:"forwards",easing:"linear"})}),requestAnimationFrame(u)};u()},startDotVisualizer(){if(!this.audioRecorder||!this.audioVisDotWrap)return;const e=this.audioRecorder.audioContext.createAnalyser();e.fftSize=256;const n=e.frequencyBinCount,o=new Uint8Array(n);this.audioRecorder.getMediaStreamSource().connect(e);const a=this.audioVisDotWrap.querySelector(".lqd-audio-vis-dot");if(!a)return;const l=()=>{e.getByteFrequencyData(o);let u=0;for(let v=0;v<n;v++)u+=o[v];const f=1+u/n/256*1.5,g=Math.max(.2,1-(f-1)/1.5);a.style.transform=`scale(${f})`,a.style.opacity=g.toFixed(2),requestAnimationFrame(l)};l()},checkBalance(e=!1){return new Promise(n=>{$.ajax({url:"/dashboard/admin/voice-chatbot/check-balance",type:"POST",data:{onStart:e},dataType:"json",success:o=>{const a=o.status!=="success",l=o.message||"";n({shouldStop:a,errorMsg:l})},error:()=>{n({shouldStop:!0,errorMsg:"An error occurred."})}})})},disconnectHandle(e){var n,o;((n=e==null?void 0:e.disconnectionDetails)==null?void 0:n.reason)=="error"&&(toastr.error("Something went wrong. Please contact support for assistance"),console.error((o=e==null?void 0:e.disconnectionDetails)==null?void 0:o.message))}});window.fetchEventSource=Lb;const kw=localStorage.getItem("lqdDarkMode"),Fw=localStorage.getItem("docsViewMode"),$w=localStorage.getItem("socialMediaPostsViewMode"),Bw=localStorage.getItem("lqdNavbarShrinked"),Gh=document.querySelector("body").getAttribute("data-theme"),Ww=localStorage.getItem(Gh+":lqdFocusModeEnabled");window.collectCreditsToFormData=function(r){document.querySelectorAll('input[name^="entities"]').forEach(n=>{const o=n.name,a=n.type==="checkbox"||n.type==="radio"?n.checked:n.value;r.append(o,a)})};window.Alpine=q;q.plugin(kb);q.plugin(w0);q.plugin(x0);X.mount(new ew);document.addEventListener("alpine:init",()=>{const r=q.$persist;q.data("modal",e=>iw(e)),q.data("clipboard",e=>Fb(e)),q.data("assignViewCredits",e=>rw(e)),q.store("navbarShrink",{active:r(!!Bw).as("lqdNavbarShrinked"),toggle(e){this.active=e?e==="shrink":!this.active,document.body.classList.toggle("navbar-shrinked",this.active)}}),q.data("navbarItem",()=>({dropdownOpen:!1,toggleDropdownOpen(e){this.dropdownOpen=e?e==="collapse":!this.dropdownOpen},item:{"x-ref":"item","@mouseenter"(){if(!q.store("navbarShrink").active)return;const e=this.$el.getBoundingClientRect(),n=this.$refs.item.querySelector(".lqd-navbar-dropdown");if(["y","height","bottom"].forEach(o=>this.$refs.item.style.setProperty(`--item-${o}`,`${e[o]}px`)),n){const o=n.getBoundingClientRect();["height"].forEach(a=>this.$refs.item.style.setProperty(`--dropdown-${a}`,`${o[a]}px`))}}}})),q.data("navbarLink",({isDemo:e=!1})=>({isDemo:e,isActive:!1,dropdown:null,dropdownItems:[],dropdownLinks:[],init(){const n=this.$el.closest(".lqd-navbar-inner");this.dropdown=this.$el.nextElementSibling&&this.$el.nextElementSibling.classList.contains("lqd-navbar-dropdown")&&this.$el.nextElementSibling,this.dropdownItems=this.dropdown?this.dropdown.querySelectorAll(".lqd-navbar-dropdown-link"):[],this.dropdownItems.forEach(o=>this.dropdownLinks.push(o.href)),this.isActive=this.$el.href===window.location.href||this.dropdownLinks.includes(window.location.href),this.$el.classList.toggle("active",this.isActive),this.$nextTick(()=>{var o,a;(a=(o=this.dropdown)==null?void 0:o.classList)==null||a.toggle("hidden",!this.isActive),n&&!this.isDemo&&this.isActive&&this.$el.parentElement.offsetTop+this.$el.parentElement.offsetHeight>window.innerHeight&&n.scrollTo({top:this.$el.parentElement.offsetTop-window.innerHeight/2})})}})),q.store("mobileNav",{navCollapse:!0,toggleNav(e){this.navCollapse=e?e==="collapse":!this.navCollapse},templatesCollapse:!0,toggleTemplates(e){this.templatesCollapse=e?e==="collapse":!this.templatesCollapse},searchCollapse:!0,toggleSearch(e){this.searchCollapse=e?e==="collapse":!this.searchCollapse}}),q.store("darkMode",{on:r(!!kw).as("lqdDarkMode"),toggle(){this.on=!this.on,document.body.classList.toggle("theme-dark",this.on),document.body.classList.toggle("theme-light",!this.on)}}),q.store("appLoadingIndicator",{showing:!1,show(){this.showing=!0},hide(){this.showing=!1},toggle(){this.showing=!this.showing}}),q.store("docsViewMode",{docsViewMode:r(Fw||"list").as("docsViewMode"),change(e){this.docsViewMode=e}}),q.store("generatorsFilter",{init(){const e=new URLSearchParams(window.location.search);this.filter=e.get("filter")||"all"},filter:"all",changeFilter(e){if(this.filter!==e){if(!document.startViewTransition)return this.filter=e;document.startViewTransition(()=>this.filter=e)}}}),q.data("generatorItem",()=>({get isHidden(){return this.$store.generatorsFilter.filter!=="all"&&this.$el.getAttribute("data-filter").search(this.$store.generatorsFilter.filter)<0},updateDataFilter(e,n){const o=this.$el.getAttribute("data-filter"),a=new Set(o.split(","));n?a.add("favorite"):a.delete("favorite"),this.$el.setAttribute("data-filter",Array.from(a).join(","))}})),q.store("documentsFilter",{init(){const e=new URLSearchParams(window.location.search);this.sort=e.get("sort")||"created_at",this.sortAscDesc=e.get("sortAscDesc")||"desc",this.filter=e.get("filter")||"all",this.page=e.get("page")||"1"},sort:"created_at",sortAscDesc:"desc",filter:"all",page:"1",changeSort(e){e===this.sort?this.sortAscDesc=this.sortAscDesc==="desc"?"asc":"desc":this.sortAscDesc="desc",this.sort=e},changeAscDesc(e){this.ascDesc!==e&&(this.ascDesc=e)},changeFilter(e){this.filter!==e&&(this.filter=e)},changePage(e){(e===">"||e==="<")&&(e=e===">"?Number(this.page)+1:Number(this.page)-1),this.page!==e&&(this.page=e)}}),q.store("socialMediaPostsViewMode",{socialMediaPostsViewMode:r($w||"list").as("socialMediaPostsViewMode"),change(e){this.socialMediaPostsViewMode=e}}),q.store("socialMediaPostsFilter",{init(){const e=new URLSearchParams(window.location.search);this.sort=e.get("sort")||"created_at",this.sortAscDesc=e.get("sortAscDesc")||"desc",this.filter=e.get("filter")||"all",this.page=e.get("page")||"1"},sort:"created_at",sortAscDesc:"desc",filter:"all",page:"1",changeSort(e){e===this.sort?this.sortAscDesc=this.sortAscDesc==="desc"?"asc":"desc":this.sortAscDesc="desc",this.sort=e},changeAscDesc(e){this.ascDesc!==e&&(this.ascDesc=e)},changeFilter(e){this.filter!==e&&(this.filter=e)},changePage(e){(e===">"||e==="<")&&(e=e===">"?Number(this.page)+1:Number(this.page)-1),this.page!==e&&(this.page=e)}}),q.store("chatsFilter",{init(){const e=new URLSearchParams(window.location.search);this.filter=e.get("filter")||"all",this.setSearchStr(e.get("search")||"")},searchStr:"",setSearchStr(e){this.searchStr=e.trim().toLowerCase()},filter:"all",changeFilter(e){if(this.filter!==e){if(!document.startViewTransition)return this.filter=e;document.startViewTransition(()=>this.filter=e)}}}),q.data("generatorV2",()=>({itemsSearchStr:"",setItemsSearchStr(e){this.itemsSearchStr=e.trim().toLowerCase(),this.itemsSearchStr!==""?this.$el.closest(".lqd-generator-sidebar").classList.add("lqd-showing-search-results"):this.$el.closest(".lqd-generator-sidebar").classList.remove("lqd-showing-search-results")},sideNavCollapsed:!1,toggleSideNavCollapse(e){var n,o;this.sideNavCollapsed=e?e==="collapse":!this.sideNavCollapsed,this.sideNavCollapsed&&(typeof tinymce<"u"&&(tinymce!=null&&tinymce.activeEditor)?(n=tinymce==null?void 0:tinymce.activeEditor)==null||n.focus():(o=window.editorJS)==null||o.focus())},generatorStep:0,setGeneratorStep(e){if(e!==this.generatorStep){if(!document.startViewTransition)return this.generatorStep=Number(e);document.startViewTransition(()=>this.generatorStep=Number(e))}},selectedGenerator:null})),q.store("mobileChat",{sidebarOpen:!1,toggleSidebar(e){this.sidebarOpen=e?!1:!this.sidebarOpen}}),q.data("dropdown",({triggerType:e="hover"})=>({open:!1,toggle(n){this.open=n?n!=="collapse":!this.open,this.$refs.parent.classList.toggle("lqd-is-active",this.open)},parent:{"@mouseenter"(){e==="hover"&&this.toggle("expand")},"@mouseleave"(){e==="hover"&&this.toggle("collapse")},"@click.outside"(){this.toggle("collapse")}},trigger:{"@click.prevent"(){this.toggle()}},dropdown:{}})),q.store("notifications",{notifications:[],loading:!1,add(e){this.notifications.unshift(e)},remove(e){this.notifications.splice(e,1)},markThenHref(e){const n=this.notifications.indexOf(e);if(n!==-1){var o=new FormData;o.append("id",e.id),this.loading=!0,$.ajax({url:"/dashboard/notifications/mark-as-read",type:"POST",data:o,cache:!1,contentType:!1,processData:!1,success:a=>{},error:a=>{console.error(a)},complete:()=>{this.markAsRead(n),window.location=e.link,this.loading=!1}})}},markAsRead(e){this.notifications=this.notifications.map((n,o)=>(o===e&&(n.unread=!1),n))},markAllAsRead(){this.loading=!0,$.ajax({url:"/dashboard/notifications/mark-as-read",type:"POST",success:e=>{e.success&&this.notifications.forEach((n,o)=>{this.markAsRead(o)})},error:e=>{console.error(e)},complete:()=>{this.loading=!1}})},setNotifications(e){this.notifications=e},hasUnread:function(){return this.notifications.some(e=>e.unread)}}),q.data("notifications",e=>({notifications:e||[]})),q.store("focusMode",{active:q.$persist(!!Ww).as(Gh+":lqdFocusModeEnabled"),toggle(e){this.active=e?e==="activate":!this.active,document.body.classList.toggle("focus-mode",this.active)}}),q.data("numberCounter",({value:e=0,options:n={}})=>({value:e,options:{delay:0,...n},io:null,numberWrappers:[],numberCols:[],numberAnimators:[],init(){this.$el.innerHTML="",this.buildMarkup(),this.setupIO()},updateValue({value:o,options:a={}}){this.value!==o&&(this.value=o,this.options={...this.options,...a},this.buildMarkup(),this.setupIO())},buildMarkup(){const o=this.value.toString().split(""),a=this.$el.querySelectorAll(".lqd-number-counter-numbers-wrap");function l(){return Array.from({length:10},(h,f)=>`<span class="lqd-number-counter-number inline-flex h-full justify-center">${f}</span>`).join("")}if(o.map((h,f)=>{const g=!isNaN(h);return`<span class="lqd-number-counter-numbers-wrap relative inline-flex h-full w-[1ch]" data-index="${f}" data-value="${h}"><span class="lqd-number-counter-numbers-col absolute start-0 top-[-0.25lh] inline-flex h-[1.5lh] w-full flex-col overflow-hidden py-[0.25lh]"><span class="lqd-number-counter-numbers-animator inline-flex w-full h-full flex-col" data-is-number="${g}" data-value="${h}">${g?l():h}</span></span></span>`}).forEach((h,f)=>{const g=o[f],v=a[f],y=!isNaN(g);if(v){const S=v.querySelector(".lqd-number-counter-numbers-animator");v.setAttribute("data-value",g),S.setAttribute("data-value",g),S.setAttribute("data-is-number",y),S.getAttribute("data-is-number")==="true"&&y?S.innerHTML!==l()&&(S.innerHTML=l()):S.innerHTML!==g&&(S.innerHTML=g);return}this.$el.insertAdjacentHTML("beforeend",h),a.length&&this.$el.querySelector(`.lqd-number-counter-numbers-wrap[data-index="${f}"]`).animate([{translate:"0 0.25lh",opacity:0},{translate:"0 0",opacity:1}],{duration:250,easing:"ease",fill:"both"})}),a.length>o.length)for(let h=o.length;h<a.length;h++)a[h].animate([{translate:"0 -0.25lh",opacity:0}],{duration:250,easing:"ease",fill:"both"}).onfinish=()=>{a[h].remove()};this.numberWrappers=this.$el.querySelectorAll(".lqd-number-counter-numbers-wrap"),this.numberCols=this.$el.querySelectorAll(".lqd-number-counter-numbers-col"),this.numberAnimators=this.$el.querySelectorAll(".lqd-number-counter-numbers-animator")},setupIO(){this.io=new IntersectionObserver(([o],a)=>{o.isIntersecting&&(a.disconnect(),this.animate())}),this.io.observe(this.$el)},animate(){this.numberAnimators.forEach(o=>{if(!(o.getAttribute("data-is-number")==="true"))return;const l=o.getAttribute("data-value");o.animate([{translate:`0 ${l*100*-1}%`}],{duration:800,delay:this.options.delay,easing:"cubic-bezier(.47,1.09,.69,1.07)",fill:"both"})})}})),q.data("shapeCutout",()=>({init(){this.onResize=this.onResize.bind(this),this.afterResize=Ee.debounce(this.afterResize.bind(this),1),this.svgEl=this.$el.querySelector("svg"),this.svgEl&&(this.svgObjects=this.svgEl.querySelectorAll("rect, circle, path, polygon"),this.events())},events(){$(window).on("resize",this.onResize),this.resizeObserver=new ResizeObserver(()=>{this.onResize()}),this.resizeObserver.observe(this.svgEl)},onResize(){this.changeObjAttr("-"),this.afterResize()},afterResize(){this.changeObjAttr("+")},changeObjAttr(e){this.svgObjects.forEach(n=>{n.hasAttribute("x")?n.setAttribute("x",parseFloat(parseFloat(n.getAttribute("x"))+e+"1")):n.hasAttribute("width")?n.setAttribute("width",parseFloat(parseFloat(n.getAttribute("width"))+e+"1")):n.hasAttribute("cx")?n.setAttribute("cx",parseFloat(parseFloat(n.getAttribute("cx"))+e+"1")):n.hasAttribute("r")&&n.setAttribute("r",parseFloat(parseFloat(n.getAttribute("r"))+e+"1"))})}})),q.data("marquee",(e={})=>({maxWidth:0,position:0,options:{direction:-1,speed:.5,pauseOnHover:!1,...e},async init(){this.direction=this.options.direction,this.cellWidths=[],this.cellHeights=[],this.viewportEl=this.$el.querySelector(".lqd-marquee-viewport"),this.sliderEl=this.$el.querySelector(".lqd-marquee-slider"),this.cells=this.sliderEl.querySelectorAll(".lqd-marquee-cell"),this.sliderElStyles=window.getComputedStyle(this.sliderEl),this.maxWidth=0,this.maxHeight=0,this.onResize=Ee.debounce(this.onResize.bind(this),450),await document.fonts.ready,this.sizing(),this.startAnimation()},sizing(){for(let n=0;n<this.cells.length;n++)this.cellHeights.push(this.cells[n].offsetHeight),this.cellWidths.push(this.cells[n].offsetWidth);this.maxHeight=Math.max(...this.cellHeights),this.maxWidth=this.cellWidths.reduce((n,o)=>n+o,0),this.maxWidth+=parseInt(this.sliderElStyles.paddingLeft)+parseInt(this.sliderElStyles.paddingRight),this.maxWidth+=parseInt(this.sliderElStyles.gap)*(this.cells.length-1),this.viewportEl.style.height=`${this.maxHeight+parseInt(this.sliderElStyles.paddingTop)+parseInt(this.sliderElStyles.paddingBottom)}px`,this.sliderEl.classList.add("absolute","top-0","left-0","w-full","h-full"),this.maxWidth-=this.viewportEl.offsetWidth},startAnimation(){this.isAnimating=!0,this.options.pauseOnHover&&(this.sliderEl.addEventListener("pointerenter",()=>{this.isAnimating=!1}),this.sliderEl.addEventListener("pointerleave",()=>{this.isAnimating=!0}));const n=()=>{this.isAnimating&&(this.position+=this.options.speed*this.direction,this.position<=-this.maxWidth?this.direction=1:this.position>=0&&(this.direction=-1),this.sliderEl.style.transform=`translateX(${this.position}px)`),requestAnimationFrame(n)};requestAnimationFrame(n)},onResize(){this.sizing()}})),q.data("curtain",(e="curtain",n={})=>({id:e,activeCurtain:0,options:{itemsSelector:".lqd-curtain-item",contentSelector:".lqd-curtain-item-content",contentWidthOuter:".lqd-curtain-item-content-width-outer",contentWidthInner:".lqd-curtain-item-content-width-inner",activeClassname:"lqd-curtain-item-active",inactiveClassname:"lqd-curtain-item-inactive",duration:.65,ease:"cubic-bezier(0.23, 1, 0.320, 1)",trigger:"pointerenter",...n},init(){this.items=[...this.$el.querySelectorAll(this.options.itemsSelector)],this.items.length&&(this.onElementActive=this.onElementActive.bind(this),this.onWindowResize=Ee.debounce(this.onWindowResize.bind(this),450),this.setActiveCurtain(),this.setActiveElement(),this.setActiveContentWidth(),this.events())},events(){const{trigger:o}=this.options,a=Ee.throttle(this.onElementActive,50,{leading:!0,trailing:!1});this.items.forEach(l=>{l.addEventListener(o,a)}),window.addEventListener("resize",this.onWindowResize)},setActiveCurtain(){this.activeCurtain=this.items.findIndex(o=>o.classList.contains(this.options.activeClassname)),this.$dispatch(`curtain-changed-${this.id}`,{activeCurtain:this.activeCurtain})},setActiveElement(){this.activeElement=this.items[this.activeCurtain]},setActiveContentWidth(){if(!this.getElDirection().includes("row"))return;const a=this.activeElement.querySelector(this.options.contentWidthOuter).offsetWidth;this.$el.style.setProperty("--active-width",`${a}px`)},onElementActive(o){const{activeClassname:a,inactiveClassname:l}=this.options,u=o.currentTarget;this.items.forEach(h=>{h.classList.remove(a),h.classList.add(l)}),u.classList.remove(l),u.classList.add(a),this.setActiveCurtain(),this.setActiveElement()},getElDirection(){return window.getComputedStyle(this.activeElement).flexDirection},onWindowResize(){this.setActiveContentWidth()}})),q.data("slideshow",(e="slideshow",n=0,o={})=>({activeSlide:0,totalSlides:n,id:e,options:{...o},init(){this.setActiveSlide=this.setActiveSlide.bind(this)},setActiveSlide(a){a===">"?a=this.activeSlide+1:a==="<"&&(a=this.activeSlide-1),a<0?a=this.totalSlides-1:a>=this.totalSlides&&(a=0),this.activeSlide=a,this.$dispatch(`slide-changed-${this.id}`,{activeSlide:this.activeSlide})}})),q.data("dynamicInput",(e={relativeValue:!1,value:0,min:null,max:null,step:1,onInput:null})=>({value:e.value??0,_relativeValue:e.relativeValue,originalRelativeValue:null,min:e.min,max:e.max,step:e.step??1,onInputFn:e.onInput,prevMouseX:null,overlay:null,mouseDown:!1,changingDelta:0,prevVal:null,get relativeValue(){const n=this._relativeValue;return typeof n=="function"?n():n},set relativeValue(n){this._relativeValue=n},init(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onInput=this.onInput.bind(this),this.revertBackRelativeValue=_.throttle(this.revertBackRelativeValue.bind(this),150,{leading:!1}),this.value!=null&&this.updateValue(this.value),this.events(),this.$watch("mouseDown",n=>{this.$el.classList.toggle("dragging",n)})},events(){const n=this.$refs.dynamicLabel,o=this.$refs.dynamicInput;!n||!o||(n.addEventListener("mousedown",this.onMouseDown),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),o.addEventListener("keydown",this.onKeyDown),o.addEventListener("input",this.onInput))},updateInputValue(n,o=!0){const a=this.$refs.dynamicInput;if(a){if(!isNaN(n)){let l=0;const u=this.step.toString(),h=n.toString();u.includes(".")&&(l=Math.min(2,u.split(".")[1].length)),h.includes(".")&&(l=Math.min(2,h.split(".")[1].length)),l>0&&(n=parseFloat(n).toFixed(l))}a.value=n,o&&a.dispatchEvent(new Event("input",{bubbles:!0}))}},updateValue(n,o=!0,a=!0){if(n==null||!this.$refs.dynamicInput)return;if(this.relativeValue&&isNaN(n)){this.value=n,this.updateInputValue(this.value,!1);return}let u=parseFloat(n);!this.relativeValue&&this.min!=null&&u<this.min&&(u=this.min),!this.relativeValue&&this.max!=null&&u>this.max&&(u=this.max),this.value=u,o&&this.updateInputValue(this.value,a)},onMouseDown(n){const o=this.$refs.dynamicInput;this.mouseDown=!0,this.prevVal=o.value,n.preventDefault(),this.overlay||(this.overlay=document.createElement("div"),this.overlay.classList.add("fixed","top-0","start-0","w-screen","h-screen","z-10"),this.overlay.style.cursor="ew-resize",document.body.appendChild(this.overlay))},onMouseMove(n){if(!this.mouseDown)return;if(!this.prevMouseX&&this.prevMouseX!==0){this.prevMouseX=n.clientX;return}const o=n.clientX,a=o-this.prevMouseX,l=n.shiftKey,u=n.metaKey||n.ctrlKey,h=this.step*(l?10:u?.1:1);if(a!==0){const f=(a>0?1:-1)*h;let v=(!isNaN(parseFloat(this.value))?parseFloat(this.value):0)+f;this.relativeValue&&(v=f),this.changingDelta+=f,this.updateValue(v),this.prevMouseX=o}},onMouseUp(){this.mouseDown&&(this.relativeValue&&this.updateValue(isNaN(this.prevVal)?this.prevVal:parseFloat(this.prevVal||0)+this.changingDelta,!0,!1),this.mouseDown=!1,this.prevMouseX=null,this.changingDelta=0,this.prevVal=null,this.overlay&&(document.body.removeChild(this.overlay),this.overlay=null))},onKeyDown(n){if(n.key==="Enter"||n.key==="Tab"){if(this.updateValue(this.calculateExpression()),n.key==="Tab")return!0;n.preventDefault()}else if(n.key==="ArrowUp"||n.key==="ArrowDown"){n.preventDefault();const o=n.shiftKey,a=n.metaKey||n.ctrlKey,l=this.step*(o?10:a?.1:1),u=n.key==="ArrowUp"?l:-l,h=n.target.value;let g=(!isNaN(parseFloat(h))?parseFloat(h):0)+u;this.relativeValue&&(g=u),this.updateValue(g)}},onInput(n){this.updateValue(n.target.value,!1),typeof this.onInputFn=="function"&&this.onInputFn.call(this,this.value)},calculateExpression(){const n=this.$refs.dynamicInput.value.trim();let o=n;if(n){if(/[-+*/().]/.test(n)&&/[\d)]$/.test(n))try{if(this.isValidExpression(n)){const a=Function('"use strict"; return ('+n+")")();if(!isNaN(a)&&isFinite(a)){o=a;return}}}catch(a){console.log("Invalid expression:",a)}return o}},isValidExpression(n){let o=0;for(let a=0;a<n.length;a++)if(n[a]==="("&&o++,n[a]===")"&&o--,o<0)return!1;return!(o!==0||/[+\-*/]{2,}/.test(n)||/^[+*/]/.test(n)||/[+\-*/]$/.test(n))},revertBackRelativeValue(){this.originalRelativeValue&&(this.relativeValue=this.originalRelativeValue,this.originalRelativeValue=null)}})),q.data("splitText",(e={})=>({splitText:null,options:{type:"words",tag:"span",charsClass:"lqd-split-unit lqd-split-char",wordsClass:"lqd-split-unit lqd-split-word",linesClass:"lqd-split-unit lqd-split-line",...e},init(){this.splitText=new SplitText(this.$el,this.options);const n=this.splitText.words.length;this.splitText.words.forEach((o,a)=>{o.setAttribute("data-index",a),o.setAttribute("data-last-index",n-1-a),o.style.setProperty("--word-index",a),o.style.setProperty("--word-last-index",n-1-a)}),this.$dispatch("split-text-done",{splitText:this.splitText})}})),q.data("liquidColorPicker",(e={colorVal:null,onPick:null})=>({_colorVal:e.colorVal,picker:null,onPick:e.onPick,get colorVal(){return this._colorVal},set colorVal(n){this._colorVal=n},init(){this.checkDarkMode=this.checkDarkMode.bind(this),this.checkDarkMode(),this.initColorPicker(),this.events()},initColorPicker(){this.$refs.colorInput.setAttribute("type","text"),this.picker=new ColorPicker(this.$refs.colorInputWrap??this.$el,{color:this.colorVal,submitMode:"instant",showClearButton:!0})},events(){this.$watch("$store.darkMode.on",()=>{this.checkDarkMode()}),this.picker.on("pick",n=>{this.colorVal=n,typeof this.onPick=="function"&&this.onPick.call(this,n),this.$refs.colorInput&&(this.$refs.colorInput.value=n,this.$refs.colorInput.dispatchEvent(new Event("input",{bubbles:!0})))})},checkDarkMode(){const n=localStorage.getItem("lqdDarkMode")=="true";document.documentElement.setAttribute("data-cp-theme",n?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",n?"dark":"light")}})),q.data("openaiRealtime",ww),q.data("elevenlabsRealtime",Lw),q.data("advancedImageEditor",lh),q.data("creativeSuite",Ew),q.data("advancedImageEditor",lh),q.data("lqdCustomizer",Nw),q.data("lqdCustomizerFontPicker",Ow)});Ob.start();export{Gw as g};
